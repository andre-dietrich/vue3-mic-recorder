(function(){"use strict";try{if(typeof document<"u"){var r=document.createElement("style");r.appendChild(document.createTextNode(".ar-line-control{position:relative;height:8px;border-radius:5px;background-color:#e6e6e6}.ar-line-control__head{position:absolute;height:inherit;background-color:#616161;border-radius:inherit}.ar-volume{display:flex;align-items:center;line-height:10px}.ar-volume-bar{width:50px;height:6px;background:#e6e6e6;border-radius:4px;position:relative}.ar-volume__icon{fill:#747474;width:24px;height:24px;border:0;border-radius:0;padding:0;background-color:unset;margin-right:3px}.ar-player{width:380px;height:unset;border:0;border-radius:0;display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:unset;font-family:Roboto,sans-serif}.ar-player>.ar-player-bar{border:1px solid #E8E8E8;border-radius:24px;margin:0 0 0 5px}.ar-player>.ar-player-bar>.ar-player__progress{width:125px}.ar-player-bar{display:flex;align-items:center;height:38px;padding:0 12px;margin:0 5px}.ar-player-actions{width:55%;display:flex;align-items:center;justify-content:space-around}.ar-player__progress{width:160px;margin:0 8px}.ar-player__time{color:#54545480;font-size:16px;width:41px}.ar-player__play{width:45px;height:45px;background-color:#fff;box-shadow:0 2px 11px 11px #00000012}.ar-player__play--active{fill:#fff!important;background-color:#05cbcd!important}.ar-player__play--active:hover{fill:#505050!important}.ar{width:420px;font-family:Roboto,sans-serif;border-radius:16px;background-color:#fafafa;box-shadow:0 4px 18px #0000002b;position:relative;box-sizing:content-box}.ar-content{padding:16px;display:flex;flex-direction:column;align-items:center}.ar-records{height:138px;padding-top:1px;overflow-y:auto;margin-bottom:20px}.ar-records__record{width:320px;height:45px;padding:0 10px;margin:0 auto;line-height:45px;display:flex;justify-content:space-between;border-bottom:1px solid #E8E8E8;position:relative}.ar-records__record--selected{border:1px solid #E8E8E8;border-radius:24px;background-color:#fff;margin-top:-1px;padding:0 34px}.ar-recorder{position:relative;display:flex;flex-direction:column;align-items:center}.ar-recorder__duration{color:#aeaeae;font-size:32px;font-weight:500;margin-top:20px;margin-bottom:16px}.ar-recorder__stop{position:absolute;top:10px;right:-52px}.ar-recorder__time-limit{position:absolute;color:#aeaeae;font-size:12px;top:128px}.ar-recorder__records-limit{position:absolute;color:#aeaeae;font-size:13px;top:78px}.ar-spinner{display:flex;height:30px;position:absolute;left:0;right:0;top:0;bottom:0;margin:auto;width:144px;z-index:10}.ar-spinner__dot{display:block;margin:0 8px;border-radius:50%;width:30px;height:30px;background:#05cbcd;animation-name:blink;animation-duration:1.4s;animation-iteration-count:infinite;animation-fill-mode:both}.ar-spinner__dot:nth-child(2){animation-delay:.2s}.ar-spinner__dot:nth-child(3){animation-delay:.4s}@keyframes blink{0%{opacity:.2}20%{opacity:1}to{opacity:.2}}.ar__text{color:#54545480;font-size:16px}.ar__blur{filter:blur(2px);opacity:.7}.ar__overlay{position:absolute;width:100%;height:100%;z-index:10}.ar__upload-status{text-align:center;font-size:10px;padding:2px;letter-spacing:1px;position:absolute;bottom:0}.ar__upload-status--success{color:green}.ar__upload-status--fail{color:red}.ar__rm{cursor:pointer;position:absolute;width:6px;height:6px;padding:6px;line-height:6px;margin:auto;left:10px;bottom:0;top:0;color:#f4785a}.ar__downloader,.ar__uploader{position:absolute;top:0;bottom:0;margin:auto}.ar__downloader{right:115px}.ar__uploader{right:85px}.ar-icon{fill:#747474;border-radius:50%;border:1px solid #05CBCD;background-color:#fff;padding:5px;cursor:pointer;transition:.2s}.ar-icon:hover{fill:#505050}.ar-icon--no-border{border:0;border-radius:0;padding:0}.ar-icon--rec{fill:#fff;background-color:#ff6b64;border-color:transparent}.ar-icon--pulse{animation:ripple .5s linear infinite}@keyframes ripple{0%{box-shadow:0 0 #ff00001a,0 0 0 1px #ff00001a,0 0 0 5px #ff00001a}to{box-shadow:0 0 #ff00001a,0 0 0 10px #ff00001a,0 0 0 20px #f000}}.ar-icon__xs{width:18px;height:18px;line-height:18px}.ar-icon__sm{width:30px;height:30px;line-height:30px}.ar-icon__lg{width:45px;height:45px;line-height:45px;box-shadow:0 2px 5px 1px #9e9e9e80}")),document.head.appendChild(r)}}catch(o){console.error("vite-plugin-css-injected-by-js",o)}})();
(function(u1,be){typeof exports=="object"&&typeof module<"u"?module.exports=be(require("vue")):typeof define=="function"&&define.amd?define(["vue"],be):(u1=typeof globalThis<"u"?globalThis:u1||self,u1["vue3-mic-recorder"]=be(u1.Vue))})(this,function(u1){"use strict";const be=(p,T)=>{const A=p.__vccOpts||p;for(const[j,K]of T)A[j]=K;return A},qa={name:"IconButton",props:{name:{type:String}},data:function(){return{icons:{download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/><path fill="none" d="M0 0h24v24H0z"/></svg>',mic:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',save:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>',stop:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M6 6h12v12H6z"/></svg>',volume:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'}}}},za=["innerHTML"];function Za(p,T,A,j,K,N){return u1.openBlock(),u1.createElementBlock("div",{innerHTML:p.icons[A.name]},null,8,za)}const qe=be(qa,[["render",Za]]);function ct(p,T){const A=T.getBoundingClientRect().width,j=p.target.getBoundingClientRect().left;let K=(p.clientX-j)/A;try{if(!p.target.className.match(/^ar-line-control/))return}catch{return}return K=K<0?0:K,K=K>1?1:K,K}function ye(p){return new Date(p*1e3).toISOString().substr(14,5)}const Ga={name:"LineControl",props:{refId:{type:String},eventName:{type:String},percentage:{type:Number,default:0},rowDirection:{type:Boolean,default:!0}},methods:{onMouseDown(p){const T=ct(p,this.$refs[this.refId]);this.$emit("change-linehead",T),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(p){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const T=ct(p,this.$refs[this.refId]);this.$emit("change-linehead",T)},onMouseMove(p){const T=ct(p,this.$refs[this.refId]);this.$emit("change-linehead",T)}},computed:{calculateSize(){const p=this.percentage<1?this.percentage*100:this.percentage;return`${this.rowDirection?"width":"height"}: ${p}%`}}};function Qa(p,T,A,j,K,N){return u1.openBlock(),u1.createElementBlock("div",{ref:A.refId,class:"ar-line-control",onMousedown:T[0]||(T[0]=(...Z)=>N.onMouseDown&&N.onMouseDown(...Z))},[u1.createElementVNode("div",{class:"ar-line-control__head",style:u1.normalizeStyle(N.calculateSize)},null,4)],544)}const Ct=be(Ga,[["render",Qa]]),Ua={name:"VolumeControl",data(){return{volume:.8}},components:{IconButton:qe,LineControl:Ct},methods:{onChangeLinehead(p){this.$emit("change-volume",p),this.volume=p}}},Wa={class:"ar-volume"};function Ka(p,T,A,j,K,N){const Z=u1.resolveComponent("icon-button"),Y=u1.resolveComponent("line-control");return u1.openBlock(),u1.createElementBlock("div",Wa,[u1.createVNode(Z,{class:"ar-volume__icon",name:"volume"}),u1.createVNode(Y,{class:"ar-volume-bar","ref-id":"volume",percentage:K.volume,onChangeLinehead:N.onChangeLinehead},null,8,["percentage","onChangeLinehead"])])}const Ja={name:"AudioPlayer",props:{src:{type:String},record:{type:Object},filename:{type:String}},data(){return{isPlaying:!1,duration:ye(0),playedTime:ye(0),progress:0}},components:{IconButton:qe,LineControl:Ct,VolumeControl:be(Ua,[["render",Ka]])},mounted:function(){this.player=document.getElementById(this.playerUniqId),this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",()=>{this._resetProgress(),this.duration=ye(this.player.duration)}),this.player.addEventListener("timeupdate",this._onTimeUpdate)},computed:{audioSource(){const p=this.src||this.record.url;return p||(this._resetProgress(),null)},playBtnIcon(){return this.isPlaying?"pause":"play"},playerUniqId(){return`audio-player${this._uid}`}},methods:{playback(){this.audioSource&&(this.isPlaying?this.player.pause():setTimeout(()=>{this.player.play()},0),this.isPlaying=!this.isPlaying)},_resetProgress(){this.isPlaying&&this.player.pause(),this.duration=ye(0),this.playedTime=ye(0),this.progress=0,this.isPlaying=!1},_onTimeUpdate(){this.playedTime=ye(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100},_onUpdateProgress(p){p&&(this.player.currentTime=p*this.player.duration)},_onChangeVolume(p){p&&(this.player.volume=p)}}},$a={class:"ar-player"},es={class:"ar-player-actions"},ts={class:"ar-player-bar"},as={class:"ar-player__time"},ss={class:"ar-player__time"},rs=["id","src"];function ns(p,T,A,j,K,N){const Z=u1.resolveComponent("icon-button"),Y=u1.resolveComponent("line-control"),$=u1.resolveComponent("volume-control");return u1.openBlock(),u1.createElementBlock("div",$a,[u1.createElementVNode("div",es,[u1.createVNode(Z,{id:"play",class:u1.normalizeClass(["ar-icon ar-icon__lg ar-player__play",{"ar-player__play--active":K.isPlaying}]),name:N.playBtnIcon,onClick:N.playback},null,8,["name","class","onClick"])]),u1.createElementVNode("div",ts,[u1.createElementVNode("div",as,u1.toDisplayString(K.playedTime),1),u1.createVNode(Y,{class:"ar-player__progress","ref-id":"progress",percentage:K.progress,onChangeLinehead:N._onUpdateProgress},null,8,["percentage","onChangeLinehead"]),u1.createElementVNode("div",ss,u1.toDisplayString(K.duration),1),u1.createVNode($,{onChangeVolume:N._onChangeVolume},null,8,["onChangeVolume"])]),u1.createElementVNode("audio",{id:N.playerUniqId,src:N.audioSource},null,8,rs)])}const ht=be(Ja,[["render",ns]]),is={name:"Downloader",props:{record:{type:Object},filename:{type:String}},components:{IconButton:qe},methods:{download(){if(!this.record.url)return;const p=this.record.blob.type.split("/")[1],T=document.createElement("a");T.href=this.record.url,T.download=`${this.filename}.${p}`,T.click()}}};function _s(p,T,A,j,K,N){const Z=u1.resolveComponent("icon-button");return u1.openBlock(),u1.createBlock(Z,{id:"download",class:"ar-icon ar-icon__xs ar-icon--no-border",name:"download",onClick:N.download},null,8,["onClick"])}const os=be(is,[["render",_s]]),Yt={props:{filename:{type:String,default:"record"},format:{type:String,default:"mp3"},headers:{type:Object,default:()=>({})},uploadUrl:{type:String}}},ls={name:"Uploader",mixins:[Yt],props:{record:{type:Object}},emits:["start-upload","end-upload"],components:{IconButton:qe},methods:{upload(){if(!this.record.url)return;this.$emit("start-upload");const p=new FormData;p.append("audio",this.record.blob,`${this.filename}.mp3`);const T=Object.assign(this.headers,{});T["Content-Type"]=`multipart/form-data; boundary=${p._boundary}`,this.$http.post(this.uploadUrl,p,{headers:T}).then(A=>{this.$emit("end-upload",{status:"success",response:A})}).catch(A=>{this.$emit("end-upload",{status:"fail",response:A})})}}};function fs(p,T,A,j,K,N){const Z=u1.resolveComponent("icon-button");return u1.openBlock(),u1.createBlock(Z,{name:"save",class:"ar-icon ar-icon__xs ar-icon--no-border",onClick:N.upload},null,8,["onClick"])}const cs=be(ls,[["render",fs]]);function hs(p){return new Int8Array(p)}function Ft(p){return new Int16Array(p)}function jt(p){return new Int32Array(p)}function qt(p){return new Float32Array(p)}function us(p){return new Float64Array(p)}function zt(p){if(p.length==1)return qt(p[0]);var T=p[0];p=p.slice(1);for(var A=[],j=0;j<T;j++)A.push(zt(p));return A}function Zt(p){if(p.length==1)return jt(p[0]);var T=p[0];p=p.slice(1);for(var A=[],j=0;j<T;j++)A.push(Zt(p));return A}function Gt(p){if(p.length==1)return Ft(p[0]);var T=p[0];p=p.slice(1);for(var A=[],j=0;j<T;j++)A.push(Gt(p));return A}function Qt(p){if(p.length==1)return new Array(p[0]);var T=p[0];p=p.slice(1);for(var A=[],j=0;j<T;j++)A.push(Qt(p));return A}var Ut={};Ut.fill=function(p,T,A,j){if(arguments.length==2)for(var K=0;K<p.length;K++)p[K]=arguments[1];else for(var K=T;K<A;K++)p[K]=j};var ze={};ze.arraycopy=function(p,T,A,j,K){for(var N=T+K;T<N;)A[j++]=p[T++]},ze.out={},ze.out.println=function(p){console.log(p)},ze.out.printf=function(){console.log.apply(console,arguments)};var et={};et.SQRT2=1.4142135623730951,et.FAST_LOG10=function(p){return Math.log10(p)},et.FAST_LOG10_X=function(p,T){return Math.log10(p)*T};function Be(p){this.ordinal=p}Be.short_block_allowed=new Be(0),Be.short_block_coupled=new Be(1),Be.short_block_dispensed=new Be(2),Be.short_block_forced=new Be(3);var Wt={};Wt.MAX_VALUE=34028235e31;function le(p){this.ordinal=p}le.vbr_off=new le(0),le.vbr_mt=new le(1),le.vbr_rh=new le(2),le.vbr_abr=new le(3),le.vbr_mtrh=new le(4),le.vbr_default=le.vbr_mtrh;var ps=function(p){},z1={System:ze,VbrMode:le,Float:Wt,ShortBlock:Be,Util:et,Arrays:Ut,new_array_n:Qt,new_byte:hs,new_double:us,new_float:qt,new_float_n:zt,new_int:jt,new_int_n:Zt,new_short:Ft,new_short_n:Gt,assert:ps},ut,Kt;function ms(){if(Kt)return ut;Kt=1;var p=z1,T=p.System,A=p.Util,j=p.Arrays,K=p.new_float,N=ae();function Z(){var Y=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*A.SQRT2*.5/2384e-9,.017876148*A.SQRT2*.5/2384e-9,.003134727*A.SQRT2*.5/2384e-9,.002457142*A.SQRT2*.5/2384e-9,971317e-9*A.SQRT2*.5/2384e-9,218868e-9*A.SQRT2*.5/2384e-9,101566e-9*A.SQRT2*.5/2384e-9,13828e-9*A.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],$=12,p1=36,g=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],m=g[N.SHORT_TYPE],D=g[N.SHORT_TYPE],n1=g[N.SHORT_TYPE],U=g[N.SHORT_TYPE],r1=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function W(h,w,e){for(var l=10,R=w+238-14-286,P=-15;P<0;P++){var O,k,x;O=Y[l+-10],k=h[R+-224]*O,x=h[w+224]*O,O=Y[l+-9],k+=h[R+-160]*O,x+=h[w+160]*O,O=Y[l+-8],k+=h[R+-96]*O,x+=h[w+96]*O,O=Y[l+-7],k+=h[R+-32]*O,x+=h[w+32]*O,O=Y[l+-6],k+=h[R+32]*O,x+=h[w+-32]*O,O=Y[l+-5],k+=h[R+96]*O,x+=h[w+-96]*O,O=Y[l+-4],k+=h[R+160]*O,x+=h[w+-160]*O,O=Y[l+-3],k+=h[R+224]*O,x+=h[w+-224]*O,O=Y[l+-2],k+=h[w+-256]*O,x-=h[R+256]*O,O=Y[l+-1],k+=h[w+-192]*O,x-=h[R+192]*O,O=Y[l+0],k+=h[w+-128]*O,x-=h[R+128]*O,O=Y[l+1],k+=h[w+-64]*O,x-=h[R+64]*O,O=Y[l+2],k+=h[w+0]*O,x-=h[R+0]*O,O=Y[l+3],k+=h[w+64]*O,x-=h[R+-64]*O,O=Y[l+4],k+=h[w+128]*O,x-=h[R+-128]*O,O=Y[l+5],k+=h[w+192]*O,x-=h[R+-192]*O,k*=Y[l+6],O=x-k,e[30+P*2]=x+k,e[31+P*2]=Y[l+7]*O,l+=18,w--,R++}{var k,x,_1,b;x=h[w+-16]*Y[l+-10],k=h[w+-32]*Y[l+-2],x+=(h[w+-48]-h[w+16])*Y[l+-9],k+=h[w+-96]*Y[l+-1],x+=(h[w+-80]+h[w+48])*Y[l+-8],k+=h[w+-160]*Y[l+0],x+=(h[w+-112]-h[w+80])*Y[l+-7],k+=h[w+-224]*Y[l+1],x+=(h[w+-144]+h[w+112])*Y[l+-6],k-=h[w+32]*Y[l+2],x+=(h[w+-176]-h[w+144])*Y[l+-5],k-=h[w+96]*Y[l+3],x+=(h[w+-208]+h[w+176])*Y[l+-4],k-=h[w+160]*Y[l+4],x+=(h[w+-240]-h[w+208])*Y[l+-3],k-=h[w+224],_1=k-x,b=k+x,x=e[14],k=e[15]-x,e[31]=b+x,e[30]=_1+k,e[15]=_1-k,e[14]=b-x}{var a;a=e[28]-e[0],e[0]+=e[28],e[28]=a*Y[l+-2*18+7],a=e[29]-e[1],e[1]+=e[29],e[29]=a*Y[l+-2*18+7],a=e[26]-e[2],e[2]+=e[26],e[26]=a*Y[l+-4*18+7],a=e[27]-e[3],e[3]+=e[27],e[27]=a*Y[l+-4*18+7],a=e[24]-e[4],e[4]+=e[24],e[24]=a*Y[l+-6*18+7],a=e[25]-e[5],e[5]+=e[25],e[25]=a*Y[l+-6*18+7],a=e[22]-e[6],e[6]+=e[22],e[22]=a*A.SQRT2,a=e[23]-e[7],e[7]+=e[23],e[23]=a*A.SQRT2-e[7],e[7]-=e[6],e[22]-=e[7],e[23]-=e[22],a=e[6],e[6]=e[31]-a,e[31]=e[31]+a,a=e[7],e[7]=e[30]-a,e[30]=e[30]+a,a=e[22],e[22]=e[15]-a,e[15]=e[15]+a,a=e[23],e[23]=e[14]-a,e[14]=e[14]+a,a=e[20]-e[8],e[8]+=e[20],e[20]=a*Y[l+-10*18+7],a=e[21]-e[9],e[9]+=e[21],e[21]=a*Y[l+-10*18+7],a=e[18]-e[10],e[10]+=e[18],e[18]=a*Y[l+-12*18+7],a=e[19]-e[11],e[11]+=e[19],e[19]=a*Y[l+-12*18+7],a=e[16]-e[12],e[12]+=e[16],e[16]=a*Y[l+-14*18+7],a=e[17]-e[13],e[13]+=e[17],e[17]=a*Y[l+-14*18+7],a=-e[20]+e[24],e[20]+=e[24],e[24]=a*Y[l+-12*18+7],a=-e[21]+e[25],e[21]+=e[25],e[25]=a*Y[l+-12*18+7],a=e[4]-e[8],e[4]+=e[8],e[8]=a*Y[l+-12*18+7],a=e[5]-e[9],e[5]+=e[9],e[9]=a*Y[l+-12*18+7],a=e[0]-e[12],e[0]+=e[12],e[12]=a*Y[l+-4*18+7],a=e[1]-e[13],e[1]+=e[13],e[13]=a*Y[l+-4*18+7],a=e[16]-e[28],e[16]+=e[28],e[28]=a*Y[l+-4*18+7],a=-e[17]+e[29],e[17]+=e[29],e[29]=a*Y[l+-4*18+7],a=A.SQRT2*(e[2]-e[10]),e[2]+=e[10],e[10]=a,a=A.SQRT2*(e[3]-e[11]),e[3]+=e[11],e[11]=a,a=A.SQRT2*(-e[18]+e[26]),e[18]+=e[26],e[26]=a-e[18],a=A.SQRT2*(-e[19]+e[27]),e[19]+=e[27],e[27]=a-e[19],a=e[2],e[19]-=e[3],e[3]-=a,e[2]=e[31]-a,e[31]+=a,a=e[3],e[11]-=e[19],e[18]-=a,e[3]=e[30]-a,e[30]+=a,a=e[18],e[27]-=e[11],e[19]-=a,e[18]=e[15]-a,e[15]+=a,a=e[19],e[10]-=a,e[19]=e[14]-a,e[14]+=a,a=e[10],e[11]-=a,e[10]=e[23]-a,e[23]+=a,a=e[11],e[26]-=a,e[11]=e[22]-a,e[22]+=a,a=e[26],e[27]-=a,e[26]=e[7]-a,e[7]+=a,a=e[27],e[27]=e[6]-a,e[6]+=a,a=A.SQRT2*(e[0]-e[4]),e[0]+=e[4],e[4]=a,a=A.SQRT2*(e[1]-e[5]),e[1]+=e[5],e[5]=a,a=A.SQRT2*(e[16]-e[20]),e[16]+=e[20],e[20]=a,a=A.SQRT2*(e[17]-e[21]),e[17]+=e[21],e[21]=a,a=-A.SQRT2*(e[8]-e[12]),e[8]+=e[12],e[12]=a-e[8],a=-A.SQRT2*(e[9]-e[13]),e[9]+=e[13],e[13]=a-e[9],a=-A.SQRT2*(e[25]-e[29]),e[25]+=e[29],e[29]=a-e[25],a=-A.SQRT2*(e[24]+e[28]),e[24]-=e[28],e[28]=a-e[24],a=e[24]-e[16],e[24]=a,a=e[20]-a,e[20]=a,a=e[28]-a,e[28]=a,a=e[25]-e[17],e[25]=a,a=e[21]-a,e[21]=a,a=e[29]-a,e[29]=a,a=e[17]-e[1],e[17]=a,a=e[9]-a,e[9]=a,a=e[25]-a,e[25]=a,a=e[5]-a,e[5]=a,a=e[21]-a,e[21]=a,a=e[13]-a,e[13]=a,a=e[29]-a,e[29]=a,a=e[1]-e[0],e[1]=a,a=e[16]-a,e[16]=a,a=e[17]-a,e[17]=a,a=e[8]-a,e[8]=a,a=e[9]-a,e[9]=a,a=e[24]-a,e[24]=a,a=e[25]-a,e[25]=a,a=e[4]-a,e[4]=a,a=e[5]-a,e[5]=a,a=e[20]-a,e[20]=a,a=e[21]-a,e[21]=a,a=e[12]-a,e[12]=a,a=e[13]-a,e[13]=a,a=e[28]-a,e[28]=a,a=e[29]-a,e[29]=a,a=e[0],e[0]+=e[31],e[31]-=a,a=e[1],e[1]+=e[30],e[30]-=a,a=e[16],e[16]+=e[15],e[15]-=a,a=e[17],e[17]+=e[14],e[14]-=a,a=e[8],e[8]+=e[23],e[23]-=a,a=e[9],e[9]+=e[22],e[22]-=a,a=e[24],e[24]+=e[7],e[7]-=a,a=e[25],e[25]+=e[6],e[6]-=a,a=e[4],e[4]+=e[27],e[27]-=a,a=e[5],e[5]+=e[26],e[26]-=a,a=e[20],e[20]+=e[11],e[11]-=a,a=e[21],e[21]+=e[10],e[10]-=a,a=e[12],e[12]+=e[19],e[19]-=a,a=e[13],e[13]+=e[18],e[18]-=a,a=e[28],e[28]+=e[3],e[3]-=a,a=e[29],e[29]+=e[2],e[2]-=a}}function S(h,w){for(var e=0;e<3;e++){var l,R,P,O,k,x;O=h[w+2*3]*g[N.SHORT_TYPE][0]-h[w+5*3],l=h[w+0*3]*g[N.SHORT_TYPE][2]-h[w+3*3],R=O+l,P=O-l,O=h[w+5*3]*g[N.SHORT_TYPE][0]+h[w+2*3],l=h[w+3*3]*g[N.SHORT_TYPE][2]+h[w+0*3],k=O+l,x=-O+l,l=(h[w+1*3]*g[N.SHORT_TYPE][1]-h[w+4*3])*2069978111953089e-26,O=(h[w+4*3]*g[N.SHORT_TYPE][1]+h[w+1*3])*2069978111953089e-26,h[w+3*0]=R*190752519173728e-25+l,h[w+3*5]=-k*190752519173728e-25+O,P=P*.8660254037844387*1907525191737281e-26,k=k*.5*1907525191737281e-26+O,h[w+3*1]=P-k,h[w+3*2]=P+k,R=R*.5*1907525191737281e-26-l,x=x*.8660254037844387*1907525191737281e-26,h[w+3*3]=R+x,h[w+3*4]=R-x,w++}}function f(h,w,e){var l,R;{var P,O,k,x,_1,b,a,v;P=e[17]-e[9],k=e[15]-e[11],x=e[14]-e[12],_1=e[0]+e[8],b=e[1]+e[7],a=e[2]+e[6],v=e[3]+e[5],h[w+17]=_1+a-v-(b-e[4]),R=(_1+a-v)*D[19]+(b-e[4]),l=(P-k-x)*D[18],h[w+5]=l+R,h[w+6]=l-R,O=(e[16]-e[10])*D[18],b=b*D[19]+e[4],l=P*D[12]+O+k*D[13]+x*D[14],R=-_1*D[16]+b-a*D[17]+v*D[15],h[w+1]=l+R,h[w+2]=l-R,l=P*D[13]-O-k*D[14]+x*D[12],R=-_1*D[17]+b-a*D[15]+v*D[16],h[w+9]=l+R,h[w+10]=l-R,l=P*D[14]-O+k*D[12]-x*D[13],R=_1*D[15]-b+a*D[16]-v*D[17],h[w+13]=l+R,h[w+14]=l-R}{var V,L,I,G,B,n,r,t;V=e[8]-e[0],I=e[6]-e[2],G=e[5]-e[3],B=e[17]+e[9],n=e[16]+e[10],r=e[15]+e[11],t=e[14]+e[12],h[w+0]=B+r+t+(n+e[13]),l=(B+r+t)*D[19]-(n+e[13]),R=(V-I+G)*D[18],h[w+11]=l+R,h[w+12]=l-R,L=(e[7]-e[1])*D[18],n=e[13]-n*D[19],l=B*D[15]-n+r*D[16]+t*D[17],R=V*D[14]+L+I*D[12]+G*D[13],h[w+3]=l+R,h[w+4]=l-R,l=-B*D[17]+n-r*D[15]-t*D[16],R=V*D[13]+L-I*D[14]-G*D[12],h[w+7]=l+R,h[w+8]=l-R,l=-B*D[16]+n-r*D[17]-t*D[15],R=V*D[12]-L+I*D[13]-G*D[14],h[w+15]=l+R,h[w+16]=l-R}}this.mdct_sub48=function(h,w,e){for(var l=w,R=286,P=0;P<h.channels_out;P++){for(var O=0;O<h.mode_gr;O++){for(var k,x=h.l3_side.tt[O][P],_1=x.xr,b=0,a=h.sb_sample[P][1-O],v=0,V=0;V<18/2;V++)for(W(l,R,a[v]),W(l,R+32,a[v+1]),v+=2,R+=64,k=1;k<32;k+=2)a[v-1][k]*=-1;for(k=0;k<32;k++,b+=18){var L=x.block_type,I=h.sb_sample[P][O],G=h.sb_sample[P][1-O];if(x.mixed_block_flag!=0&&k<2&&(L=0),h.amp_filter[k]<1e-12)j.fill(_1,b+0,b+18,0);else{if(h.amp_filter[k]<1)for(var V=0;V<18;V++)G[V][r1[k]]*=h.amp_filter[k];if(L==N.SHORT_TYPE){for(var V=-$/4;V<0;V++){var B=g[N.SHORT_TYPE][V+3];_1[b+V*3+9]=I[9+V][r1[k]]*B-I[8-V][r1[k]],_1[b+V*3+18]=I[14-V][r1[k]]*B+I[15+V][r1[k]],_1[b+V*3+10]=I[15+V][r1[k]]*B-I[14-V][r1[k]],_1[b+V*3+19]=G[2-V][r1[k]]*B+G[3+V][r1[k]],_1[b+V*3+11]=G[3+V][r1[k]]*B-G[2-V][r1[k]],_1[b+V*3+20]=G[8-V][r1[k]]*B+G[9+V][r1[k]]}S(_1,b)}else{for(var n=K(18),V=-p1/4;V<0;V++){var r,t;r=g[L][V+27]*G[V+9][r1[k]]+g[L][V+36]*G[8-V][r1[k]],t=g[L][V+9]*I[V+9][r1[k]]-g[L][V+18]*I[8-V][r1[k]],n[V+9]=r-t*m[3+V+9],n[V+18]=r*m[3+V+9]+t}f(_1,b,n)}}if(L!=N.SHORT_TYPE&&k!=0)for(var V=7;V>=0;--V){var i,u;i=_1[b+V]*n1[20+V]+_1[b+-1-V]*U[28+V],u=_1[b+V]*U[28+V]-_1[b+-1-V]*n1[20+V],_1[b+-1-V]=i,_1[b+V]=u}}}if(l=e,R=286,h.mode_gr==1)for(var F=0;F<18;F++)T.arraycopy(h.sb_sample[P][1][F],0,h.sb_sample[P][0][F],0,32)}}}return ut=Z,ut}var pt,Jt;function $t(){if(Jt)return pt;Jt=1;var p=ae(),T=z1,A=T.System,j=T.new_float,K=T.new_float_n;function N(){this.l=j(p.SBMAX_l),this.s=K([p.SBMAX_s,3]);var Z=this;this.assign=function(Y){A.arraycopy(Y.l,0,Z.l,0,p.SBMAX_l);for(var $=0;$<p.SBMAX_s;$++)for(var p1=0;p1<3;p1++)Z.s[$][p1]=Y.s[$][p1]}}return pt=N,pt}var mt,ea;function bs(){if(ea)return mt;ea=1;var p=$t();function T(){this.thm=new p,this.en=new p}return mt=T,mt}function de(p){var T=p;this.ordinal=function(){return T}}de.STEREO=new de(0),de.JOINT_STEREO=new de(1),de.DUAL_CHANNEL=new de(2),de.MONO=new de(3),de.NOT_SET=new de(4);var Ze=de,bt,ta;function ae(){if(ta)return bt;ta=1;var p=z1,T=p.System,A=p.VbrMode,j=p.new_array_n,K=p.new_float,N=p.new_float_n,Z=p.new_int,Y=p.assert;$.ENCDELAY=576,$.POSTDELAY=1152,$.MDCTDELAY=48,$.FFTOFFSET=224+$.MDCTDELAY,$.DECDELAY=528,$.SBLIMIT=32,$.CBANDS=64,$.SBPSY_l=21,$.SBPSY_s=12,$.SBMAX_l=22,$.SBMAX_s=13,$.PSFB21=6,$.PSFB12=6,$.BLKSIZE=1024,$.HBLKSIZE=$.BLKSIZE/2+1,$.BLKSIZE_s=256,$.HBLKSIZE_s=$.BLKSIZE_s/2+1,$.NORM_TYPE=0,$.START_TYPE=1,$.SHORT_TYPE=2,$.STOP_TYPE=3,$.MPG_MD_LR_LR=0,$.MPG_MD_LR_I=1,$.MPG_MD_MS_LR=2,$.MPG_MD_MS_I=3,$.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function $(){var p1=ms(),g=bs(),m=Ze,D=$.FFTOFFSET,n1=$.MPG_MD_MS_LR,U=null;this.psy=null;var r1=null,W=null,S=null;this.setModules=function(l,R,P,O){U=l,this.psy=R,r1=R,W=O,S=P};var f=new p1;function h(l){var R,P;if(l.ATH.useAdjust==0){l.ATH.adjust=1;return}if(P=l.loudness_sq[0][0],R=l.loudness_sq[1][0],l.channels_out==2?(P+=l.loudness_sq[0][1],R+=l.loudness_sq[1][1]):(P+=P,R+=R),l.mode_gr==2&&(P=Math.max(P,R)),P*=.5,P*=l.ATH.aaSensitivityP,P>.03125)l.ATH.adjust>=1?l.ATH.adjust=1:l.ATH.adjust<l.ATH.adjustLimit&&(l.ATH.adjust=l.ATH.adjustLimit),l.ATH.adjustLimit=1;else{var O=31.98*P+625e-6;l.ATH.adjust>=O?(l.ATH.adjust*=O*.075+.925,l.ATH.adjust<O&&(l.ATH.adjust=O)):l.ATH.adjustLimit>=O?l.ATH.adjust=O:l.ATH.adjust<l.ATH.adjustLimit&&(l.ATH.adjust=l.ATH.adjustLimit),l.ATH.adjustLimit=O}}function w(l){var R,P;for(Y(0<=l.bitrate_index&&l.bitrate_index<16),Y(0<=l.mode_ext&&l.mode_ext<4),l.bitrate_stereoMode_Hist[l.bitrate_index][4]++,l.bitrate_stereoMode_Hist[15][4]++,l.channels_out==2&&(l.bitrate_stereoMode_Hist[l.bitrate_index][l.mode_ext]++,l.bitrate_stereoMode_Hist[15][l.mode_ext]++),R=0;R<l.mode_gr;++R)for(P=0;P<l.channels_out;++P){var O=l.l3_side.tt[R][P].block_type|0;l.l3_side.tt[R][P].mixed_block_flag!=0&&(O=4),l.bitrate_blockType_Hist[l.bitrate_index][O]++,l.bitrate_blockType_Hist[l.bitrate_index][5]++,l.bitrate_blockType_Hist[15][O]++,l.bitrate_blockType_Hist[15][5]++}}function e(l,R){var P=l.internal_flags,O,k;if(P.lame_encode_frame_init==0){var x,_1,b=K(2014),a=K(2014);for(P.lame_encode_frame_init=1,x=0,_1=0;x<286+576*(1+P.mode_gr);++x)x<576*P.mode_gr?(b[x]=0,P.channels_out==2&&(a[x]=0)):(b[x]=R[0][_1],P.channels_out==2&&(a[x]=R[1][_1]),++_1);for(k=0;k<P.mode_gr;k++)for(O=0;O<P.channels_out;O++)P.l3_side.tt[k][O].block_type=$.SHORT_TYPE;f.mdct_sub48(P,b,a),Y(576>=$.FFTOFFSET),Y(P.mf_size>=$.BLKSIZE+l.framesize-$.FFTOFFSET),Y(P.mf_size>=512+l.framesize-32)}}this.lame_encode_mp3_frame=function(l,R,P,O,k,x){var _1,b=j([2,2]);b[0][0]=new g,b[0][1]=new g,b[1][0]=new g,b[1][1]=new g;var a=j([2,2]);a[0][0]=new g,a[0][1]=new g,a[1][0]=new g,a[1][1]=new g;var v,V=[null,null],L=l.internal_flags,I=N([2,4]),G=[.5,.5],B=[[0,0],[0,0]],n=[[0,0],[0,0]],r,t,i;if(V[0]=R,V[1]=P,L.lame_encode_frame_init==0&&e(l,V),L.padding=0,(L.slot_lag-=L.frac_SpF)<0&&(L.slot_lag+=l.out_samplerate,L.padding=1),L.psymodel!=0){var u,F=[null,null],e1=0,y=Z(2);for(i=0;i<L.mode_gr;i++){for(t=0;t<L.channels_out;t++)F[t]=V[t],e1=576+i*576-$.FFTOFFSET;if(l.VBR==A.vbr_mtrh||l.VBR==A.vbr_mt?u=r1.L3psycho_anal_vbr(l,F,e1,i,b,a,B[i],n[i],I[i],y):u=r1.L3psycho_anal_ns(l,F,e1,i,b,a,B[i],n[i],I[i],y),u!=0)return-4;for(l.mode==m.JOINT_STEREO&&(G[i]=I[i][2]+I[i][3],G[i]>0&&(G[i]=I[i][3]/G[i])),t=0;t<L.channels_out;t++){var q=L.l3_side.tt[i][t];q.block_type=y[t],q.mixed_block_flag=0}}}else for(i=0;i<L.mode_gr;i++)for(t=0;t<L.channels_out;t++)L.l3_side.tt[i][t].block_type=$.NORM_TYPE,L.l3_side.tt[i][t].mixed_block_flag=0,n[i][t]=B[i][t]=700;if(h(L),f.mdct_sub48(L,V[0],V[1]),L.mode_ext=$.MPG_MD_LR_LR,l.force_ms)L.mode_ext=$.MPG_MD_MS_LR;else if(l.mode==m.JOINT_STEREO){var i1=0,h1=0;for(i=0;i<L.mode_gr;i++)for(t=0;t<L.channels_out;t++)i1+=n[i][t],h1+=B[i][t];if(i1<=1*h1){var v1=L.l3_side.tt[0],R1=L.l3_side.tt[L.mode_gr-1];v1[0].block_type==v1[1].block_type&&R1[0].block_type==R1[1].block_type&&(L.mode_ext=$.MPG_MD_MS_LR)}}if(L.mode_ext==n1?(v=a,r=n):(v=b,r=B),l.analysis&&L.pinfo!=null)for(i=0;i<L.mode_gr;i++)for(t=0;t<L.channels_out;t++)L.pinfo.ms_ratio[i]=L.ms_ratio[i],L.pinfo.ms_ener_ratio[i]=G[i],L.pinfo.blocktype[i][t]=L.l3_side.tt[i][t].block_type,L.pinfo.pe[i][t]=r[i][t],T.arraycopy(L.l3_side.tt[i][t].xr,0,L.pinfo.xr[i][t],0,576),L.mode_ext==n1&&(L.pinfo.ers[i][t]=L.pinfo.ers[i][t+2],T.arraycopy(L.pinfo.energy[i][t+2],0,L.pinfo.energy[i][t],0,L.pinfo.energy[i][t].length));if(l.VBR==A.vbr_off||l.VBR==A.vbr_abr){var w1,S1;for(w1=0;w1<18;w1++)L.nsPsy.pefirbuf[w1]=L.nsPsy.pefirbuf[w1+1];for(S1=0,i=0;i<L.mode_gr;i++)for(t=0;t<L.channels_out;t++)S1+=r[i][t];for(L.nsPsy.pefirbuf[18]=S1,S1=L.nsPsy.pefirbuf[9],w1=0;w1<9;w1++)S1+=(L.nsPsy.pefirbuf[w1]+L.nsPsy.pefirbuf[18-w1])*$.fircoef[w1];for(S1=670*5*L.mode_gr*L.channels_out/S1,i=0;i<L.mode_gr;i++)for(t=0;t<L.channels_out;t++)r[i][t]*=S1}if(L.iteration_loop.iteration_loop(l,r,G,v),U.format_bitstream(l),_1=U.copy_buffer(L,O,k,x,1),l.bWriteVbrTag&&W.addVbrFrame(l),l.analysis&&L.pinfo!=null){for(t=0;t<L.channels_out;t++){var y1;for(y1=0;y1<D;y1++)L.pinfo.pcmdata[t][y1]=L.pinfo.pcmdata[t][y1+l.framesize];for(y1=D;y1<1600;y1++)L.pinfo.pcmdata[t][y1]=V[t][y1-D]}S.set_frame_pinfo(l,v)}return w(L),_1}}return bt=$,bt}var aa=z1,sa=aa.Util,ra=aa.new_float,J1=ae();function ds(){var p=ra(J1.BLKSIZE),T=ra(J1.BLKSIZE_s/2),A=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function j(N,Z,Y){var $=0,p1,g,m;Y<<=1;var D=Z+Y;p1=4;do{var n1,U,r1,W,S,f,h;h=p1>>1,W=p1,S=p1<<1,f=S+W,p1=S<<1,g=Z,m=g+h;do{var w,e,l,R;e=N[g+0]-N[g+W],w=N[g+0]+N[g+W],R=N[g+S]-N[g+f],l=N[g+S]+N[g+f],N[g+S]=w-l,N[g+0]=w+l,N[g+f]=e-R,N[g+W]=e+R,e=N[m+0]-N[m+W],w=N[m+0]+N[m+W],R=sa.SQRT2*N[m+f],l=sa.SQRT2*N[m+S],N[m+S]=w-l,N[m+0]=w+l,N[m+f]=e-R,N[m+W]=e+R,m+=p1,g+=p1}while(g<D);for(U=A[$+0],n1=A[$+1],r1=1;r1<h;r1++){var P,O;P=1-2*n1*n1,O=2*n1*U,g=Z+r1,m=Z+W-r1;do{var k,x,_1,w,e,b,l,a,R,v;x=O*N[g+W]-P*N[m+W],k=P*N[g+W]+O*N[m+W],e=N[g+0]-k,w=N[g+0]+k,b=N[m+0]-x,_1=N[m+0]+x,x=O*N[g+f]-P*N[m+f],k=P*N[g+f]+O*N[m+f],R=N[g+S]-k,l=N[g+S]+k,v=N[m+S]-x,a=N[m+S]+x,x=n1*l-U*v,k=U*l+n1*v,N[g+S]=w-k,N[g+0]=w+k,N[m+f]=b-x,N[m+W]=b+x,x=U*a-n1*R,k=n1*a+U*R,N[m+S]=_1-k,N[m+0]=_1+k,N[g+f]=e-x,N[g+W]=e+x,m+=p1,g+=p1}while(g<D);P=U,U=P*A[$+0]-n1*A[$+1],n1=P*A[$+1]+n1*A[$+0]}$+=2}while(p1<Y)}var K=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(N,Z,Y,$,p1){for(var g=0;g<3;g++){var m=J1.BLKSIZE_s/2,D=65535&576/3*(g+1),n1=J1.BLKSIZE_s/8-1;do{var U,r1,W,S,f,h=K[n1<<2]&255;U=T[h]*$[Y][p1+h+D],f=T[127-h]*$[Y][p1+h+D+128],r1=U-f,U=U+f,W=T[h+64]*$[Y][p1+h+D+64],f=T[63-h]*$[Y][p1+h+D+192],S=W-f,W=W+f,m-=4,Z[g][m+0]=U+W,Z[g][m+2]=U-W,Z[g][m+1]=r1+S,Z[g][m+3]=r1-S,U=T[h+1]*$[Y][p1+h+D+1],f=T[126-h]*$[Y][p1+h+D+129],r1=U-f,U=U+f,W=T[h+65]*$[Y][p1+h+D+65],f=T[62-h]*$[Y][p1+h+D+193],S=W-f,W=W+f,Z[g][m+J1.BLKSIZE_s/2+0]=U+W,Z[g][m+J1.BLKSIZE_s/2+2]=U-W,Z[g][m+J1.BLKSIZE_s/2+1]=r1+S,Z[g][m+J1.BLKSIZE_s/2+3]=r1-S}while(--n1>=0);j(Z[g],m,J1.BLKSIZE_s/2)}},this.fft_long=function(N,Z,Y,$,p1){var g=J1.BLKSIZE/8-1,m=J1.BLKSIZE/2;do{var D,n1,U,r1,W,S=K[g]&255;D=p[S]*$[Y][p1+S],W=p[S+512]*$[Y][p1+S+512],n1=D-W,D=D+W,U=p[S+256]*$[Y][p1+S+256],W=p[S+768]*$[Y][p1+S+768],r1=U-W,U=U+W,m-=4,Z[m+0]=D+U,Z[m+2]=D-U,Z[m+1]=n1+r1,Z[m+3]=n1-r1,D=p[S+1]*$[Y][p1+S+1],W=p[S+513]*$[Y][p1+S+513],n1=D-W,D=D+W,U=p[S+257]*$[Y][p1+S+257],W=p[S+769]*$[Y][p1+S+769],r1=U-W,U=U+W,Z[m+J1.BLKSIZE/2+0]=D+U,Z[m+J1.BLKSIZE/2+2]=D-U,Z[m+J1.BLKSIZE/2+1]=n1+r1,Z[m+J1.BLKSIZE/2+3]=n1-r1}while(--g>=0);j(Z,m,J1.BLKSIZE/2)},this.init_fft=function(N){for(var Z=0;Z<J1.BLKSIZE;Z++)p[Z]=.42-.5*Math.cos(2*Math.PI*(Z+.5)/J1.BLKSIZE)+.08*Math.cos(4*Math.PI*(Z+.5)/J1.BLKSIZE);for(var Z=0;Z<J1.BLKSIZE_s/2;Z++)T[Z]=.5*(1-Math.cos(2*Math.PI*(Z+.5)/J1.BLKSIZE_s))}}var gs=ds,Ae=z1,De=Ae.VbrMode,na=Ae.Float,Xe=Ae.ShortBlock,re=Ae.Util,vs=Ae.Arrays,ee=Ae.new_float,ue=Ae.new_float_n,Te=Ae.new_int,X1=Ae.assert,ws=gs,s1=ae();function Ss(){var p=Ze,T=new ws,A=2.302585092994046,j=2,K=16,N=2,Z=16,Y=.34,$=1/(14752*14752)/(s1.BLKSIZE/2),p1=.01,g=.8,m=.6,D=.3,n1=3.5,U=21,r1=.2302585093;function W(o,c){for(var M=0,E=0;E<s1.BLKSIZE/2;++E)M+=o[E]*c.ATH.eql_w[E];return M*=$,M}function S(o,c,M,E,H,d,C,z,X,a1,Q){var t1=o.internal_flags;if(X<2)T.fft_long(t1,E[H],X,a1,Q),T.fft_short(t1,d[C],X,a1,Q);else if(X==2){for(var m1=s1.BLKSIZE-1;m1>=0;--m1){var P1=E[H+0][m1],o1=E[H+1][m1];E[H+0][m1]=(P1+o1)*re.SQRT2*.5,E[H+1][m1]=(P1-o1)*re.SQRT2*.5}for(var x1=2;x1>=0;--x1)for(var m1=s1.BLKSIZE_s-1;m1>=0;--m1){var P1=d[C+0][x1][m1],o1=d[C+1][x1][m1];d[C+0][x1][m1]=(P1+o1)*re.SQRT2*.5,d[C+1][x1][m1]=(P1-o1)*re.SQRT2*.5}}c[0]=E[H+0][0],c[0]*=c[0];for(var m1=s1.BLKSIZE/2-1;m1>=0;--m1){var J=E[H+0][s1.BLKSIZE/2-m1],M1=E[H+0][s1.BLKSIZE/2+m1];c[s1.BLKSIZE/2-m1]=(J*J+M1*M1)*.5}for(var x1=2;x1>=0;--x1){M[x1][0]=d[C+0][x1][0],M[x1][0]*=M[x1][0];for(var m1=s1.BLKSIZE_s/2-1;m1>=0;--m1){var J=d[C+0][x1][s1.BLKSIZE_s/2-m1],M1=d[C+0][x1][s1.BLKSIZE_s/2+m1];M[x1][s1.BLKSIZE_s/2-m1]=(J*J+M1*M1)*.5}}{for(var O1=0,m1=11;m1<s1.HBLKSIZE;m1++)O1+=c[m1];t1.tot_ener[X]=O1}if(o.analysis){for(var m1=0;m1<s1.HBLKSIZE;m1++)t1.pinfo.energy[z][X][m1]=t1.pinfo.energy_save[X][m1],t1.pinfo.energy_save[X][m1]=c[m1];t1.pinfo.pe[z][X]=t1.pe[X]}o.athaa_loudapprox==2&&X<2&&(t1.loudness_sq[z][X]=t1.loudness_sq_save[X],t1.loudness_sq_save[X]=W(c,t1))}var f=8,h=23,w=15,e,l,R,P=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function O(){e=Math.pow(10,(f+1)/16),l=Math.pow(10,(h+1)/16),R=Math.pow(10,w/10)}var k=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],x=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],_1=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function b(o,c,M,E,H,d){var C;if(c>o)if(c<o*l)C=c/o;else return o+c;else{if(o>=c*l)return o+c;C=o/c}if(o+=c,E+3<=6){if(C>=e)return o;var z=0|re.FAST_LOG10_X(C,16);return o*x[z]}var z=0|re.FAST_LOG10_X(C,16);if(c=H.ATH.cb_l[M]*H.ATH.adjust,o<R*c){if(o>c){var X,a1;return X=1,z<=13&&(X=_1[z]),a1=re.FAST_LOG10_X(o/c,10/15),o*((k[z]-X)*a1+X)}return z>13?o:o*_1[z]}return o*k[z]}var a=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function v(o,c,M){var E;if(o<0&&(o=0),c<0&&(c=0),o<=0)return c;if(c<=0)return o;if(c>o?E=c/o:E=o/c,-2<=M&&M<=2){if(E>=e)return o+c;var H=0|re.FAST_LOG10_X(E,16);return(o+c)*a[H]}return E<l?o+c:(o<c&&(o=c),o)}function V(o,c){var M=o.internal_flags;if(M.channels_out>1){for(var E=0;E<s1.SBMAX_l;E++){var H=M.thm[0].l[E],d=M.thm[1].l[E];M.thm[0].l[E]+=d*c,M.thm[1].l[E]+=H*c}for(var E=0;E<s1.SBMAX_s;E++)for(var C=0;C<3;C++){var H=M.thm[0].s[E][C],d=M.thm[1].s[E][C];M.thm[0].s[E][C]+=d*c,M.thm[1].s[E][C]+=H*c}}}function L(o){for(var c=0;c<s1.SBMAX_l;c++)if(!(o.thm[0].l[c]>1.58*o.thm[1].l[c]||o.thm[1].l[c]>1.58*o.thm[0].l[c])){var M=o.mld_l[c]*o.en[3].l[c],E=Math.max(o.thm[2].l[c],Math.min(o.thm[3].l[c],M));M=o.mld_l[c]*o.en[2].l[c];var H=Math.max(o.thm[3].l[c],Math.min(o.thm[2].l[c],M));o.thm[2].l[c]=E,o.thm[3].l[c]=H}for(var c=0;c<s1.SBMAX_s;c++)for(var d=0;d<3;d++)if(!(o.thm[0].s[c][d]>1.58*o.thm[1].s[c][d]||o.thm[1].s[c][d]>1.58*o.thm[0].s[c][d])){var M=o.mld_s[c]*o.en[3].s[c][d],E=Math.max(o.thm[2].s[c][d],Math.min(o.thm[3].s[c][d],M));M=o.mld_s[c]*o.en[2].s[c][d];var H=Math.max(o.thm[3].s[c][d],Math.min(o.thm[2].s[c][d],M));o.thm[2].s[c][d]=E,o.thm[3].s[c][d]=H}}function I(o,c,M){var E=c,H=Math.pow(10,M);c*=2,E*=2;for(var d=0;d<s1.SBMAX_l;d++){var C,z,X,a1;if(a1=o.ATH.cb_l[o.bm_l[d]]*H,C=Math.min(Math.max(o.thm[0].l[d],a1),Math.max(o.thm[1].l[d],a1)),z=Math.max(o.thm[2].l[d],a1),X=Math.max(o.thm[3].l[d],a1),C*c<z+X){var Q=C*E/(z+X);z*=Q,X*=Q}o.thm[2].l[d]=Math.min(z,o.thm[2].l[d]),o.thm[3].l[d]=Math.min(X,o.thm[3].l[d])}H*=s1.BLKSIZE_s/s1.BLKSIZE;for(var d=0;d<s1.SBMAX_s;d++)for(var t1=0;t1<3;t1++){var C,z,X,a1;if(a1=o.ATH.cb_s[o.bm_s[d]]*H,C=Math.min(Math.max(o.thm[0].s[d][t1],a1),Math.max(o.thm[1].s[d][t1],a1)),z=Math.max(o.thm[2].s[d][t1],a1),X=Math.max(o.thm[3].s[d][t1],a1),C*c<z+X){var Q=C*c/(z+X);z*=Q,X*=Q}o.thm[2].s[d][t1]=Math.min(o.thm[2].s[d][t1],z),o.thm[3].s[d][t1]=Math.min(o.thm[3].s[d][t1],X)}}function G(o,c,M,E,H){var d,C,z=0,X=0;for(d=C=0;d<s1.SBMAX_s;++C,++d){for(var a1=o.bo_s[d],Q=o.npart_s,t1=a1<Q?a1:Q;C<t1;)X1(c[C]>=0),X1(M[C]>=0),z+=c[C],X+=M[C],C++;if(o.en[E].s[d][H]=z,o.thm[E].s[d][H]=X,C>=Q){++d;break}X1(c[C]>=0),X1(M[C]>=0);{var m1=o.PSY.bo_s_weight[d],P1=1-m1;z=m1*c[C],X=m1*M[C],o.en[E].s[d][H]+=z,o.thm[E].s[d][H]+=X,z=P1*c[C],X=P1*M[C]}}for(;d<s1.SBMAX_s;++d)o.en[E].s[d][H]=0,o.thm[E].s[d][H]=0}function B(o,c,M,E){var H,d,C=0,z=0;for(H=d=0;H<s1.SBMAX_l;++d,++H){for(var X=o.bo_l[H],a1=o.npart_l,Q=X<a1?X:a1;d<Q;)X1(c[d]>=0),X1(M[d]>=0),C+=c[d],z+=M[d],d++;if(o.en[E].l[H]=C,o.thm[E].l[H]=z,d>=a1){++H;break}X1(c[d]>=0),X1(M[d]>=0);{var t1=o.PSY.bo_l_weight[H],m1=1-t1;C=t1*c[d],z=t1*M[d],o.en[E].l[H]+=C,o.thm[E].l[H]+=z,C=m1*c[d],z=m1*M[d]}}for(;H<s1.SBMAX_l;++H)o.en[E].l[H]=0,o.thm[E].l[H]=0}function n(o,c,M,E,H,d){var C=o.internal_flags,z,X;for(X=z=0;X<C.npart_s;++X){for(var a1=0,Q=C.numlines_s[X],t1=0;t1<Q;++t1,++z){var m1=c[d][z];a1+=m1}M[X]=a1}for(X1(X==C.npart_s),z=X=0;X<C.npart_s;X++){var P1=C.s3ind_s[X][0],o1=C.s3_ss[z++]*M[P1];for(++P1;P1<=C.s3ind_s[X][1];)o1+=C.s3_ss[z]*M[P1],++z,++P1;{var x1=N*C.nb_s1[H][X];E[X]=Math.min(o1,x1)}if(C.blocktype_old[H&1]==s1.SHORT_TYPE){var x1=Z*C.nb_s2[H][X],J=E[X];E[X]=Math.min(x1,J)}C.nb_s2[H][X]=C.nb_s1[H][X],C.nb_s1[H][X]=o1,X1(E[X]>=0)}for(;X<=s1.CBANDS;++X)M[X]=0,E[X]=0}function r(o,c,M,E){var H=o.internal_flags;o.short_blocks==Xe.short_block_coupled&&!(c[0]!=0&&c[1]!=0)&&(c[0]=c[1]=0);for(var d=0;d<H.channels_out;d++)E[d]=s1.NORM_TYPE,o.short_blocks==Xe.short_block_dispensed&&(c[d]=1),o.short_blocks==Xe.short_block_forced&&(c[d]=0),c[d]!=0?(X1(H.blocktype_old[d]!=s1.START_TYPE),H.blocktype_old[d]==s1.SHORT_TYPE&&(E[d]=s1.STOP_TYPE)):(E[d]=s1.SHORT_TYPE,H.blocktype_old[d]==s1.NORM_TYPE&&(H.blocktype_old[d]=s1.START_TYPE),H.blocktype_old[d]==s1.STOP_TYPE&&(H.blocktype_old[d]=s1.SHORT_TYPE)),M[d]=H.blocktype_old[d],H.blocktype_old[d]=E[d]}function t(o,c,M){return M>=1?o:M<=0?c:c>0?Math.pow(o/c,M)*c:0}var i=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function u(o,c){for(var M=309.07,E=0;E<s1.SBMAX_s-1;E++)for(var H=0;H<3;H++){var d=o.thm.s[E][H];if(d>0){var C=d*c,z=o.en.s[E][H];z>C&&(z>C*1e10?M+=i[E]*(10*A):M+=i[E]*re.FAST_LOG10(z/C))}}return M}var F=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function e1(o,c){for(var M=281.0575,E=0;E<s1.SBMAX_l-1;E++){var H=o.thm.l[E];if(H>0){var d=H*c,C=o.en.l[E];C>d&&(C>d*1e10?M+=F[E]*(10*A):M+=F[E]*re.FAST_LOG10(C/d))}}return M}function y(o,c,M,E,H){var d,C;for(d=C=0;d<o.npart_l;++d){var z=0,X=0,a1;for(a1=0;a1<o.numlines_l[d];++a1,++C){var Q=c[C];z+=Q,X<Q&&(X=Q)}M[d]=z,E[d]=X,H[d]=z*o.rnumlines_l[d],X1(o.rnumlines_l[d]>=0),X1(M[d]>=0),X1(E[d]>=0),X1(H[d]>=0)}}function q(o,c,M,E){var H=P.length-1,d=0,C=M[d]+M[d+1];if(C>0){var z=c[d];z<c[d+1]&&(z=c[d+1]),X1(o.numlines_l[d]+o.numlines_l[d+1]-1>0),C=20*(z*2-C)/(C*(o.numlines_l[d]+o.numlines_l[d+1]-1));var X=0|C;X>H&&(X=H),E[d]=X}else E[d]=0;for(d=1;d<o.npart_l-1;d++)if(C=M[d-1]+M[d]+M[d+1],C>0){var z=c[d-1];z<c[d]&&(z=c[d]),z<c[d+1]&&(z=c[d+1]),X1(o.numlines_l[d-1]+o.numlines_l[d]+o.numlines_l[d+1]-1>0),C=20*(z*3-C)/(C*(o.numlines_l[d-1]+o.numlines_l[d]+o.numlines_l[d+1]-1));var X=0|C;X>H&&(X=H),E[d]=X}else E[d]=0;if(X1(d==o.npart_l-1),C=M[d-1]+M[d],C>0){var z=c[d-1];z<c[d]&&(z=c[d]),X1(o.numlines_l[d-1]+o.numlines_l[d]-1>0),C=20*(z*2-C)/(C*(o.numlines_l[d-1]+o.numlines_l[d]-1));var X=0|C;X>H&&(X=H),E[d]=X}else E[d]=0;X1(d==o.npart_l-1)}var i1=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(o,c,M,E,H,d,C,z,X,a1){var Q=o.internal_flags,t1=ue([2,s1.BLKSIZE]),m1=ue([2,3,s1.BLKSIZE_s]),P1=ee(s1.CBANDS+1),o1=ee(s1.CBANDS+1),x1=ee(s1.CBANDS+2),J=Te(2),M1=Te(2),O1,l1,A1,f1,I1,q1,d1,D1,H1=ue([2,576]),Z1,fe=Te(s1.CBANDS+2),$1=Te(s1.CBANDS+2);for(vs.fill($1,0),O1=Q.channels_out,o.mode==p.JOINT_STEREO&&(O1=4),o.VBR==De.vbr_off?Z1=Q.ResvMax==0?0:Q.ResvSize/Q.ResvMax*.5:o.VBR==De.vbr_rh||o.VBR==De.vbr_mtrh||o.VBR==De.vbr_mt?Z1=.6:Z1=1,l1=0;l1<Q.channels_out;l1++){var G1=c[l1],_e=M+576-350-U+192;for(f1=0;f1<576;f1++){var ce,he;for(ce=G1[_e+f1+10],he=0,I1=0;I1<(U-1)/2-1;I1+=2)ce+=i1[I1]*(G1[_e+f1+I1]+G1[_e+f1+U-I1]),he+=i1[I1+1]*(G1[_e+f1+I1+1]+G1[_e+f1+U-I1-1]);H1[l1][f1]=ce+he}H[E][l1].en.assign(Q.en[l1]),H[E][l1].thm.assign(Q.thm[l1]),O1>2&&(d[E][l1].en.assign(Q.en[l1+2]),d[E][l1].thm.assign(Q.thm[l1+2]))}for(l1=0;l1<O1;l1++){var ve,we,se=ee(12),Re=[0,0,0,0],je=ee(12),Vt=1,Oa,Ha=ee(s1.CBANDS),Ca=ee(s1.CBANDS),Q1=[0,0,0,0],Ya=ee(s1.HBLKSIZE),Fa=ue([3,s1.HBLKSIZE_s]);for(X1(Q.npart_s<=s1.CBANDS),X1(Q.npart_l<=s1.CBANDS),f1=0;f1<3;f1++)se[f1]=Q.nsPsy.last_en_subshort[l1][f1+6],X1(Q.nsPsy.last_en_subshort[l1][f1+4]>0),je[f1]=se[f1]/Q.nsPsy.last_en_subshort[l1][f1+4],Re[0]+=se[f1];if(l1==2)for(f1=0;f1<576;f1++){var It,Lt;It=H1[0][f1],Lt=H1[1][f1],H1[0][f1]=It+Lt,H1[1][f1]=It-Lt}{var ja=H1[l1&1],We=0;for(f1=0;f1<9;f1++){for(var fr=We+64,te=1;We<fr;We++)te<Math.abs(ja[We])&&(te=Math.abs(ja[We]));Q.nsPsy.last_en_subshort[l1][f1]=se[f1+3]=te,Re[1+f1/3]+=te,te>se[f1+3-2]?(X1(se[f1+3-2]>0),te=te/se[f1+3-2]):se[f1+3-2]>te*10?te=se[f1+3-2]/(te*10):te=0,je[f1+3]=te}}if(o.analysis){var Nt=je[0];for(f1=1;f1<12;f1++)Nt<je[f1]&&(Nt=je[f1]);Q.pinfo.ers[E][l1]=Q.pinfo.ers_save[l1],Q.pinfo.ers_save[l1]=Nt}for(Oa=l1==3?Q.nsPsy.attackthre_s:Q.nsPsy.attackthre,f1=0;f1<12;f1++)Q1[f1/3]==0&&je[f1]>Oa&&(Q1[f1/3]=f1%3+1);for(f1=1;f1<4;f1++){var Dt;Re[f1-1]>Re[f1]?(X1(Re[f1]>0),Dt=Re[f1-1]/Re[f1]):(X1(Re[f1-1]>0),Dt=Re[f1]/Re[f1-1]),Dt<1.7&&(Q1[f1]=0,f1==1&&(Q1[0]=0))}for(Q1[0]!=0&&Q.nsPsy.lastAttacks[l1]!=0&&(Q1[0]=0),(Q.nsPsy.lastAttacks[l1]==3||Q1[0]+Q1[1]+Q1[2]+Q1[3]!=0)&&(Vt=0,Q1[1]!=0&&Q1[0]!=0&&(Q1[1]=0),Q1[2]!=0&&Q1[1]!=0&&(Q1[2]=0),Q1[3]!=0&&Q1[2]!=0&&(Q1[3]=0)),l1<2?M1[l1]=Vt:Vt==0&&(M1[0]=M1[1]=0),X[l1]=Q.tot_ener[l1],we=m1,ve=t1,S(o,Ya,Fa,ve,l1&1,we,l1&1,E,l1,c,M),y(Q,Ya,P1,Ha,Ca),q(Q,Ha,Ca,fe),D1=0;D1<3;D1++){var Xt,oe;for(n(o,Fa,o1,x1,l1,D1),G(Q,o1,x1,l1,D1),d1=0;d1<s1.SBMAX_s;d1++){if(oe=Q.thm[l1].s[d1][D1],oe*=g,Q1[D1]>=2||Q1[D1+1]==1){var Ke=D1!=0?D1-1:2,te=t(Q.thm[l1].s[d1][Ke],oe,m*Z1);oe=Math.min(oe,te)}if(Q1[D1]==1){var Ke=D1!=0?D1-1:2,te=t(Q.thm[l1].s[d1][Ke],oe,D*Z1);oe=Math.min(oe,te)}else if(D1!=0&&Q1[D1-1]==3||D1==0&&Q.nsPsy.lastAttacks[l1]==3){var Ke=D1!=2?D1+1:0,te=t(Q.thm[l1].s[d1][Ke],oe,D*Z1);oe=Math.min(oe,te)}Xt=se[D1*3+3]+se[D1*3+4]+se[D1*3+5],se[D1*3+5]*6<Xt&&(oe*=.5,se[D1*3+4]*6<Xt&&(oe*=.5)),Q.thm[l1].s[d1][D1]=oe}}for(Q.nsPsy.lastAttacks[l1]=Q1[2],q1=0,A1=0;A1<Q.npart_l;A1++){for(var Le=Q.s3ind[A1][0],Ot=P1[Le]*P[fe[Le]],Ne=Q.s3_ll[q1++]*Ot;++Le<=Q.s3ind[A1][1];)Ot=P1[Le]*P[fe[Le]],Ne=b(Ne,Q.s3_ll[q1++]*Ot,Le,Le-A1,Q);Ne*=.158489319246111,Q.blocktype_old[l1&1]==s1.SHORT_TYPE?x1[A1]=Ne:x1[A1]=t(Math.min(Ne,Math.min(j*Q.nb_1[l1][A1],K*Q.nb_2[l1][A1])),Ne,Z1),Q.nb_2[l1][A1]=Q.nb_1[l1][A1],Q.nb_1[l1][A1]=Ne}for(;A1<=s1.CBANDS;++A1)P1[A1]=0,x1[A1]=0;B(Q,P1,x1,l1)}if((o.mode==p.STEREO||o.mode==p.JOINT_STEREO)&&o.interChRatio>0&&V(o,o.interChRatio),o.mode==p.JOINT_STEREO){var Ht;L(Q),Ht=o.msfix,Math.abs(Ht)>0&&I(Q,Ht,o.ATHlower*Q.ATH.adjust)}for(r(o,M1,a1,J),l1=0;l1<O1;l1++){var Je,$e=0,lt,ft;l1>1?(Je=z,$e=-2,lt=s1.NORM_TYPE,(a1[0]==s1.SHORT_TYPE||a1[1]==s1.SHORT_TYPE)&&(lt=s1.SHORT_TYPE),ft=d[E][l1-2]):(Je=C,$e=0,lt=a1[l1],ft=H[E][l1]),lt==s1.SHORT_TYPE?Je[$e+l1]=u(ft,Q.masking_lower):Je[$e+l1]=e1(ft,Q.masking_lower),o.analysis&&(Q.pinfo.pe[E][l1]=Je[$e+l1])}return 0};function h1(o,c,M,E,H,d,C,z){var X=o.internal_flags;if(E<2)T.fft_long(X,C[z],E,c,M);else if(E==2)for(var a1=s1.BLKSIZE-1;a1>=0;--a1){var Q=C[z+0][a1],t1=C[z+1][a1];C[z+0][a1]=(Q+t1)*re.SQRT2*.5,C[z+1][a1]=(Q-t1)*re.SQRT2*.5}d[0]=C[z+0][0],d[0]*=d[0];for(var a1=s1.BLKSIZE/2-1;a1>=0;--a1){var m1=C[z+0][s1.BLKSIZE/2-a1],P1=C[z+0][s1.BLKSIZE/2+a1];d[s1.BLKSIZE/2-a1]=(m1*m1+P1*P1)*.5}{for(var o1=0,a1=11;a1<s1.HBLKSIZE;a1++)o1+=d[a1];X.tot_ener[E]=o1}if(o.analysis){for(var a1=0;a1<s1.HBLKSIZE;a1++)X.pinfo.energy[H][E][a1]=X.pinfo.energy_save[E][a1],X.pinfo.energy_save[E][a1]=d[a1];X.pinfo.pe[H][E]=X.pe[E]}}function v1(o,c,M,E,H,d,C,z){var X=o.internal_flags;if(H==0&&E<2&&T.fft_short(X,C[z],E,c,M),E==2)for(var a1=s1.BLKSIZE_s-1;a1>=0;--a1){var Q=C[z+0][H][a1],t1=C[z+1][H][a1];C[z+0][H][a1]=(Q+t1)*re.SQRT2*.5,C[z+1][H][a1]=(Q-t1)*re.SQRT2*.5}d[H][0]=C[z+0][H][0],d[H][0]*=d[H][0];for(var a1=s1.BLKSIZE_s/2-1;a1>=0;--a1){var m1=C[z+0][H][s1.BLKSIZE_s/2-a1],P1=C[z+0][H][s1.BLKSIZE_s/2+a1];d[H][s1.BLKSIZE_s/2-a1]=(m1*m1+P1*P1)*.5}}function R1(o,c,M,E){var H=o.internal_flags;o.athaa_loudapprox==2&&M<2&&(H.loudness_sq[c][M]=H.loudness_sq_save[M],H.loudness_sq_save[M]=W(E,H))}var w1=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function S1(o,c,M,E,H,d,C,z,X,a1){for(var Q=ue([2,576]),t1=o.internal_flags,m1=t1.channels_out,P1=o.mode==p.JOINT_STEREO?4:m1,o1=0;o1<m1;o1++){firbuf=c[o1];for(var x1=M+576-350-U+192,J=0;J<576;J++){var M1,O1;M1=firbuf[x1+J+10],O1=0;for(var l1=0;l1<(U-1)/2-1;l1+=2)M1+=w1[l1]*(firbuf[x1+J+l1]+firbuf[x1+J+U-l1]),O1+=w1[l1+1]*(firbuf[x1+J+l1+1]+firbuf[x1+J+U-l1-1]);Q[o1][J]=M1+O1}H[E][o1].en.assign(t1.en[o1]),H[E][o1].thm.assign(t1.thm[o1]),P1>2&&(d[E][o1].en.assign(t1.en[o1+2]),d[E][o1].thm.assign(t1.thm[o1+2]))}for(var o1=0;o1<P1;o1++){var A1=ee(12),f1=ee(12),I1=[0,0,0,0],q1=Q[o1&1],d1=0,D1=o1==3?t1.nsPsy.attackthre_s:t1.nsPsy.attackthre,H1=1;if(o1==2)for(var J=0,l1=576;l1>0;++J,--l1){var Z1=Q[0][J],fe=Q[1][J];Q[0][J]=Z1+fe,Q[1][J]=Z1-fe}for(var J=0;J<3;J++)f1[J]=t1.nsPsy.last_en_subshort[o1][J+6],X1(t1.nsPsy.last_en_subshort[o1][J+4]>0),A1[J]=f1[J]/t1.nsPsy.last_en_subshort[o1][J+4],I1[0]+=f1[J];for(var J=0;J<9;J++){for(var $1=d1+64,G1=1;d1<$1;d1++)G1<Math.abs(q1[d1])&&(G1=Math.abs(q1[d1]));t1.nsPsy.last_en_subshort[o1][J]=f1[J+3]=G1,I1[1+J/3]+=G1,G1>f1[J+3-2]?(X1(f1[J+3-2]>0),G1=G1/f1[J+3-2]):f1[J+3-2]>G1*10?G1=f1[J+3-2]/(G1*10):G1=0,A1[J+3]=G1}for(var J=0;J<3;++J){var _e=f1[J*3+3]+f1[J*3+4]+f1[J*3+5],ce=1;f1[J*3+5]*6<_e&&(ce*=.5,f1[J*3+4]*6<_e&&(ce*=.5)),z[o1][J]=ce}if(o.analysis){for(var he=A1[0],J=1;J<12;J++)he<A1[J]&&(he=A1[J]);t1.pinfo.ers[E][o1]=t1.pinfo.ers_save[o1],t1.pinfo.ers_save[o1]=he}for(var J=0;J<12;J++)X[o1][J/3]==0&&A1[J]>D1&&(X[o1][J/3]=J%3+1);for(var J=1;J<4;J++){var ve=I1[J-1],we=I1[J],se=Math.max(ve,we);se<4e4&&ve<1.7*we&&we<1.7*ve&&(J==1&&X[o1][0]<=X[o1][J]&&(X[o1][0]=0),X[o1][J]=0)}X[o1][0]<=t1.nsPsy.lastAttacks[o1]&&(X[o1][0]=0),(t1.nsPsy.lastAttacks[o1]==3||X[o1][0]+X[o1][1]+X[o1][2]+X[o1][3]!=0)&&(H1=0,X[o1][1]!=0&&X[o1][0]!=0&&(X[o1][1]=0),X[o1][2]!=0&&X[o1][1]!=0&&(X[o1][2]=0),X[o1][3]!=0&&X[o1][2]!=0&&(X[o1][3]=0)),o1<2?a1[o1]=H1:H1==0&&(a1[0]=a1[1]=0),C[o1]=t1.tot_ener[o1]}}function y1(o,c,M){if(M==0)for(var E=0;E<o.npart_s;E++)o.nb_s2[c][E]=o.nb_s1[c][E],o.nb_s1[c][E]=0}function j1(o,c){for(var M=0;M<o.npart_l;M++)o.nb_2[c][M]=o.nb_1[c][M],o.nb_1[c][M]=0}function me(o,c,M,E){var H=P.length-1,d=0,C=M[d]+M[d+1];if(C>0){var z=c[d];z<c[d+1]&&(z=c[d+1]),X1(o.numlines_s[d]+o.numlines_s[d+1]-1>0),C=20*(z*2-C)/(C*(o.numlines_s[d]+o.numlines_s[d+1]-1));var X=0|C;X>H&&(X=H),E[d]=X}else E[d]=0;for(d=1;d<o.npart_s-1;d++)if(C=M[d-1]+M[d]+M[d+1],X1(d+1<o.npart_s),C>0){var z=c[d-1];z<c[d]&&(z=c[d]),z<c[d+1]&&(z=c[d+1]),X1(o.numlines_s[d-1]+o.numlines_s[d]+o.numlines_s[d+1]-1>0),C=20*(z*3-C)/(C*(o.numlines_s[d-1]+o.numlines_s[d]+o.numlines_s[d+1]-1));var X=0|C;X>H&&(X=H),E[d]=X}else E[d]=0;if(X1(d==o.npart_s-1),C=M[d-1]+M[d],C>0){var z=c[d-1];z<c[d]&&(z=c[d]),X1(o.numlines_s[d-1]+o.numlines_s[d]-1>0),C=20*(z*2-C)/(C*(o.numlines_s[d-1]+o.numlines_s[d]-1));var X=0|C;X>H&&(X=H),E[d]=X}else E[d]=0;X1(d==o.npart_s-1)}function s(o,c,M,E,H,d){var C=o.internal_flags,z=new float[s1.CBANDS],X=ee(s1.CBANDS),a1,Q,t1,m1=new int[s1.CBANDS];for(t1=Q=0;t1<C.npart_s;++t1){var P1=0,o1=0,x1=C.numlines_s[t1];for(a1=0;a1<x1;++a1,++Q){var J=c[d][Q];P1+=J,o1<J&&(o1=J)}M[t1]=P1,z[t1]=o1,X[t1]=P1/x1,X1(X[t1]>=0)}for(X1(t1==C.npart_s);t1<s1.CBANDS;++t1)z[t1]=0,X[t1]=0;for(me(C,z,X,m1),Q=t1=0;t1<C.npart_s;t1++){var M1=C.s3ind_s[t1][0],O1=C.s3ind_s[t1][1],l1,A1,f1,I1,q1;for(l1=m1[M1],A1=1,I1=C.s3_ss[Q]*M[M1]*P[m1[M1]],++Q,++M1;M1<=O1;)l1+=m1[M1],A1+=1,f1=C.s3_ss[Q]*M[M1]*P[m1[M1]],I1=v(I1,f1,M1-t1),++Q,++M1;l1=(1+2*l1)/(2*A1),q1=P[l1]*.5,I1*=q1,E[t1]=I1,C.nb_s2[H][t1]=C.nb_s1[H][t1],C.nb_s1[H][t1]=I1,f1=z[t1],f1*=C.minval_s[t1],f1*=q1,E[t1]>f1&&(E[t1]=f1),C.masking_lower>1&&(E[t1]*=C.masking_lower),E[t1]>M[t1]&&(E[t1]=M[t1]),C.masking_lower<1&&(E[t1]*=C.masking_lower),X1(E[t1]>=0)}for(;t1<s1.CBANDS;++t1)M[t1]=0,E[t1]=0}function _(o,c,M,E,H){var d=ee(s1.CBANDS),C=ee(s1.CBANDS),z=Te(s1.CBANDS+2),X;y(o,c,M,d,C),q(o,d,C,z);var a1=0;for(X=0;X<o.npart_l;X++){var Q,t1,m1,P1,o1=o.s3ind[X][0],x1=o.s3ind[X][1],J=0,M1=0;for(J=z[o1],M1+=1,t1=o.s3_ll[a1]*M[o1]*P[z[o1]],++a1,++o1;o1<=x1;)J+=z[o1],M1+=1,Q=o.s3_ll[a1]*M[o1]*P[z[o1]],P1=v(t1,Q,o1-X),t1=P1,++a1,++o1;if(J=(1+2*J)/(2*M1),m1=P[J]*.5,t1*=m1,o.blocktype_old[H&1]==s1.SHORT_TYPE){var O1=j*o.nb_1[H][X];O1>0?E[X]=Math.min(t1,O1):E[X]=Math.min(t1,M[X]*D)}else{var l1=K*o.nb_2[H][X],A1=j*o.nb_1[H][X],O1;l1<=0&&(l1=t1),A1<=0&&(A1=t1),o.blocktype_old[H&1]==s1.NORM_TYPE?O1=Math.min(A1,l1):O1=A1,E[X]=Math.min(t1,O1)}o.nb_2[H][X]=o.nb_1[H][X],o.nb_1[H][X]=t1,Q=d[X],Q*=o.minval_l[X],Q*=m1,E[X]>Q&&(E[X]=Q),o.masking_lower>1&&(E[X]*=o.masking_lower),E[X]>M[X]&&(E[X]=M[X]),o.masking_lower<1&&(E[X]*=o.masking_lower),X1(E[X]>=0)}for(;X<s1.CBANDS;++X)M[X]=0,E[X]=0}function g1(o,c){var M=o.internal_flags;o.short_blocks==Xe.short_block_coupled&&!(c[0]!=0&&c[1]!=0)&&(c[0]=c[1]=0);for(var E=0;E<M.channels_out;E++)o.short_blocks==Xe.short_block_dispensed&&(c[E]=1),o.short_blocks==Xe.short_block_forced&&(c[E]=0)}function B1(o,c,M){for(var E=o.internal_flags,H=0;H<E.channels_out;H++){var d=s1.NORM_TYPE;c[H]!=0?(X1(E.blocktype_old[H]!=s1.START_TYPE),E.blocktype_old[H]==s1.SHORT_TYPE&&(d=s1.STOP_TYPE)):(d=s1.SHORT_TYPE,E.blocktype_old[H]==s1.NORM_TYPE&&(E.blocktype_old[H]=s1.START_TYPE),E.blocktype_old[H]==s1.STOP_TYPE&&(E.blocktype_old[H]=s1.SHORT_TYPE)),M[H]=E.blocktype_old[H],E.blocktype_old[H]=d}}function L1(o,c,M,E,H,d,C){for(var z=d*2,X=d>0?Math.pow(10,H):1,a1,Q,t1=0;t1<C;++t1){var m1=o[2][t1],P1=o[3][t1],o1=c[0][t1],x1=c[1][t1],J=c[2][t1],M1=c[3][t1];if(o1<=1.58*x1&&x1<=1.58*o1){var O1=M[t1]*P1,l1=M[t1]*m1;Q=Math.max(J,Math.min(M1,O1)),a1=Math.max(M1,Math.min(J,l1))}else Q=J,a1=M1;if(d>0){var A1,f1,I1=E[t1]*X;if(A1=Math.min(Math.max(o1,I1),Math.max(x1,I1)),J=Math.max(Q,I1),M1=Math.max(a1,I1),f1=J+M1,f1>0&&A1*z<f1){var q1=A1*z/f1;J*=q1,M1*=q1}Q=Math.min(J,Q),a1=Math.min(M1,a1)}Q>m1&&(Q=m1),a1>P1&&(a1=P1),c[2][t1]=Q,c[3][t1]=a1}}this.L3psycho_anal_vbr=function(o,c,M,E,H,d,C,z,X,a1){var Q=o.internal_flags,t1,m1,P1=ee(s1.HBLKSIZE),o1=ue([3,s1.HBLKSIZE_s]),x1=ue([2,s1.BLKSIZE]),J=ue([2,3,s1.BLKSIZE_s]),M1=ue([4,s1.CBANDS]),O1=ue([4,s1.CBANDS]),l1=ue([4,3]),A1=.6,f1=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],I1=Te(2),q1=o.mode==p.JOINT_STEREO?4:Q.channels_out;S1(o,c,M,E,H,d,X,l1,f1,I1),g1(o,I1);{for(var d1=0;d1<q1;d1++){var D1=d1&1;t1=x1,h1(o,c,M,d1,E,P1,t1,D1),R1(o,E,d1,P1),I1[D1]!=0?_(Q,P1,M1[d1],O1[d1],d1):j1(Q,d1)}I1[0]+I1[1]==2&&o.mode==p.JOINT_STEREO&&L1(M1,O1,Q.mld_cb_l,Q.ATH.cb_l,o.ATHlower*Q.ATH.adjust,o.msfix,Q.npart_l);for(var d1=0;d1<q1;d1++){var D1=d1&1;I1[D1]!=0&&B(Q,M1[d1],O1[d1],d1)}}{for(var H1=0;H1<3;H1++){for(var d1=0;d1<q1;++d1){var D1=d1&1;I1[D1]!=0?y1(Q,d1,H1):(m1=J,v1(o,c,M,d1,H1,o1,m1,D1),s(o,o1,M1[d1],O1[d1],d1,H1))}I1[0]+I1[1]==0&&o.mode==p.JOINT_STEREO&&L1(M1,O1,Q.mld_cb_s,Q.ATH.cb_s,o.ATHlower*Q.ATH.adjust,o.msfix,Q.npart_s);for(var d1=0;d1<q1;++d1){var D1=d1&1;I1[D1]==0&&G(Q,M1[d1],O1[d1],d1,H1)}}for(var d1=0;d1<q1;d1++){var D1=d1&1;if(I1[D1]==0)for(var Z1=0;Z1<s1.SBMAX_s;Z1++){for(var fe=ee(3),H1=0;H1<3;H1++){var $1=Q.thm[d1].s[Z1][H1];if($1*=g,f1[d1][H1]>=2||f1[d1][H1+1]==1){var G1=H1!=0?H1-1:2,_e=t(Q.thm[d1].s[Z1][G1],$1,m*A1);$1=Math.min($1,_e)}else if(f1[d1][H1]==1){var G1=H1!=0?H1-1:2,_e=t(Q.thm[d1].s[Z1][G1],$1,D*A1);$1=Math.min($1,_e)}else if(H1!=0&&f1[d1][H1-1]==3||H1==0&&Q.nsPsy.lastAttacks[d1]==3){var G1=H1!=2?H1+1:0,_e=t(Q.thm[d1].s[Z1][G1],$1,D*A1);$1=Math.min($1,_e)}$1*=l1[d1][H1],fe[H1]=$1}for(var H1=0;H1<3;H1++)Q.thm[d1].s[Z1][H1]=fe[H1]}}}for(var d1=0;d1<q1;d1++)Q.nsPsy.lastAttacks[d1]=f1[d1][2];B1(o,I1,a1);for(var d1=0;d1<q1;d1++){var ce,he,ve,we;d1>1?(ce=z,he=-2,ve=s1.NORM_TYPE,(a1[0]==s1.SHORT_TYPE||a1[1]==s1.SHORT_TYPE)&&(ve=s1.SHORT_TYPE),we=d[E][d1-2]):(ce=C,he=0,ve=a1[d1],we=H[E][d1]),ve==s1.SHORT_TYPE?ce[he+d1]=u(we,Q.masking_lower):ce[he+d1]=e1(we,Q.masking_lower),o.analysis&&(Q.pinfo.pe[E][d1]=ce[he+d1])}return 0};function T1(o,c){var M=o,E;return M>=0?E=-M*27:E=M*c,E<=-72?0:Math.exp(E*r1)}function E1(o){var c=0,M=0;{var E=0,H,d;for(E=0;T1(E,o)>1e-20;E-=1);for(H=E,d=0;Math.abs(d-H)>1e-12;)E=(d+H)/2,T1(E,o)>0?d=E:H=E;c=H}{var E=0,H,d;for(E=0;T1(E,o)>1e-20;E+=1);for(H=0,d=E;Math.abs(d-H)>1e-12;)E=(d+H)/2,T1(E,o)>0?H=E:d=E;M=d}{var C=0,z=1e3,X;for(X=0;X<=z;++X){var E=c+X*(M-c)/z,a1=T1(E,o);C+=a1}{var Q=(z+1)/(C*(M-c));return Q}}}function k1(o){var c,M,E,H;return c=o,c>=0?c*=3:c*=1.5,c>=.5&&c<=2.5?(H=c-.5,M=8*(H*H-2*H)):M=0,c+=.474,E=15.811389+7.5*c-17.5*Math.sqrt(1+c*c),E<=-60?0:(c=Math.exp((M+E)*r1),c/=.6609193,c)}function N1(o){return o<0&&(o=0),o=o*.001,13*Math.atan(.76*o)+3.5*Math.atan(o*o/(7.5*7.5))}function V1(o,c,M,E,H,d,C,z,X,a1,Q,t1){var m1=ee(s1.CBANDS+1),P1=z/(t1>15?2*576:2*192),o1=Te(s1.HBLKSIZE),x1;z/=X;var J=0,M1=0;for(x1=0;x1<s1.CBANDS;x1++){var O1,l1;for(O1=N1(z*J),m1[x1]=z*J,l1=J;N1(z*l1)-O1<Y&&l1<=X/2;l1++);for(o[x1]=l1-J,M1=x1+1;J<l1;)X1(J<s1.HBLKSIZE),o1[J++]=x1;if(J>X/2){J=X/2,++x1;break}}X1(x1<s1.CBANDS),m1[x1]=z*J;for(var A1=0;A1<t1;A1++){var f1,I1,q1,d1,D1;q1=a1[A1],d1=a1[A1+1],f1=0|Math.floor(.5+Q*(q1-.5)),f1<0&&(f1=0),I1=0|Math.floor(.5+Q*(d1-.5)),I1>X/2&&(I1=X/2),M[A1]=(o1[f1]+o1[I1])/2,c[A1]=o1[I1];var H1=P1*d1;C[A1]=(H1-m1[c[A1]])/(m1[c[A1]+1]-m1[c[A1]]),C[A1]<0?C[A1]=0:C[A1]>1&&(C[A1]=1),D1=N1(z*a1[A1]*Q),D1=Math.min(D1,15.5)/15.5,d[A1]=Math.pow(10,1.25*(1-Math.cos(Math.PI*D1))-2.5)}J=0;for(var Z1=0;Z1<M1;Z1++){var fe=o[Z1],O1,$1;O1=N1(z*J),$1=N1(z*(J+fe-1)),E[Z1]=.5*(O1+$1),O1=N1(z*(J-.5)),$1=N1(z*(J+fe-.5)),H[Z1]=$1-O1,J+=fe}return M1}function b1(o,c,M,E,H,d){var C=ue([s1.CBANDS,s1.CBANDS]),z,X=0;if(d)for(var a1=0;a1<c;a1++)for(z=0;z<c;z++){var Q=k1(M[a1]-M[z])*E[z];C[a1][z]=Q*H[a1]}else for(z=0;z<c;z++)for(var t1=15+Math.min(21/M[z],12),m1=E1(t1),a1=0;a1<c;a1++){var Q=m1*T1(M[a1]-M[z],t1)*E[z];C[a1][z]=Q*H[a1]}for(var a1=0;a1<c;a1++){for(z=0;z<c&&!(C[a1][z]>0);z++);for(o[a1][0]=z,z=c-1;z>0&&!(C[a1][z]>0);z--);o[a1][1]=z,X+=o[a1][1]-o[a1][0]+1}for(var P1=ee(X),o1=0,a1=0;a1<c;a1++)for(z=o[a1][0];z<=o[a1][1];z++)P1[o1++]=C[a1][z];return P1}function F1(o){var c=N1(o);return c=Math.min(c,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*c))-2.5)}this.psymodel_init=function(o){var c=o.internal_flags,M,E=!0,H=13,d=24,C=0,z=0,X=-8.25,a1=-4.5,Q=ee(s1.CBANDS),t1=ee(s1.CBANDS),m1=ee(s1.CBANDS),P1=o.out_samplerate;switch(o.experimentalZ){default:case 0:E=!0;break;case 1:E=!(o.VBR==De.vbr_mtrh||o.VBR==De.vbr_mt);break;case 2:E=!1;break;case 3:H=8,C=-1.75,z=-.0125,X=-8.25,a1=-2.25;break}for(c.ms_ener_ratio_old=.25,c.blocktype_old[0]=c.blocktype_old[1]=s1.NORM_TYPE,M=0;M<4;++M){for(var J=0;J<s1.CBANDS;++J)c.nb_1[M][J]=1e20,c.nb_2[M][J]=1e20,c.nb_s1[M][J]=c.nb_s2[M][J]=1;for(var o1=0;o1<s1.SBMAX_l;o1++)c.en[M].l[o1]=1e20,c.thm[M].l[o1]=1e20;for(var J=0;J<3;++J){for(var o1=0;o1<s1.SBMAX_s;o1++)c.en[M].s[o1][J]=1e20,c.thm[M].s[o1][J]=1e20;c.nsPsy.lastAttacks[M]=0}for(var J=0;J<9;J++)c.nsPsy.last_en_subshort[M][J]=10}for(c.loudness_sq_save[0]=c.loudness_sq_save[1]=0,c.npart_l=V1(c.numlines_l,c.bo_l,c.bm_l,Q,t1,c.mld_l,c.PSY.bo_l_weight,P1,s1.BLKSIZE,c.scalefac_band.l,s1.BLKSIZE/(2*576),s1.SBMAX_l),X1(c.npart_l<s1.CBANDS),M=0;M<c.npart_l;M++){var x1=C;Q[M]>=H&&(x1=z*(Q[M]-H)/(d-H)+C*(d-Q[M])/(d-H)),m1[M]=Math.pow(10,x1/10),c.numlines_l[M]>0?c.rnumlines_l[M]=1/c.numlines_l[M]:c.rnumlines_l[M]=0}c.s3_ll=b1(c.s3ind,c.npart_l,Q,t1,m1,E);var J=0;for(M=0;M<c.npart_l;M++){var M1;M1=na.MAX_VALUE;for(var O1=0;O1<c.numlines_l[M];O1++,J++){var l1=P1*J/(1e3*s1.BLKSIZE),A1;A1=this.ATHformula(l1*1e3,o)-20,A1=Math.pow(10,.1*A1),A1*=c.numlines_l[M],M1>A1&&(M1=A1)}c.ATH.cb_l[M]=M1,M1=-20+Q[M]*20/10,M1>6&&(M1=100),M1<-15&&(M1=-15),M1-=8,c.minval_l[M]=Math.pow(10,M1/10)*c.numlines_l[M]}for(c.npart_s=V1(c.numlines_s,c.bo_s,c.bm_s,Q,t1,c.mld_s,c.PSY.bo_s_weight,P1,s1.BLKSIZE_s,c.scalefac_band.s,s1.BLKSIZE_s/(2*192),s1.SBMAX_s),X1(c.npart_s<s1.CBANDS),J=0,M=0;M<c.npart_s;M++){var M1,x1=X;Q[M]>=H&&(x1=a1*(Q[M]-H)/(d-H)+X*(d-Q[M])/(d-H)),m1[M]=Math.pow(10,x1/10),M1=na.MAX_VALUE;for(var O1=0;O1<c.numlines_s[M];O1++,J++){var l1=P1*J/(1e3*s1.BLKSIZE_s),A1;A1=this.ATHformula(l1*1e3,o)-20,A1=Math.pow(10,.1*A1),A1*=c.numlines_s[M],M1>A1&&(M1=A1)}c.ATH.cb_s[M]=M1,M1=-7+Q[M]*7/12,Q[M]>12&&(M1*=1+Math.log(1+M1)*3.1),Q[M]<12&&(M1*=1+Math.log(1-M1)*2.3),M1<-15&&(M1=-15),M1-=8,c.minval_s[M]=Math.pow(10,M1/10)*c.numlines_s[M]}c.s3_ss=b1(c.s3ind_s,c.npart_s,Q,t1,m1,E),O(),T.init_fft(c),c.decay=Math.exp(-1*A/(p1*P1/192));{var f1;f1=n1,o.exp_nspsytune&2&&(f1=1),Math.abs(o.msfix)>0&&(f1=o.msfix),o.msfix=f1;for(var I1=0;I1<c.npart_l;I1++)c.s3ind[I1][1]>c.npart_l-1&&(c.s3ind[I1][1]=c.npart_l-1)}var q1=576*c.mode_gr/P1;if(c.ATH.decay=Math.pow(10,-12/10*q1),c.ATH.adjust=.01,c.ATH.adjustLimit=1,X1(c.bo_l[s1.SBMAX_l-1]<=c.npart_l),X1(c.bo_s[s1.SBMAX_s-1]<=c.npart_s),o.ATHtype!=-1){var l1,d1=o.out_samplerate/s1.BLKSIZE,D1=0;for(l1=0,M=0;M<s1.BLKSIZE/2;++M)l1+=d1,c.ATH.eql_w[M]=1/Math.pow(10,this.ATHformula(l1,o)/10),D1+=c.ATH.eql_w[M];for(D1=1/D1,M=s1.BLKSIZE/2;--M>=0;)c.ATH.eql_w[M]*=D1}{for(var I1=J=0;I1<c.npart_s;++I1)for(M=0;M<c.numlines_s[I1];++M)++J;for(var I1=J=0;I1<c.npart_l;++I1)for(M=0;M<c.numlines_l[I1];++M)++J}for(J=0,M=0;M<c.npart_l;M++){var l1=P1*(J+c.numlines_l[M]/2)/(1*s1.BLKSIZE);c.mld_cb_l[M]=F1(l1),J+=c.numlines_l[M]}for(;M<s1.CBANDS;++M)c.mld_cb_l[M]=1;for(J=0,M=0;M<c.npart_s;M++){var l1=P1*(J+c.numlines_s[M]/2)/(1*s1.BLKSIZE_s);c.mld_cb_s[M]=F1(l1),J+=c.numlines_s[M]}for(;M<s1.CBANDS;++M)c.mld_cb_s[M]=1;return 0};function U1(o,c){o<-.3&&(o=3410),o/=1e3,o=Math.max(.1,o);var M=3.64*Math.pow(o,-.8)-6.8*Math.exp(-.6*Math.pow(o-3.4,2))+6*Math.exp(-.15*Math.pow(o-8.7,2))+(.6+.04*c)*.001*Math.pow(o,4);return M}this.ATHformula=function(o,c){var M;switch(c.ATHtype){case 0:M=U1(o,9);break;case 1:M=U1(o,-1);break;case 2:M=U1(o,0);break;case 3:M=U1(o,1)+6;break;case 4:M=U1(o,c.ATHcurve);break;default:M=U1(o,0);break}return M}}var Ms=Ss,Rs=Ze;function Bs(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=Rs.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var As=Bs,ks=ae(),ia={};ia.SFBMAX=ks.SBMAX_s*3;var tt=ia,_a=z1,ys=_a.new_float,xe=_a.new_int,dt=tt;function Es(){this.xr=ys(576),this.l3_enc=xe(576),this.scalefac=xe(dt.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=xe(3),this.subblock_gain=xe(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=xe(dt.SFBMAX),this.window=xe(dt.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=xe(4),this.max_nonzero_coeff=0;var p=this;function T(j){return new Int32Array(j)}function A(j){return new Float32Array(j)}this.assign=function(j){p.xr=A(j.xr),p.l3_enc=T(j.l3_enc),p.scalefac=T(j.scalefac),p.xrpow_max=j.xrpow_max,p.part2_3_length=j.part2_3_length,p.big_values=j.big_values,p.count1=j.count1,p.global_gain=j.global_gain,p.scalefac_compress=j.scalefac_compress,p.block_type=j.block_type,p.mixed_block_flag=j.mixed_block_flag,p.table_select=T(j.table_select),p.subblock_gain=T(j.subblock_gain),p.region0_count=j.region0_count,p.region1_count=j.region1_count,p.preflag=j.preflag,p.scalefac_scale=j.scalefac_scale,p.count1table_select=j.count1table_select,p.part2_length=j.part2_length,p.sfb_lmax=j.sfb_lmax,p.sfb_smin=j.sfb_smin,p.psy_lmax=j.psy_lmax,p.sfbmax=j.sfbmax,p.psymax=j.psymax,p.sfbdivide=j.sfbdivide,p.width=T(j.width),p.window=T(j.window),p.count1bits=j.count1bits,p.sfb_partition_table=j.sfb_partition_table.slice(0),p.slen=T(j.slen),p.max_nonzero_coeff=j.max_nonzero_coeff}}var gt=Es,Ts=z1,oa=Ts.new_int,xs=gt;function Ps(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[oa(4),oa(4)];for(var p=0;p<2;p++)for(var T=0;T<2;T++)this.tt[p][T]=new xs}var Vs=Ps,la=z1,at=la.System,st=la.new_int,rt=ae();function Is(p,T,A,j){this.l=st(1+rt.SBMAX_l),this.s=st(1+rt.SBMAX_s),this.psfb21=st(1+rt.PSFB21),this.psfb12=st(1+rt.PSFB12);var K=this.l,N=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],at.arraycopy(this.arrL,0,K,0,Math.min(this.arrL.length,this.l.length)),at.arraycopy(this.arrS,0,N,0,Math.min(this.arrS.length,this.s.length)),at.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),at.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var fa=Is,vt=z1,wt=vt.new_float,Ls=vt.new_float_n,Ns=vt.new_int,ca=ae();function Ds(){this.last_en_subshort=Ls([4,9]),this.lastAttacks=Ns(4),this.pefirbuf=wt(19),this.longfact=wt(ca.SBMAX_l),this.shortfact=wt(ca.SBMAX_s),this.attackthre=0,this.attackthre_s=0}var Xs=Ds;function Os(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var Hs=Os,Oe=z1,Cs=Oe.new_byte,Ys=Oe.new_double,pe=Oe.new_float,Pe=Oe.new_float_n,ge=Oe.new_int,nt=Oe.new_int_n,Fs=Vs,js=fa,qs=Xs,zs=Hs,ha=$t(),W1=ae(),Zs=tt;ke.MFSIZE=3*1152+W1.ENCDELAY-W1.MDCTDELAY,ke.MAX_HEADER_BUF=256,ke.MAX_BITS_PER_CHANNEL=4095,ke.MAX_BITS_PER_GRANULE=7680,ke.BPC=320;function ke(){var p=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=Pe([2,ke.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new Fs,this.ms_ratio=pe(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=ge(2),this.CurrentStep=ge(2),this.masking_lower=0,this.bv_scf=ge(576),this.pseudohalf=ge(Zs.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*ke.BPC+1),this.itime=Ys(2),this.sideinfo_len=0,this.sb_sample=Pe([2,2,18,W1.SBLIMIT]),this.amp_filter=pe(32);function T(){this.write_timing=0,this.ptr=0,this.buf=Cs(p)}this.header=new Array(ke.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new js,this.minval_l=pe(W1.CBANDS),this.minval_s=pe(W1.CBANDS),this.nb_1=Pe([4,W1.CBANDS]),this.nb_2=Pe([4,W1.CBANDS]),this.nb_s1=Pe([4,W1.CBANDS]),this.nb_s2=Pe([4,W1.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=pe(4),this.loudness_sq=Pe([2,2]),this.loudness_sq_save=pe(2),this.mld_l=pe(W1.SBMAX_l),this.mld_s=pe(W1.SBMAX_s),this.bm_l=ge(W1.SBMAX_l),this.bo_l=ge(W1.SBMAX_l),this.bm_s=ge(W1.SBMAX_s),this.bo_s=ge(W1.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=nt([W1.CBANDS,2]),this.s3ind_s=nt([W1.CBANDS,2]),this.numlines_s=ge(W1.CBANDS),this.numlines_l=ge(W1.CBANDS),this.rnumlines_l=pe(W1.CBANDS),this.mld_cb_l=pe(W1.CBANDS),this.mld_cb_s=pe(W1.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=pe(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=ge(2),this.nsPsy=new qs,this.VBR_seek_table=new zs,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=nt([16,5]),this.bitrate_blockType_Hist=nt([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var A=0;A<this.en.length;A++)this.en[A]=new ha;for(var A=0;A<this.thm.length;A++)this.thm[A]=new ha;for(var A=0;A<this.header.length;A++)this.header[A]=new T}var it=ke,Gs=z1,Ve=Gs.new_float,Ie=ae();function Qs(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=Ve(Ie.SBMAX_l),this.s=Ve(Ie.SBMAX_s),this.psfb21=Ve(Ie.PSFB21),this.psfb12=Ve(Ie.PSFB12),this.cb_l=Ve(Ie.CBANDS),this.cb_s=Ve(Ie.CBANDS),this.eql_w=Ve(Ie.BLKSIZE/2)}var Us=Qs,ua=z1,ne=ua.System,pa=ua.Arrays;K1.STEPS_per_dB=100,K1.MAX_dB=120,K1.GAIN_NOT_ENOUGH_SAMPLES=-24601,K1.GAIN_ANALYSIS_ERROR=0,K1.GAIN_ANALYSIS_OK=1,K1.INIT_GAIN_ANALYSIS_ERROR=0,K1.INIT_GAIN_ANALYSIS_OK=1,K1.YULE_ORDER=10,K1.MAX_ORDER=K1.YULE_ORDER,K1.MAX_SAMP_FREQ=48e3,K1.RMS_WINDOW_TIME_NUMERATOR=1,K1.RMS_WINDOW_TIME_DENOMINATOR=20,K1.MAX_SAMPLES_PER_WINDOW=K1.MAX_SAMP_FREQ*K1.RMS_WINDOW_TIME_NUMERATOR/K1.RMS_WINDOW_TIME_DENOMINATOR+1;function K1(){var p=64.82,T=.95,A=K1.RMS_WINDOW_TIME_NUMERATOR,j=K1.RMS_WINDOW_TIME_DENOMINATOR,K=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],N=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function Z(m,D,n1,U,r1,W){for(;r1--!=0;)n1[U]=1e-10+m[D+0]*W[0]-n1[U-1]*W[1]+m[D-1]*W[2]-n1[U-2]*W[3]+m[D-2]*W[4]-n1[U-3]*W[5]+m[D-3]*W[6]-n1[U-4]*W[7]+m[D-4]*W[8]-n1[U-5]*W[9]+m[D-5]*W[10]-n1[U-6]*W[11]+m[D-6]*W[12]-n1[U-7]*W[13]+m[D-7]*W[14]-n1[U-8]*W[15]+m[D-8]*W[16]-n1[U-9]*W[17]+m[D-9]*W[18]-n1[U-10]*W[19]+m[D-10]*W[20],++U,++D}function Y(m,D,n1,U,r1,W){for(;r1--!=0;)n1[U]=m[D+0]*W[0]-n1[U-1]*W[1]+m[D-1]*W[2]-n1[U-2]*W[3]+m[D-2]*W[4],++U,++D}function $(m,D){for(var n1=0;n1<MAX_ORDER;n1++)m.linprebuf[n1]=m.lstepbuf[n1]=m.loutbuf[n1]=m.rinprebuf[n1]=m.rstepbuf[n1]=m.routbuf[n1]=0;switch(0|D){case 48e3:m.reqindex=0;break;case 44100:m.reqindex=1;break;case 32e3:m.reqindex=2;break;case 24e3:m.reqindex=3;break;case 22050:m.reqindex=4;break;case 16e3:m.reqindex=5;break;case 12e3:m.reqindex=6;break;case 11025:m.reqindex=7;break;case 8e3:m.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return m.sampleWindow=0|(D*A+j-1)/j,m.lsum=0,m.rsum=0,m.totsamp=0,pa.ill(m.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(m,D){return $(m,D)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(m.linpre=MAX_ORDER,m.rinpre=MAX_ORDER,m.lstep=MAX_ORDER,m.rstep=MAX_ORDER,m.lout=MAX_ORDER,m.rout=MAX_ORDER,pa.fill(m.B,0),INIT_GAIN_ANALYSIS_OK)};function p1(m){return m*m}this.AnalyzeSamples=function(m,D,n1,U,r1,W,S){var f,h,w,e,l,R,P;if(W==0)return GAIN_ANALYSIS_OK;switch(P=0,l=W,S){case 1:U=D,r1=n1;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(W<MAX_ORDER?(ne.arraycopy(D,n1,m.linprebuf,MAX_ORDER,W),ne.arraycopy(U,r1,m.rinprebuf,MAX_ORDER,W)):(ne.arraycopy(D,n1,m.linprebuf,MAX_ORDER,MAX_ORDER),ne.arraycopy(U,r1,m.rinprebuf,MAX_ORDER,MAX_ORDER));l>0;){R=l>m.sampleWindow-m.totsamp?m.sampleWindow-m.totsamp:l,P<MAX_ORDER?(f=m.linpre+P,h=m.linprebuf,w=m.rinpre+P,e=m.rinprebuf,R>MAX_ORDER-P&&(R=MAX_ORDER-P)):(f=n1+P,h=D,w=r1+P,e=U),Z(h,f,m.lstepbuf,m.lstep+m.totsamp,R,K[m.reqindex]),Z(e,w,m.rstepbuf,m.rstep+m.totsamp,R,K[m.reqindex]),Y(m.lstepbuf,m.lstep+m.totsamp,m.loutbuf,m.lout+m.totsamp,R,N[m.reqindex]),Y(m.rstepbuf,m.rstep+m.totsamp,m.routbuf,m.rout+m.totsamp,R,N[m.reqindex]),f=m.lout+m.totsamp,h=m.loutbuf,w=m.rout+m.totsamp,e=m.routbuf;for(var O=R%8;O--!=0;)m.lsum+=p1(h[f++]),m.rsum+=p1(e[w++]);for(O=R/8;O--!=0;)m.lsum+=p1(h[f+0])+p1(h[f+1])+p1(h[f+2])+p1(h[f+3])+p1(h[f+4])+p1(h[f+5])+p1(h[f+6])+p1(h[f+7]),f+=8,m.rsum+=p1(e[w+0])+p1(e[w+1])+p1(e[w+2])+p1(e[w+3])+p1(e[w+4])+p1(e[w+5])+p1(e[w+6])+p1(e[w+7]),w+=8;if(l-=R,P+=R,m.totsamp+=R,m.totsamp==m.sampleWindow){var k=K1.STEPS_per_dB*10*Math.log10((m.lsum+m.rsum)/m.totsamp*.5+1e-37),x=k<=0?0:0|k;x>=m.A.length&&(x=m.A.length-1),m.A[x]++,m.lsum=m.rsum=0,ne.arraycopy(m.loutbuf,m.totsamp,m.loutbuf,0,MAX_ORDER),ne.arraycopy(m.routbuf,m.totsamp,m.routbuf,0,MAX_ORDER),ne.arraycopy(m.lstepbuf,m.totsamp,m.lstepbuf,0,MAX_ORDER),ne.arraycopy(m.rstepbuf,m.totsamp,m.rstepbuf,0,MAX_ORDER),m.totsamp=0}if(m.totsamp>m.sampleWindow)return GAIN_ANALYSIS_ERROR}return W<MAX_ORDER?(ne.arraycopy(m.linprebuf,W,m.linprebuf,0,MAX_ORDER-W),ne.arraycopy(m.rinprebuf,W,m.rinprebuf,0,MAX_ORDER-W),ne.arraycopy(D,n1,m.linprebuf,MAX_ORDER-W,W),ne.arraycopy(U,r1,m.rinprebuf,MAX_ORDER-W,W)):(ne.arraycopy(D,n1+W-MAX_ORDER,m.linprebuf,0,MAX_ORDER),ne.arraycopy(U,r1+W-MAX_ORDER,m.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function g(m,D){var n1,U=0;for(n1=0;n1<D;n1++)U+=m[n1];if(U==0)return GAIN_NOT_ENOUGH_SAMPLES;var r1=0|Math.ceil(U*(1-T));for(n1=D;n1-- >0&&!((r1-=m[n1])<=0););return p-n1/K1.STEPS_per_dB}this.GetTitleGain=function(m){for(var D=g(m.A,m.A.length),n1=0;n1<m.A.length;n1++)m.B[n1]+=m.A[n1],m.A[n1]=0;for(var n1=0;n1<MAX_ORDER;n1++)m.linprebuf[n1]=m.lstepbuf[n1]=m.loutbuf[n1]=m.rinprebuf[n1]=m.rstepbuf[n1]=m.routbuf[n1]=0;return m.totsamp=0,m.lsum=m.rsum=0,D}}var ma=K1,ba=z1,He=ba.new_float,da=ba.new_int,ie=ma;function Ws(){this.linprebuf=He(ie.MAX_ORDER*2),this.linpre=0,this.lstepbuf=He(ie.MAX_SAMPLES_PER_WINDOW+ie.MAX_ORDER),this.lstep=0,this.loutbuf=He(ie.MAX_SAMPLES_PER_WINDOW+ie.MAX_ORDER),this.lout=0,this.rinprebuf=He(ie.MAX_ORDER*2),this.rinpre=0,this.rstepbuf=He(ie.MAX_SAMPLES_PER_WINDOW+ie.MAX_ORDER),this.rstep=0,this.routbuf=He(ie.MAX_SAMPLES_PER_WINDOW+ie.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=da(0|ie.STEPS_per_dB*ie.MAX_dB),this.B=da(0|ie.STEPS_per_dB*ie.MAX_dB)}var Ks=Ws;function Js(p){this.bits=p}var ga=Js,St=z1,va=St.new_float,$s=St.new_int,wa=St.assert,e0=ga,Sa=ae(),t0=tt,a0=it;function s0(p){var T=p;this.quantize=T,this.iteration_loop=function(A,j,K,N){var Z=A.internal_flags,Y=va(t0.SFBMAX),$=va(576),p1=$s(2),g=0,m,D=Z.l3_side,n1=new e0(g);this.quantize.rv.ResvFrameBegin(A,n1),g=n1.bits;for(var U=0;U<Z.mode_gr;U++){m=this.quantize.qupvt.on_pe(A,j,p1,g,U,U),Z.mode_ext==Sa.MPG_MD_MS_LR&&(this.quantize.ms_convert(Z.l3_side,U),this.quantize.qupvt.reduce_side(p1,K[U],g,m));for(var r1=0;r1<Z.channels_out;r1++){var W,S,f=D.tt[U][r1];f.block_type!=Sa.SHORT_TYPE?(W=0,S=Z.PSY.mask_adjust-W):(W=0,S=Z.PSY.mask_adjust_short-W),Z.masking_lower=Math.pow(10,S*.1),this.quantize.init_outer_loop(Z,f),this.quantize.init_xrpow(Z,f,$)&&(this.quantize.qupvt.calc_xmin(A,N[U][r1],f,Y),this.quantize.outer_loop(A,f,Y,$,r1,p1[r1])),this.quantize.iteration_finish_one(Z,U,r1),wa(f.part2_3_length<=a0.MAX_BITS_PER_CHANNEL),wa(f.part2_3_length<=p1[r1])}}this.quantize.rv.ResvFrameEnd(Z,g)}}var r0=s0;function C1(p,T,A,j){this.xlen=p,this.linmax=T,this.table=A,this.hlen=j}var c1={};c1.t1HB=[1,1,1,0],c1.t2HB=[1,2,1,3,1,1,3,2,0],c1.t3HB=[3,2,1,1,1,1,3,2,0],c1.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],c1.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],c1.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],c1.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],c1.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],c1.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],c1.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],c1.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],c1.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],c1.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],c1.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],c1.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],c1.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],c1.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],c1.t1l=[1,4,3,5],c1.t2l=[1,4,7,4,5,7,6,7,8],c1.t3l=[2,3,7,4,4,7,6,7,8],c1.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],c1.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],c1.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],c1.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],c1.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],c1.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],c1.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],c1.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],c1.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],c1.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],c1.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],c1.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],c1.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],c1.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],c1.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],c1.ht=[new C1(0,0,null,null),new C1(2,0,c1.t1HB,c1.t1l),new C1(3,0,c1.t2HB,c1.t2l),new C1(3,0,c1.t3HB,c1.t3l),new C1(0,0,null,null),new C1(4,0,c1.t5HB,c1.t5l),new C1(4,0,c1.t6HB,c1.t6l),new C1(6,0,c1.t7HB,c1.t7l),new C1(6,0,c1.t8HB,c1.t8l),new C1(6,0,c1.t9HB,c1.t9l),new C1(8,0,c1.t10HB,c1.t10l),new C1(8,0,c1.t11HB,c1.t11l),new C1(8,0,c1.t12HB,c1.t12l),new C1(16,0,c1.t13HB,c1.t13l),new C1(0,0,null,c1.t16_5l),new C1(16,0,c1.t15HB,c1.t15l),new C1(1,1,c1.t16HB,c1.t16l),new C1(2,3,c1.t16HB,c1.t16l),new C1(3,7,c1.t16HB,c1.t16l),new C1(4,15,c1.t16HB,c1.t16l),new C1(6,63,c1.t16HB,c1.t16l),new C1(8,255,c1.t16HB,c1.t16l),new C1(10,1023,c1.t16HB,c1.t16l),new C1(13,8191,c1.t16HB,c1.t16l),new C1(4,15,c1.t24HB,c1.t24l),new C1(5,31,c1.t24HB,c1.t24l),new C1(6,63,c1.t24HB,c1.t24l),new C1(7,127,c1.t24HB,c1.t24l),new C1(8,255,c1.t24HB,c1.t24l),new C1(9,511,c1.t24HB,c1.t24l),new C1(11,2047,c1.t24HB,c1.t24l),new C1(13,8191,c1.t24HB,c1.t24l),new C1(0,0,c1.t32HB,c1.t32l),new C1(0,0,c1.t33HB,c1.t33l)],c1.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],c1.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],c1.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],c1.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],c1.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],c1.scfsi_band=[0,6,11,16,21];var Mt=c1,Rt,Ma;function Ra(){if(Ma)return Rt;Ma=1;var p=fa,T=z1,A=T.VbrMode,j=T.Float,K=T.Util,N=T.new_float,Z=T.new_int,Y=T.assert,$=ae(),p1=ga,g=it;m.Q_MAX=257,m.Q_MAX2=116,m.LARGE_BITS=1e5,m.IXMAX_VAL=8206;function m(){var D=kt(),n1=null,U=null,r1=null;this.setModules=function(v,V,L){n1=v,U=V,r1=L};function W(v){return Y(0<=v+m.Q_MAX2&&v<m.Q_MAX),P[v+m.Q_MAX2]}this.IPOW20=function(v){return Y(0<=v&&v<m.Q_MAX),O[v]};var S=2220446049250313e-31,f=m.IXMAX_VAL,h=f+2,w=m.Q_MAX,e=m.Q_MAX2;m.LARGE_BITS;var l=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var R=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=R,this.sfBandIndex=[new p([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new p([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new p([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new p([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new p([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new p([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new p([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new p([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new p([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var P=N(w+e+1),O=N(w),k=N(h),x=N(h);this.adj43=x;function _1(v,V){var L=r1.ATHformula(V,v);return L-=l,L=Math.pow(10,L/10+v.ATHlower),L}function b(v){for(var V=v.internal_flags.ATH.l,L=v.internal_flags.ATH.psfb21,I=v.internal_flags.ATH.s,G=v.internal_flags.ATH.psfb12,B=v.internal_flags,n=v.out_samplerate,r=0;r<$.SBMAX_l;r++){var t=B.scalefac_band.l[r],i=B.scalefac_band.l[r+1];V[r]=j.MAX_VALUE;for(var u=t;u<i;u++){var F=u*n/1152,e1=_1(v,F);V[r]=Math.min(V[r],e1)}}for(var r=0;r<$.PSFB21;r++){var t=B.scalefac_band.psfb21[r],i=B.scalefac_band.psfb21[r+1];L[r]=j.MAX_VALUE;for(var u=t;u<i;u++){var F=u*n/1152,e1=_1(v,F);L[r]=Math.min(L[r],e1)}}for(var r=0;r<$.SBMAX_s;r++){var t=B.scalefac_band.s[r],i=B.scalefac_band.s[r+1];I[r]=j.MAX_VALUE;for(var u=t;u<i;u++){var F=u*n/384,e1=_1(v,F);I[r]=Math.min(I[r],e1)}I[r]*=B.scalefac_band.s[r+1]-B.scalefac_band.s[r]}for(var r=0;r<$.PSFB12;r++){var t=B.scalefac_band.psfb12[r],i=B.scalefac_band.psfb12[r+1];G[r]=j.MAX_VALUE;for(var u=t;u<i;u++){var F=u*n/384,e1=_1(v,F);G[r]=Math.min(G[r],e1)}G[r]*=B.scalefac_band.s[13]-B.scalefac_band.s[12]}if(v.noATH){for(var r=0;r<$.SBMAX_l;r++)V[r]=1e-20;for(var r=0;r<$.PSFB21;r++)L[r]=1e-20;for(var r=0;r<$.SBMAX_s;r++)I[r]=1e-20;for(var r=0;r<$.PSFB12;r++)G[r]=1e-20}B.ATH.floor=10*Math.log10(_1(v,-1))}this.iteration_init=function(v){var V=v.internal_flags,L=V.l3_side,I;if(V.iteration_init_init==0){for(V.iteration_init_init=1,L.main_data_begin=0,b(v),k[0]=0,I=1;I<h;I++)k[I]=Math.pow(I,4/3);for(I=0;I<h-1;I++)x[I]=I+1-Math.pow(.5*(k[I]+k[I+1]),.75);for(x[I]=.5,I=0;I<w;I++)O[I]=Math.pow(2,(I-210)*-.1875);for(I=0;I<=w+e;I++)P[I]=Math.pow(2,(I-210-e)*.25);n1.huffman_init(V);{var G,B,n,r;for(I=v.exp_nspsytune>>2&63,I>=32&&(I-=64),G=Math.pow(10,I/4/10),I=v.exp_nspsytune>>8&63,I>=32&&(I-=64),B=Math.pow(10,I/4/10),I=v.exp_nspsytune>>14&63,I>=32&&(I-=64),n=Math.pow(10,I/4/10),I=v.exp_nspsytune>>20&63,I>=32&&(I-=64),r=n*Math.pow(10,I/4/10),I=0;I<$.SBMAX_l;I++){var t;I<=6?t=G:I<=13?t=B:I<=20?t=n:t=r,V.nsPsy.longfact[I]=t}for(I=0;I<$.SBMAX_s;I++){var t;I<=5?t=G:I<=10?t=B:I<=11?t=n:t=r,V.nsPsy.shortfact[I]=t}}}},this.on_pe=function(v,V,L,I,G,B){var n=v.internal_flags,r=0,t,i=Z(2),u,F=new p1(r),e1=U.ResvMaxBits(v,I,F,B);r=F.bits;var y=r+e1;for(y>g.MAX_BITS_PER_GRANULE&&(y=g.MAX_BITS_PER_GRANULE),t=0,u=0;u<n.channels_out;++u)L[u]=Math.min(g.MAX_BITS_PER_CHANNEL,r/n.channels_out),i[u]=0|L[u]*V[G][u]/700-L[u],i[u]>I*3/4&&(i[u]=I*3/4),i[u]<0&&(i[u]=0),i[u]+L[u]>g.MAX_BITS_PER_CHANNEL&&(i[u]=Math.max(0,g.MAX_BITS_PER_CHANNEL-L[u])),t+=i[u];if(t>e1)for(u=0;u<n.channels_out;++u)i[u]=e1*i[u]/t;for(u=0;u<n.channels_out;++u)L[u]+=i[u],e1-=i[u];for(t=0,u=0;u<n.channels_out;++u)t+=L[u];if(t>g.MAX_BITS_PER_GRANULE){var q=0;for(u=0;u<n.channels_out;++u)L[u]*=g.MAX_BITS_PER_GRANULE,L[u]/=t,q+=L[u]}return y},this.reduce_side=function(v,V,L,I){Y(v[0]+v[1]<=g.MAX_BITS_PER_GRANULE);var G=.33*(.5-V)/.5;G<0&&(G=0),G>.5&&(G=.5);var B=0|G*.5*(v[0]+v[1]);B>g.MAX_BITS_PER_CHANNEL-v[0]&&(B=g.MAX_BITS_PER_CHANNEL-v[0]),B<0&&(B=0),v[1]>=125&&(v[1]-B>125?(v[0]<L&&(v[0]+=B),v[1]-=B):(v[0]+=v[1]-125,v[1]=125)),B=v[0]+v[1],B>I&&(v[0]=I*v[0]/B,v[1]=I*v[1]/B),Y(v[0]<=g.MAX_BITS_PER_CHANNEL),Y(v[1]<=g.MAX_BITS_PER_CHANNEL),Y(v[0]+v[1]<=g.MAX_BITS_PER_GRANULE)},this.athAdjust=function(v,V,L){var I=90.30873362,G=94.82444863,B=K.FAST_LOG10_X(V,10),n=v*v,r=0;return B-=L,n>1e-20&&(r=1+K.FAST_LOG10_X(n,10/I)),r<0&&(r=0),B*=r,B+=L+I-G,Math.pow(10,.1*B)},this.calc_xmin=function(v,V,L,I){var G=0,B=v.internal_flags,n,r=0,t=0,i=B.ATH,u=L.xr,F=v.VBR==A.vbr_mtrh?1:0,e1=B.masking_lower;for((v.VBR==A.vbr_mtrh||v.VBR==A.vbr_mt)&&(e1=1),n=0;n<L.psy_lmax;n++){var y,q,i1,h1,v1,R1;v.VBR==A.vbr_rh||v.VBR==A.vbr_mtrh?q=athAdjust(i.adjust,i.l[n],i.floor):q=i.adjust*i.l[n],v1=L.width[n],i1=q/v1,h1=S,R1=v1>>1,y=0;do{var w1,S1;w1=u[r]*u[r],y+=w1,h1+=w1<i1?w1:i1,r++,S1=u[r]*u[r],y+=S1,h1+=S1<i1?S1:i1,r++}while(--R1>0);if(y>q&&t++,n==$.SBPSY_l){var y1=q*B.nsPsy.longfact[n];h1<y1&&(h1=y1)}if(F!=0&&(q=h1),!v.ATHonly){var j1=V.en.l[n];if(j1>0){var y1;y1=y*V.thm.l[n]*e1/j1,F!=0&&(y1*=B.nsPsy.longfact[n]),q<y1&&(q=y1)}}F!=0?I[G++]=q:I[G++]=q*B.nsPsy.longfact[n]}var me=575;if(L.block_type!=$.SHORT_TYPE)for(var s=576;s--!=0&&D.EQ(u[s],0);)me=s;L.max_nonzero_coeff=me;for(var _=L.sfb_smin;n<L.psymax;_++,n+=3){var v1,g1,B1;for(v.VBR==A.vbr_rh||v.VBR==A.vbr_mtrh?B1=athAdjust(i.adjust,i.s[_],i.floor):B1=i.adjust*i.s[_],v1=L.width[n],g1=0;g1<3;g1++){var y=0,q,i1,h1,R1=v1>>1;i1=B1/v1,h1=S;do{var w1,S1;w1=u[r]*u[r],y+=w1,h1+=w1<i1?w1:i1,r++,S1=u[r]*u[r],y+=S1,h1+=S1<i1?S1:i1,r++}while(--R1>0);if(y>B1&&t++,_==$.SBPSY_s){var y1=B1*B.nsPsy.shortfact[_];h1<y1&&(h1=y1)}if(F!=0?q=h1:q=B1,!v.ATHonly&&!v.ATHshort){var j1=V.en.s[_][g1];if(j1>0){var y1;y1=y*V.thm.s[_][g1]*e1/j1,F!=0&&(y1*=B.nsPsy.shortfact[_]),q<y1&&(q=y1)}}F!=0?I[G++]=q:I[G++]=q*B.nsPsy.shortfact[_]}v.useTemporal&&(I[G-3]>I[G-3+1]&&(I[G-3+1]+=(I[G-3]-I[G-3+1])*B.decay),I[G-3+1]>I[G-3+2]&&(I[G-3+2]+=(I[G-3+1]-I[G-3+2])*B.decay))}return t};function a(v){this.s=v}this.calc_noise_core=function(v,V,L,I){var G=0,B=V.s,n=v.l3_enc;if(B>v.count1)for(;L--!=0;){var r;r=v.xr[B],B++,G+=r*r,r=v.xr[B],B++,G+=r*r}else if(B>v.big_values){var t=N(2);for(t[0]=0,t[1]=I;L--!=0;){var r;r=Math.abs(v.xr[B])-t[n[B]],B++,G+=r*r,r=Math.abs(v.xr[B])-t[n[B]],B++,G+=r*r}}else for(;L--!=0;){var r;r=Math.abs(v.xr[B])-k[n[B]]*I,B++,G+=r*r,r=Math.abs(v.xr[B])-k[n[B]]*I,B++,G+=r*r}return V.s=B,G},this.calc_noise=function(v,V,L,I,G){var B=0,n=0,r,t,i=0,u=0,F=0,e1=-20,y=0,q=v.scalefac,i1=0;for(I.over_SSD=0,r=0;r<v.psymax;r++){var h1=v.global_gain-(q[i1++]+(v.preflag!=0?R[r]:0)<<v.scalefac_scale+1)-v.subblock_gain[v.window[r]]*8,v1=0;if(G!=null&&G.step[r]==h1)v1=G.noise[r],y+=v.width[r],L[B++]=v1/V[n++],v1=G.noise_log[r];else{var R1=W(h1);if(t=v.width[r]>>1,y+v.width[r]>v.max_nonzero_coeff){var w1;w1=v.max_nonzero_coeff-y+1,w1>0?t=w1>>1:t=0}var S1=new a(y);v1=this.calc_noise_core(v,S1,t,R1),y=S1.s,G!=null&&(G.step[r]=h1,G.noise[r]=v1),v1=L[B++]=v1/V[n++],v1=K.FAST_LOG10(Math.max(v1,1e-20)),G!=null&&(G.noise_log[r]=v1)}if(G!=null&&(G.global_gain=v.global_gain),F+=v1,v1>0){var y1;y1=Math.max(0|v1*10+.5,1),I.over_SSD+=y1*y1,i++,u+=v1}e1=Math.max(e1,v1)}return I.over_count=i,I.tot_noise=F,I.over_noise=u,I.max_noise=e1,i},this.set_pinfo=function(v,V,L,I,G){var B=v.internal_flags,n,r,t,i,u,F=V.scalefac_scale==0?.5:1,e1=V.scalefac,y=N(L3Side.SFBMAX),q=N(L3Side.SFBMAX),i1=new CalcNoiseResult;calc_xmin(v,L,V,y),calc_noise(V,y,q,i1,null);var h1=0;for(r=V.sfb_lmax,V.block_type!=$.SHORT_TYPE&&V.mixed_block_flag==0&&(r=22),n=0;n<r;n++){var v1=B.scalefac_band.l[n],R1=B.scalefac_band.l[n+1],w1=R1-v1;for(i=0;h1<R1;h1++)i+=V.xr[h1]*V.xr[h1];i/=w1,u=1e15,B.pinfo.en[I][G][n]=u*i,B.pinfo.xfsf[I][G][n]=u*y[n]*q[n]/w1,L.en.l[n]>0&&!v.ATHonly?i=i/L.en.l[n]:i=0,B.pinfo.thr[I][G][n]=u*Math.max(i*L.thm.l[n],B.ATH.l[n]),B.pinfo.LAMEsfb[I][G][n]=0,V.preflag!=0&&n>=11&&(B.pinfo.LAMEsfb[I][G][n]=-F*R[n]),n<$.SBPSY_l&&(Y(e1[n]>=0),B.pinfo.LAMEsfb[I][G][n]-=F*e1[n])}if(V.block_type==$.SHORT_TYPE)for(r=n,n=V.sfb_smin;n<$.SBMAX_s;n++)for(var v1=B.scalefac_band.s[n],R1=B.scalefac_band.s[n+1],w1=R1-v1,S1=0;S1<3;S1++){for(i=0,t=v1;t<R1;t++)i+=V.xr[h1]*V.xr[h1],h1++;i=Math.max(i/w1,1e-20),u=1e15,B.pinfo.en_s[I][G][3*n+S1]=u*i,B.pinfo.xfsf_s[I][G][3*n+S1]=u*y[r]*q[r]/w1,L.en.s[n][S1]>0?i=i/L.en.s[n][S1]:i=0,(v.ATHonly||v.ATHshort)&&(i=0),B.pinfo.thr_s[I][G][3*n+S1]=u*Math.max(i*L.thm.s[n][S1],B.ATH.s[n]),B.pinfo.LAMEsfb_s[I][G][3*n+S1]=-2*V.subblock_gain[S1],n<$.SBPSY_s&&(B.pinfo.LAMEsfb_s[I][G][3*n+S1]-=F*e1[r]),r++}B.pinfo.LAMEqss[I][G]=V.global_gain,B.pinfo.LAMEmainbits[I][G]=V.part2_3_length+V.part2_length,B.pinfo.LAMEsfbits[I][G]=V.part2_length,B.pinfo.over[I][G]=i1.over_count,B.pinfo.max_noise[I][G]=i1.max_noise*10,B.pinfo.over_noise[I][G]=i1.over_noise*10,B.pinfo.tot_noise[I][G]=i1.tot_noise*10,B.pinfo.over_SSD[I][G]=i1.over_SSD}}return Rt=m,Rt}var Bt,Ba;function Aa(){if(Ba)return Bt;Ba=1;var p=z1,T=p.System,A=p.Arrays,j=p.new_int,K=p.assert,N=ae(),Z=Mt,Y=gt,$=Ra();function p1(){var g=null;this.qupvt=null,this.setModules=function(B){this.qupvt=B,g=B};function m(B){this.bits=0|B}var D=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function n1(B,n,r,t,i,u){var F=.5946/n;for(B=B>>1;B--!=0;)i[u++]=F>r[t++]?0:1,i[u++]=F>r[t++]?0:1}function U(B,n,r,t,i,u){B=B>>1;var F=B%2;for(B=B>>1;B--!=0;){var e1,y,q,i1,h1,v1,R1,w1;e1=r[t++]*n,y=r[t++]*n,h1=0|e1,q=r[t++]*n,v1=0|y,i1=r[t++]*n,R1=0|q,e1+=g.adj43[h1],w1=0|i1,y+=g.adj43[v1],i[u++]=0|e1,q+=g.adj43[R1],i[u++]=0|y,i1+=g.adj43[w1],i[u++]=0|q,i[u++]=0|i1}if(F!=0){var e1,y,h1,v1;e1=r[t++]*n,y=r[t++]*n,h1=0|e1,v1=0|y,e1+=g.adj43[h1],y+=g.adj43[v1],i[u++]=0|e1,i[u++]=0|y}}function r1(B,n,r,t,i){var u,F,e1=0,y,q=0,i1=0,h1=0,v1=n,R1=0,w1=v1,S1=0,y1=B,j1=0;for(y=i!=null&&t.global_gain==i.global_gain,t.block_type==N.SHORT_TYPE?F=38:F=21,u=0;u<=F;u++){var me=-1;if((y||t.block_type==N.NORM_TYPE)&&(me=t.global_gain-(t.scalefac[u]+(t.preflag!=0?g.pretab[u]:0)<<t.scalefac_scale+1)-t.subblock_gain[t.window[u]]*8),K(t.width[u]>=0),y&&i.step[u]==me)q!=0&&(U(q,r,y1,j1,w1,S1),q=0),i1!=0&&(n1(i1,r,y1,j1,w1,S1),i1=0);else{var s=t.width[u];if(e1+t.width[u]>t.max_nonzero_coeff){var _;_=t.max_nonzero_coeff-e1+1,A.fill(n,t.max_nonzero_coeff,576,0),s=_,s<0&&(s=0),u=F+1}if(q==0&&i1==0&&(w1=v1,S1=R1,y1=B,j1=h1),i!=null&&i.sfb_count1>0&&u>=i.sfb_count1&&i.step[u]>0&&me>=i.step[u]?(q!=0&&(U(q,r,y1,j1,w1,S1),q=0,w1=v1,S1=R1,y1=B,j1=h1),i1+=s):(i1!=0&&(n1(i1,r,y1,j1,w1,S1),i1=0,w1=v1,S1=R1,y1=B,j1=h1),q+=s),s<=0){i1!=0&&(n1(i1,r,y1,j1,w1,S1),i1=0),q!=0&&(U(q,r,y1,j1,w1,S1),q=0);break}}u<=F&&(R1+=t.width[u],h1+=t.width[u],e1+=t.width[u])}q!=0&&(U(q,r,y1,j1,w1,S1),q=0),i1!=0&&(n1(i1,r,y1,j1,w1,S1),i1=0)}function W(B,n,r){var t=0,i=0;do{var u=B[n++],F=B[n++];t<u&&(t=u),i<F&&(i=F)}while(n<r);return t<i&&(t=i),t}function S(B,n,r,t,i,u){var F=Z.ht[t].xlen*65536+Z.ht[i].xlen,e1=0,y;do{var q=B[n++],i1=B[n++];q!=0&&(q>14&&(q=15,e1+=F),q*=16),i1!=0&&(i1>14&&(i1=15,e1+=F),q+=i1),e1+=Z.largetbl[q]}while(n<r);return y=e1&65535,e1>>=16,e1>y&&(e1=y,t=i),u.bits+=e1,t}function f(B,n,r,t){var i=0,u=Z.ht[1].hlen;do{var F=B[n+0]*2+B[n+1];n+=2,i+=u[F]}while(n<r);return t.bits+=i,1}function h(B,n,r,t,i){var u=0,F,e1=Z.ht[t].xlen,y;t==2?y=Z.table23:y=Z.table56;do{var q=B[n+0]*e1+B[n+1];n+=2,u+=y[q]}while(n<r);return F=u&65535,u>>=16,u>F&&(u=F,t++),i.bits+=u,t}function w(B,n,r,t,i){var u=0,F=0,e1=0,y=Z.ht[t].xlen,q=Z.ht[t].hlen,i1=Z.ht[t+1].hlen,h1=Z.ht[t+2].hlen;do{var v1=B[n+0]*y+B[n+1];n+=2,u+=q[v1],F+=i1[v1],e1+=h1[v1]}while(n<r);var R1=t;return u>F&&(u=F,R1++),u>e1&&(u=e1,R1=t+2),i.bits+=u,R1}var e=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function l(B,n,r,t){var i=W(B,n,r);switch(i){case 0:return i;case 1:return f(B,n,r,t);case 2:case 3:return h(B,n,r,e[i-1],t);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return w(B,n,r,e[i-1],t);default:if(i>$.IXMAX_VAL)return t.bits=$.LARGE_BITS,-1;i-=15;var u;for(u=24;u<32&&!(Z.ht[u].linmax>=i);u++);var F;for(F=u-8;F<24&&!(Z.ht[F].linmax>=i);F++);return S(B,n,r,F,u,t)}}this.noquant_count_bits=function(B,n,r){var t=n.l3_enc,i=Math.min(576,n.max_nonzero_coeff+2>>1<<1);for(r!=null&&(r.sfb_count1=0);i>1&&!(t[i-1]|t[i-2]);i-=2);n.count1=i;for(var u=0,F=0;i>3;i-=4){var e1;if(((t[i-1]|t[i-2]|t[i-3]|t[i-4])&2147483647)>1)break;e1=((t[i-4]*2+t[i-3])*2+t[i-2])*2+t[i-1],u+=Z.t32l[e1],F+=Z.t33l[e1]}var y=u;if(n.count1table_select=0,u>F&&(y=F,n.count1table_select=1),n.count1bits=y,n.big_values=i,i==0)return y;if(n.block_type==N.SHORT_TYPE)u=3*B.scalefac_band.s[3],u>n.big_values&&(u=n.big_values),F=n.big_values;else if(n.block_type==N.NORM_TYPE){if(u=n.region0_count=B.bv_scf[i-2],F=n.region1_count=B.bv_scf[i-1],K(u+F+2<N.SBPSY_l),F=B.scalefac_band.l[u+F+2],u=B.scalefac_band.l[u+1],F<i){var q=new m(y);n.table_select[2]=l(t,F,i,q),y=q.bits}}else n.region0_count=7,n.region1_count=N.SBMAX_l-1-7-1,u=B.scalefac_band.l[8],F=i,u>F&&(u=F);if(u=Math.min(u,i),F=Math.min(F,i),0<u){var q=new m(y);n.table_select[0]=l(t,0,u,q),y=q.bits}if(u<F){var q=new m(y);n.table_select[1]=l(t,u,F,q),y=q.bits}if(B.use_best_huffman==2&&(n.part2_3_length=y,best_huffman_divide(B,n),y=n.part2_3_length),r!=null&&n.block_type==N.NORM_TYPE){for(var i1=0;B.scalefac_band.l[i1]<n.big_values;)i1++;r.sfb_count1=i1}return y},this.count_bits=function(B,n,r,t){var i=r.l3_enc,u=$.IXMAX_VAL/g.IPOW20(r.global_gain);if(r.xrpow_max>u)return $.LARGE_BITS;if(r1(n,i,g.IPOW20(r.global_gain),r,t),B.substep_shaping&2)for(var F=0,e1=r.global_gain+r.scalefac_scale,y=.634521682242439/g.IPOW20(e1),q=0;q<r.sfbmax;q++){var i1=r.width[q];if(B.pseudohalf[q]==0)F+=i1;else{var h1;for(h1=F,F+=i1;h1<F;++h1)i[h1]=n[h1]>=y?i[h1]:0}}return this.noquant_count_bits(B,r,t)};function R(B,n,r,t,i,u,F){for(var e1=n.big_values,y=0;y<=22;y++)t[y]=$.LARGE_BITS;for(var y=0;y<16;y++){var q=B.scalefac_band.l[y+1];if(q>=e1)break;var i1=0,h1=new m(i1),v1=l(r,0,q,h1);i1=h1.bits;for(var R1=0;R1<8;R1++){var w1=B.scalefac_band.l[y+R1+2];if(w1>=e1)break;var S1=i1;h1=new m(S1);var y1=l(r,q,w1,h1);S1=h1.bits,t[y+R1]>S1&&(t[y+R1]=S1,i[y+R1]=y,u[y+R1]=v1,F[y+R1]=y1)}}}function P(B,n,r,t,i,u,F,e1){for(var y=n.big_values,q=2;q<N.SBMAX_l+1;q++){var i1=B.scalefac_band.l[q];if(i1>=y)break;var h1=i[q-2]+n.count1bits;if(r.part2_3_length<=h1)break;var v1=new m(h1),R1=l(t,i1,y,v1);h1=v1.bits,!(r.part2_3_length<=h1)&&(r.assign(n),r.part2_3_length=h1,r.region0_count=u[q-2],r.region1_count=q-2-u[q-2],r.table_select[0]=F[q-2],r.table_select[1]=e1[q-2],r.table_select[2]=R1)}}this.best_huffman_divide=function(B,n){var r=new Y,t=n.l3_enc,i=j(23),u=j(23),F=j(23),e1=j(23);if(!(n.block_type==N.SHORT_TYPE&&B.mode_gr==1)){r.assign(n),n.block_type==N.NORM_TYPE&&(R(B,n,t,i,u,F,e1),P(B,r,n,t,i,u,F,e1));var y=r.big_values;if(!(y==0||(t[y-2]|t[y-1])>1)&&(y=n.count1+2,!(y>576))){r.assign(n),r.count1=y;for(var q=0,i1=0;y>r.big_values;y-=4){var h1=((t[y-4]*2+t[y-3])*2+t[y-2])*2+t[y-1];q+=Z.t32l[h1],i1+=Z.t33l[h1]}if(r.big_values=y,r.count1table_select=0,q>i1&&(q=i1,r.count1table_select=1),r.count1bits=q,r.block_type==N.NORM_TYPE)P(B,r,n,t,i,u,F,e1);else{if(r.part2_3_length=q,q=B.scalefac_band.l[8],q>y&&(q=y),q>0){var v1=new m(r.part2_3_length);r.table_select[0]=l(t,0,q,v1),r.part2_3_length=v1.bits}if(y>q){var v1=new m(r.part2_3_length);r.table_select[1]=l(t,q,y,v1),r.part2_3_length=v1.bits}n.part2_3_length>r.part2_3_length&&n.assign(r)}}}};var O=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],k=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],x=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],_1=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];p1.slen1_tab=x,p1.slen2_tab=_1;function b(B,n){for(var r,t=n.tt[1][B],i=n.tt[0][B],u=0;u<Z.scfsi_band.length-1;u++){for(r=Z.scfsi_band[u];r<Z.scfsi_band[u+1]&&!(i.scalefac[r]!=t.scalefac[r]&&t.scalefac[r]>=0);r++);if(r==Z.scfsi_band[u+1]){for(r=Z.scfsi_band[u];r<Z.scfsi_band[u+1];r++)t.scalefac[r]=-1;n.scfsi[B][u]=1}}var F=0,e1=0;for(r=0;r<11;r++)t.scalefac[r]!=-1&&(e1++,F<t.scalefac[r]&&(F=t.scalefac[r]));for(var y=0,q=0;r<N.SBPSY_l;r++)t.scalefac[r]!=-1&&(q++,y<t.scalefac[r]&&(y=t.scalefac[r]));for(var u=0;u<16;u++)if(F<O[u]&&y<k[u]){var i1=x[u]*e1+_1[u]*q;t.part2_length>i1&&(t.part2_length=i1,t.scalefac_compress=u)}}this.best_scalefac_store=function(B,n,r,t){var i=t.tt[n][r],u,F,e1,y,q=0;for(e1=0,u=0;u<i.sfbmax;u++){var i1=i.width[u];for(e1+=i1,y=-i1;y<0&&i.l3_enc[y+e1]==0;y++);y==0&&(i.scalefac[u]=q=-2)}if(i.scalefac_scale==0&&i.preflag==0){var h1=0;for(u=0;u<i.sfbmax;u++)i.scalefac[u]>0&&(h1|=i.scalefac[u]);if(!(h1&1)&&h1!=0){for(u=0;u<i.sfbmax;u++)i.scalefac[u]>0&&(i.scalefac[u]>>=1);i.scalefac_scale=q=1}}if(i.preflag==0&&i.block_type!=N.SHORT_TYPE&&B.mode_gr==2){for(u=11;u<N.SBPSY_l&&!(i.scalefac[u]<g.pretab[u]&&i.scalefac[u]!=-2);u++);if(u==N.SBPSY_l){for(u=11;u<N.SBPSY_l;u++)i.scalefac[u]>0&&(i.scalefac[u]-=g.pretab[u]);i.preflag=q=1}}for(F=0;F<4;F++)t.scfsi[r][F]=0;for(B.mode_gr==2&&n==1&&t.tt[0][r].block_type!=N.SHORT_TYPE&&t.tt[1][r].block_type!=N.SHORT_TYPE&&(b(r,t),q=0),u=0;u<i.sfbmax;u++)i.scalefac[u]==-2&&(i.scalefac[u]=0);q!=0&&(B.mode_gr==2?this.scale_bitcount(i):this.scale_bitcount_lsf(B,i))};function a(B,n){for(var r=0;r<n;++r)if(B[r]<0)return!1;return!0}var v=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],V=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],L=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(B){var n,r,t=0,i=0,u,F=B.scalefac;if(K(a(F,B.sfbmax)),B.block_type==N.SHORT_TYPE)u=v,B.mixed_block_flag!=0&&(u=V);else if(u=L,B.preflag==0){for(r=11;r<N.SBPSY_l&&!(F[r]<g.pretab[r]);r++);if(r==N.SBPSY_l)for(B.preflag=1,r=11;r<N.SBPSY_l;r++)F[r]-=g.pretab[r]}for(r=0;r<B.sfbdivide;r++)t<F[r]&&(t=F[r]);for(;r<B.sfbmax;r++)i<F[r]&&(i=F[r]);for(B.part2_length=$.LARGE_BITS,n=0;n<16;n++)t<O[n]&&i<k[n]&&B.part2_length>u[n]&&(B.part2_length=u[n],B.scalefac_compress=n);return B.part2_length==$.LARGE_BITS};var I=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(B,n){var r,t,i,u,F,e1,y,q,i1=j(4),h1=n.scalefac;for(n.preflag!=0?r=2:r=0,y=0;y<4;y++)i1[y]=0;if(n.block_type==N.SHORT_TYPE){t=1;var v1=g.nr_of_sfb_block[r][t];for(q=0,i=0;i<4;i++)for(u=v1[i]/3,y=0;y<u;y++,q++)for(F=0;F<3;F++)h1[q*3+F]>i1[i]&&(i1[i]=h1[q*3+F])}else{t=0;var v1=g.nr_of_sfb_block[r][t];for(q=0,i=0;i<4;i++)for(u=v1[i],y=0;y<u;y++,q++)h1[q]>i1[i]&&(i1[i]=h1[q])}for(e1=!1,i=0;i<4;i++)i1[i]>I[r][i]&&(e1=!0);if(!e1){var R1,w1,S1,y1;for(n.sfb_partition_table=g.nr_of_sfb_block[r][t],i=0;i<4;i++)n.slen[i]=G[i1[i]];switch(R1=n.slen[0],w1=n.slen[1],S1=n.slen[2],y1=n.slen[3],r){case 0:n.scalefac_compress=(R1*5+w1<<4)+(S1<<2)+y1;break;case 1:n.scalefac_compress=400+(R1*5+w1<<2)+S1;break;case 2:n.scalefac_compress=500+R1*3+w1;break;default:T.err.printf(`intensity stereo not implemented yet
`);break}}if(!e1)for(K(n.sfb_partition_table!=null),n.part2_length=0,i=0;i<4;i++)n.part2_length+=n.slen[i]*n.sfb_partition_table[i];return e1};var G=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(B){for(var n=2;n<=576;n+=2){for(var r=0,t;B.scalefac_band.l[++r]<n;);for(t=D[r][0];B.scalefac_band.l[t+1]>n;)t--;for(t<0&&(t=D[r][0]),B.bv_scf[n-2]=t,t=D[r][1];B.scalefac_band.l[t+B.bv_scf[n-2]+2]>n;)t--;t<0&&(t=D[r][1]),B.bv_scf[n-1]=t}}}return Bt=p1,Bt}var At,ka;function kt(){if(ka)return At;ka=1;var p=z1,T=p.System,A=p.Arrays,j=p.new_byte,K=p.new_float_n,N=p.new_int,Z=p.assert,Y=Aa(),$=Mt,p1=ae(),g=it;m.EQ=function(D,n1){return Math.abs(D)>Math.abs(n1)?Math.abs(D-n1)<=Math.abs(D)*1e-6:Math.abs(D-n1)<=Math.abs(n1)*1e-6},m.NEQ=function(D,n1){return!m.EQ(D,n1)};function m(){var D=Et(),n1=this,U=32773,r1=null,W=null,S=null,f=null;this.setModules=function(n,r,t,i){r1=n,W=r,S=t,f=i};var h=null,w=0,e=0,l=0;this.getframebits=function(n){var r=n.internal_flags,t;r.bitrate_index!=0?t=$.bitrate_table[n.version][r.bitrate_index]:t=n.brate;var i=0|(n.version+1)*72e3*t/n.out_samplerate+r.padding;return 8*i};function R(n){T.arraycopy(n.header[n.w_ptr].buf,0,h,e,n.sideinfo_len),e+=n.sideinfo_len,w+=n.sideinfo_len*8,n.w_ptr=n.w_ptr+1&g.MAX_HEADER_BUF-1}function P(n,r,t){for(;t>0;){var i;l==0&&(l=8,e++,Z(e<D.LAME_MAXMP3BUFFER),Z(n.header[n.w_ptr].write_timing>=w),n.header[n.w_ptr].write_timing==w&&R(n),h[e]=0),i=Math.min(t,l),t-=i,l-=i,h[e]|=r>>t<<l,w+=i}}function O(n,r,t){for(;t>0;){var i;l==0&&(l=8,e++,Z(e<D.LAME_MAXMP3BUFFER),h[e]=0),i=Math.min(t,l),t-=i,l-=i,h[e]|=r>>t<<l,w+=i}}function k(n,r){var t=n.internal_flags,i;if(r>=8&&(P(t,76,8),r-=8),r>=8&&(P(t,65,8),r-=8),r>=8&&(P(t,77,8),r-=8),r>=8&&(P(t,69,8),r-=8),r>=32){var u=S.getLameShortVersion();if(r>=32)for(i=0;i<u.length&&r>=8;++i)r-=8,P(t,u.charAt(i),8)}for(;r>=1;r-=1)P(t,t.ancillary_flag,1),t.ancillary_flag^=n.disable_reservoir?0:1}function x(n,r,t){for(var i=n.header[n.h_ptr].ptr;t>0;){var u=Math.min(t,8-(i&7));t-=u,n.header[n.h_ptr].buf[i>>3]|=r>>t<<8-(i&7)-u,i+=u}n.header[n.h_ptr].ptr=i}function _1(n,r){n<<=8;for(var t=0;t<8;t++)n<<=1,r<<=1,(r^n)&65536&&(r^=U);return r}this.CRC_writeheader=function(n,r){var t=65535;t=_1(r[2]&255,t),t=_1(r[3]&255,t);for(var i=6;i<n.sideinfo_len;i++)t=_1(r[i]&255,t);r[4]=byte(t>>8),r[5]=byte(t&255)};function b(n,r){var t=n.internal_flags,i,u,F;if(i=t.l3_side,t.header[t.h_ptr].ptr=0,A.fill(t.header[t.h_ptr].buf,0,t.sideinfo_len,0),n.out_samplerate<16e3?x(t,4094,12):x(t,4095,12),x(t,n.version,1),x(t,1,2),x(t,n.error_protection?0:1,1),x(t,t.bitrate_index,4),x(t,t.samplerate_index,2),x(t,t.padding,1),x(t,n.extension,1),x(t,n.mode.ordinal(),2),x(t,t.mode_ext,2),x(t,n.copyright,1),x(t,n.original,1),x(t,n.emphasis,2),n.error_protection&&x(t,0,16),n.version==1){for(Z(i.main_data_begin>=0),x(t,i.main_data_begin,9),t.channels_out==2?x(t,i.private_bits,3):x(t,i.private_bits,5),F=0;F<t.channels_out;F++){var e1;for(e1=0;e1<4;e1++)x(t,i.scfsi[F][e1],1)}for(u=0;u<2;u++)for(F=0;F<t.channels_out;F++){var y=i.tt[u][F];x(t,y.part2_3_length+y.part2_length,12),x(t,y.big_values/2,9),x(t,y.global_gain,8),x(t,y.scalefac_compress,4),y.block_type!=p1.NORM_TYPE?(x(t,1,1),x(t,y.block_type,2),x(t,y.mixed_block_flag,1),y.table_select[0]==14&&(y.table_select[0]=16),x(t,y.table_select[0],5),y.table_select[1]==14&&(y.table_select[1]=16),x(t,y.table_select[1],5),x(t,y.subblock_gain[0],3),x(t,y.subblock_gain[1],3),x(t,y.subblock_gain[2],3)):(x(t,0,1),y.table_select[0]==14&&(y.table_select[0]=16),x(t,y.table_select[0],5),y.table_select[1]==14&&(y.table_select[1]=16),x(t,y.table_select[1],5),y.table_select[2]==14&&(y.table_select[2]=16),x(t,y.table_select[2],5),Z(0<=y.region0_count&&y.region0_count<16),Z(0<=y.region1_count&&y.region1_count<8),x(t,y.region0_count,4),x(t,y.region1_count,3)),x(t,y.preflag,1),x(t,y.scalefac_scale,1),x(t,y.count1table_select,1)}}else for(Z(i.main_data_begin>=0),x(t,i.main_data_begin,8),x(t,i.private_bits,t.channels_out),u=0,F=0;F<t.channels_out;F++){var y=i.tt[u][F];x(t,y.part2_3_length+y.part2_length,12),x(t,y.big_values/2,9),x(t,y.global_gain,8),x(t,y.scalefac_compress,9),y.block_type!=p1.NORM_TYPE?(x(t,1,1),x(t,y.block_type,2),x(t,y.mixed_block_flag,1),y.table_select[0]==14&&(y.table_select[0]=16),x(t,y.table_select[0],5),y.table_select[1]==14&&(y.table_select[1]=16),x(t,y.table_select[1],5),x(t,y.subblock_gain[0],3),x(t,y.subblock_gain[1],3),x(t,y.subblock_gain[2],3)):(x(t,0,1),y.table_select[0]==14&&(y.table_select[0]=16),x(t,y.table_select[0],5),y.table_select[1]==14&&(y.table_select[1]=16),x(t,y.table_select[1],5),y.table_select[2]==14&&(y.table_select[2]=16),x(t,y.table_select[2],5),Z(0<=y.region0_count&&y.region0_count<16),Z(0<=y.region1_count&&y.region1_count<8),x(t,y.region0_count,4),x(t,y.region1_count,3)),x(t,y.scalefac_scale,1),x(t,y.count1table_select,1)}n.error_protection&&CRC_writeheader(t,t.header[t.h_ptr].buf);{var q=t.h_ptr;Z(t.header[q].ptr==t.sideinfo_len*8),t.h_ptr=q+1&g.MAX_HEADER_BUF-1,t.header[t.h_ptr].write_timing=t.header[q].write_timing+r,t.h_ptr==t.w_ptr&&T.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function a(n,r){var t=$.ht[r.count1table_select+32],i,u=0,F=r.big_values,e1=r.big_values;for(Z(r.count1table_select<2),i=(r.count1-r.big_values)/4;i>0;--i){var y=0,q=0,i1;i1=r.l3_enc[F+0],i1!=0&&(q+=8,r.xr[e1+0]<0&&y++),i1=r.l3_enc[F+1],i1!=0&&(q+=4,y*=2,r.xr[e1+1]<0&&y++),i1=r.l3_enc[F+2],i1!=0&&(q+=2,y*=2,r.xr[e1+2]<0&&y++),i1=r.l3_enc[F+3],i1!=0&&(q++,y*=2,r.xr[e1+3]<0&&y++),F+=4,e1+=4,P(n,y+t.table[q],t.hlen[q]),u+=t.hlen[q]}return u}function v(n,r,t,i,u){var F=$.ht[r],e1=0;if(r==0)return e1;for(var y=t;y<i;y+=2){var q=0,i1=0,h1=F.xlen,v1=F.xlen,R1=0,w1=u.l3_enc[y],S1=u.l3_enc[y+1];if(w1!=0&&(u.xr[y]<0&&R1++,q--),r>15){if(w1>14){var y1=w1-15;Z(y1<=F.linmax),R1|=y1<<1,i1=h1,w1=15}if(S1>14){var j1=S1-15;Z(j1<=F.linmax),R1<<=h1,R1|=j1,i1+=h1,S1=15}v1=16}S1!=0&&(R1<<=1,u.xr[y+1]<0&&R1++,q--),w1=w1*v1+S1,i1-=q,q+=F.hlen[w1],P(n,F.table[w1],q),P(n,R1,i1),e1+=q+i1}return e1}function V(n,r){var t=3*n.scalefac_band.s[3];t>r.big_values&&(t=r.big_values);var i=v(n,r.table_select[0],0,t,r);return i+=v(n,r.table_select[1],t,r.big_values,r),i}function L(n,r){var t,i,u,F;t=r.big_values;var e1=r.region0_count+1;return Z(e1<n.scalefac_band.l.length),u=n.scalefac_band.l[e1],e1+=r.region1_count+1,Z(e1<n.scalefac_band.l.length),F=n.scalefac_band.l[e1],u>t&&(u=t),F>t&&(F=t),i=v(n,r.table_select[0],0,u,r),i+=v(n,r.table_select[1],u,F,r),i+=v(n,r.table_select[2],F,t,r),i}function I(n){var r,t,i,u,F=0,e1=n.internal_flags,y=e1.l3_side;if(n.version==1)for(r=0;r<2;r++)for(t=0;t<e1.channels_out;t++){var q=y.tt[r][t],i1=Y.slen1_tab[q.scalefac_compress],h1=Y.slen2_tab[q.scalefac_compress];for(u=0,i=0;i<q.sfbdivide;i++)q.scalefac[i]!=-1&&(P(e1,q.scalefac[i],i1),u+=i1);for(;i<q.sfbmax;i++)q.scalefac[i]!=-1&&(P(e1,q.scalefac[i],h1),u+=h1);Z(u==q.part2_length),q.block_type==p1.SHORT_TYPE?u+=V(e1,q):u+=L(e1,q),u+=a(e1,q),Z(u==q.part2_3_length+q.part2_length),F+=u}else for(r=0,t=0;t<e1.channels_out;t++){var q=y.tt[r][t],v1,R1,w1=0;if(Z(q.sfb_partition_table!=null),u=0,i=0,R1=0,q.block_type==p1.SHORT_TYPE){for(;R1<4;R1++){var S1=q.sfb_partition_table[R1]/3,y1=q.slen[R1];for(v1=0;v1<S1;v1++,i++)P(e1,Math.max(q.scalefac[i*3+0],0),y1),P(e1,Math.max(q.scalefac[i*3+1],0),y1),P(e1,Math.max(q.scalefac[i*3+2],0),y1),w1+=3*y1}u+=V(e1,q)}else{for(;R1<4;R1++){var S1=q.sfb_partition_table[R1],y1=q.slen[R1];for(v1=0;v1<S1;v1++,i++)P(e1,Math.max(q.scalefac[i],0),y1),w1+=y1}u+=L(e1,q)}u+=a(e1,q),Z(u==q.part2_3_length),Z(w1==q.part2_length),F+=w1+u}return F}function G(){this.total=0}function B(n,r){var t=n.internal_flags,i,u,F,e1,y;return y=t.w_ptr,e1=t.h_ptr-1,e1==-1&&(e1=g.MAX_HEADER_BUF-1),i=t.header[e1].write_timing-w,r.total=i,i>=0&&(u=1+e1-y,e1<y&&(u=1+e1-y+g.MAX_HEADER_BUF),i-=u*8*t.sideinfo_len),F=n1.getframebits(n),i+=F,r.total+=F,r.total%8!=0?r.total=1+r.total/8:r.total=r.total/8,r.total+=e+1,i<0&&T.err.println(`strange error flushing buffer ... 
`),i}this.flush_bitstream=function(n){var r=n.internal_flags,t,i,u=r.h_ptr-1;if(u==-1&&(u=g.MAX_HEADER_BUF-1),t=r.l3_side,!((i=B(n,new G))<0)){if(k(n,i),Z(r.header[u].write_timing+this.getframebits(n)==w),r.ResvSize=0,t.main_data_begin=0,r.findReplayGain){var F=r1.GetTitleGain(r.rgdata);Z(NEQ(F,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),r.RadioGain=Math.floor(F*10+.5)|0}r.findPeakSample&&(r.noclipGainChange=Math.ceil(Math.log10(r.PeakSample/32767)*20*10)|0,r.noclipGainChange>0&&(EQ(n.scale,1)||EQ(n.scale,0))?r.noclipScale=Math.floor(32767/r.PeakSample*100)/100:r.noclipScale=-1)}},this.add_dummy_byte=function(n,r,t){for(var i=n.internal_flags,u;t-- >0;)for(O(i,r,8),u=0;u<g.MAX_HEADER_BUF;++u)i.header[u].write_timing+=8},this.format_bitstream=function(n){var r=n.internal_flags,t;t=r.l3_side;var i=this.getframebits(n);k(n,t.resvDrain_pre),b(n,i);var u=8*r.sideinfo_len;if(u+=I(n),k(n,t.resvDrain_post),u+=t.resvDrain_post,t.main_data_begin+=(i-u)/8,B(n,new G)!=r.ResvSize&&T.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),t.main_data_begin*8!=r.ResvSize&&(T.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*t.main_data_begin,r.ResvSize,t.resvDrain_post,t.resvDrain_pre,8*r.sideinfo_len,u-t.resvDrain_post-8*r.sideinfo_len,u,u%8,i),T.err.println("This is a fatal error.  It has several possible causes:"),T.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),T.err.println(" 9%%  Your system is overclocked"),T.err.println(" 1%%  bug in LAME encoding library"),r.ResvSize=t.main_data_begin*8),w>1e9){var F;for(F=0;F<g.MAX_HEADER_BUF;++F)r.header[F].write_timing-=w;w=0}return 0},this.copy_buffer=function(n,r,t,i,u){var F=e+1;if(F<=0)return 0;if(i!=0&&F>i)return-1;if(T.arraycopy(h,0,r,t,F),e=-1,l=0,u!=0){var e1=N(1);if(e1[0]=n.nMusicCRC,f.updateMusicCRC(e1,r,t,F),n.nMusicCRC=e1[0],F>0&&(n.VBR_seek_table.nBytesWritten+=F),n.decode_on_the_fly){for(var y=K([2,1152]),q=F,i1=-1,h1;i1!=0;)if(i1=W.hip_decode1_unclipped(n.hip,r,t,q,y[0],y[1]),q=0,i1==-1&&(i1=0),i1>0){if(n.findPeakSample){for(h1=0;h1<i1;h1++)y[0][h1]>n.PeakSample?n.PeakSample=y[0][h1]:-y[0][h1]>n.PeakSample&&(n.PeakSample=-y[0][h1]);if(n.channels_out>1)for(h1=0;h1<i1;h1++)y[1][h1]>n.PeakSample?n.PeakSample=y[1][h1]:-y[1][h1]>n.PeakSample&&(n.PeakSample=-y[1][h1])}if(n.findReplayGain&&r1.AnalyzeSamples(n.rgdata,y[0],0,y[1],0,i1,n.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return F},this.init_bit_stream_w=function(n){h=j(D.LAME_MAXMP3BUFFER),n.h_ptr=n.w_ptr=0,n.header[n.h_ptr].write_timing=0,e=-1,l=0,w=0}}return At=m,At}var yt,ya;function Et(){if(ya)return yt;ya=1;var p=z1,T=p.System,A=p.VbrMode,j=p.ShortBlock,K=p.new_float,N=p.new_int_n,Z=p.new_short_n,Y=p.assert,$=Ms,p1=As,g=it,m=Us,D=Ks,n1=r0,U=kt(),r1=Mt,W=ae();function S(){var f=Ze,h=this,w=128*1024;S.V9=410,S.V8=420,S.V7=430,S.V6=440,S.V5=450,S.V4=460,S.V3=470,S.V2=480,S.V1=490,S.V0=500,S.R3MIX=1e3,S.STANDARD=1001,S.EXTREME=1002,S.INSANE=1003,S.STANDARD_FAST=1004,S.EXTREME_FAST=1005,S.MEDIUM=1006,S.MEDIUM_FAST=1007;var e=16384+w;S.LAME_MAXMP3BUFFER=e;var l,R,P,O,k,x=new $,_1,b,a;this.enc=new W,this.setModules=function(s,_,g1,B1,L1,T1,E1,k1,N1){l=s,R=_,P=g1,O=B1,k=L1,_1=T1,b=k1,a=N1,this.enc.setModules(R,x,O,_1)};function v(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=K(W.SBMAX_l),this.bo_s_weight=K(W.SBMAX_s)}function V(){this.lowerlimit=0}function L(s,_){this.lowpass=_}var I=4294479419;function G(s){var _;return s.class_id=I,_=s.internal_flags=new g,s.mode=f.NOT_SET,s.original=1,s.in_samplerate=44100,s.num_channels=2,s.num_samples=-1,s.bWriteVbrTag=!0,s.quality=-1,s.short_blocks=null,_.subblock_gain=-1,s.lowpassfreq=0,s.highpassfreq=0,s.lowpasswidth=-1,s.highpasswidth=-1,s.VBR=A.vbr_off,s.VBR_q=4,s.ATHcurve=-1,s.VBR_mean_bitrate_kbps=128,s.VBR_min_bitrate_kbps=0,s.VBR_max_bitrate_kbps=0,s.VBR_hard_min=0,_.VBR_min_bitrate=1,_.VBR_max_bitrate=13,s.quant_comp=-1,s.quant_comp_short=-1,s.msfix=-1,_.resample_ratio=1,_.OldValue[0]=180,_.OldValue[1]=180,_.CurrentStep[0]=4,_.CurrentStep[1]=4,_.masking_lower=1,_.nsPsy.attackthre=-1,_.nsPsy.attackthre_s=-1,s.scale=-1,s.athaa_type=-1,s.ATHtype=-1,s.athaa_loudapprox=-1,s.athaa_sensitivity=0,s.useTemporal=null,s.interChRatio=-1,_.mf_samples_to_encode=W.ENCDELAY+W.POSTDELAY,s.encoder_padding=0,_.mf_size=W.ENCDELAY-W.MDCTDELAY,s.findReplayGain=!1,s.decode_on_the_fly=!1,_.decode_on_the_fly=!1,_.findReplayGain=!1,_.findPeakSample=!1,_.RadioGain=0,_.AudiophileGain=0,_.noclipGainChange=0,_.noclipScale=-1,s.preset=0,s.write_id3tag_automatic=!0,0}this.lame_init=function(){var s=new p1;return G(s),s.lame_allocated_gfp=1,s};function B(s){return s>1?0:s<=0?1:Math.cos(Math.PI/2*s)}this.nearestBitrateFullIndex=function(s){var _=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],g1=0,B1=0,L1=0,T1=0;T1=_[16],L1=16,B1=_[16],g1=16;for(var E1=0;E1<16;E1++)if(Math.max(s,_[E1+1])!=s){T1=_[E1+1],L1=E1+1,B1=_[E1],g1=E1;break}return T1-s>s-B1?g1:L1};function n(s,_){var g1=44100;return _>=48e3?g1=48e3:_>=44100?g1=44100:_>=32e3?g1=32e3:_>=24e3?g1=24e3:_>=22050?g1=22050:_>=16e3?g1=16e3:_>=12e3?g1=12e3:_>=11025?g1=11025:_>=8e3&&(g1=8e3),s==-1?g1:(s<=15960&&(g1=44100),s<=15250&&(g1=32e3),s<=11220&&(g1=24e3),s<=9970&&(g1=22050),s<=7230&&(g1=16e3),s<=5420&&(g1=12e3),s<=4510&&(g1=11025),s<=3970&&(g1=8e3),_<g1?_>44100?48e3:_>32e3?44100:_>24e3?32e3:_>22050?24e3:_>16e3?22050:_>12e3?16e3:_>11025?12e3:_>8e3?11025:8e3:g1)}function r(s,_){switch(s){case 44100:return _.version=1,0;case 48e3:return _.version=1,1;case 32e3:return _.version=1,2;case 22050:return _.version=0,0;case 24e3:return _.version=0,1;case 16e3:return _.version=0,2;case 11025:return _.version=0,0;case 12e3:return _.version=0,1;case 8e3:return _.version=0,2;default:return _.version=0,-1}}function t(s,_,g1){g1<16e3&&(_=2);for(var B1=r1.bitrate_table[_][1],L1=2;L1<=14;L1++)r1.bitrate_table[_][L1]>0&&Math.abs(r1.bitrate_table[_][L1]-s)<Math.abs(B1-s)&&(B1=r1.bitrate_table[_][L1]);return B1}function i(s,_,g1){g1<16e3&&(_=2);for(var B1=0;B1<=14;B1++)if(r1.bitrate_table[_][B1]>0&&r1.bitrate_table[_][B1]==s)return B1;return-1}function u(s,_){var g1=[new L(8,2e3),new L(16,3700),new L(24,3900),new L(32,5500),new L(40,7e3),new L(48,7500),new L(56,1e4),new L(64,11e3),new L(80,13500),new L(96,15100),new L(112,15600),new L(128,17e3),new L(160,17500),new L(192,18600),new L(224,19400),new L(256,19700),new L(320,20500)],B1=h.nearestBitrateFullIndex(_);s.lowerlimit=g1[B1].lowpass}function F(s){var _=s.internal_flags,g1=32,B1=-1;if(_.lowpass1>0){for(var L1=999,T1=0;T1<=31;T1++){var E1=T1/31;E1>=_.lowpass2&&(g1=Math.min(g1,T1)),_.lowpass1<E1&&E1<_.lowpass2&&(L1=Math.min(L1,T1))}L1==999?_.lowpass1=(g1-.75)/31:_.lowpass1=(L1-.75)/31,_.lowpass2=g1/31}if(_.highpass2>0&&_.highpass2<.9*(.75/31)&&(_.highpass1=0,_.highpass2=0,T.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),_.highpass2>0){for(var k1=-1,T1=0;T1<=31;T1++){var E1=T1/31;E1<=_.highpass1&&(B1=Math.max(B1,T1)),_.highpass1<E1&&E1<_.highpass2&&(k1=Math.max(k1,T1))}_.highpass1=B1/31,k1==-1?_.highpass2=(B1+.75)/31:_.highpass2=(k1+.75)/31}for(var T1=0;T1<32;T1++){var N1,V1,E1=T1/31;_.highpass2>_.highpass1?N1=B((_.highpass2-E1)/(_.highpass2-_.highpass1+1e-20)):N1=1,_.lowpass2>_.lowpass1?V1=B((E1-_.lowpass1)/(_.lowpass2-_.lowpass1+1e-20)):V1=1,_.amp_filter[T1]=N1*V1}}function e1(s){var _=s.internal_flags;switch(s.quality){default:case 9:_.psymodel=0,_.noise_shaping=0,_.noise_shaping_amp=0,_.noise_shaping_stop=0,_.use_best_huffman=0,_.full_outer_loop=0;break;case 8:s.quality=7;case 7:_.psymodel=1,_.noise_shaping=0,_.noise_shaping_amp=0,_.noise_shaping_stop=0,_.use_best_huffman=0,_.full_outer_loop=0;break;case 6:_.psymodel=1,_.noise_shaping==0&&(_.noise_shaping=1),_.noise_shaping_amp=0,_.noise_shaping_stop=0,_.subblock_gain==-1&&(_.subblock_gain=1),_.use_best_huffman=0,_.full_outer_loop=0;break;case 5:_.psymodel=1,_.noise_shaping==0&&(_.noise_shaping=1),_.noise_shaping_amp=0,_.noise_shaping_stop=0,_.subblock_gain==-1&&(_.subblock_gain=1),_.use_best_huffman=0,_.full_outer_loop=0;break;case 4:_.psymodel=1,_.noise_shaping==0&&(_.noise_shaping=1),_.noise_shaping_amp=0,_.noise_shaping_stop=0,_.subblock_gain==-1&&(_.subblock_gain=1),_.use_best_huffman=1,_.full_outer_loop=0;break;case 3:_.psymodel=1,_.noise_shaping==0&&(_.noise_shaping=1),_.noise_shaping_amp=1,_.noise_shaping_stop=1,_.subblock_gain==-1&&(_.subblock_gain=1),_.use_best_huffman=1,_.full_outer_loop=0;break;case 2:_.psymodel=1,_.noise_shaping==0&&(_.noise_shaping=1),_.substep_shaping==0&&(_.substep_shaping=2),_.noise_shaping_amp=1,_.noise_shaping_stop=1,_.subblock_gain==-1&&(_.subblock_gain=1),_.use_best_huffman=1,_.full_outer_loop=0;break;case 1:_.psymodel=1,_.noise_shaping==0&&(_.noise_shaping=1),_.substep_shaping==0&&(_.substep_shaping=2),_.noise_shaping_amp=2,_.noise_shaping_stop=1,_.subblock_gain==-1&&(_.subblock_gain=1),_.use_best_huffman=1,_.full_outer_loop=0;break;case 0:_.psymodel=1,_.noise_shaping==0&&(_.noise_shaping=1),_.substep_shaping==0&&(_.substep_shaping=2),_.noise_shaping_amp=2,_.noise_shaping_stop=1,_.subblock_gain==-1&&(_.subblock_gain=1),_.use_best_huffman=1,_.full_outer_loop=0;break}}function y(s){var _=s.internal_flags;s.frameNum=0,s.write_id3tag_automatic&&b.id3tag_write_v2(s),_.bitrate_stereoMode_Hist=N([16,5]),_.bitrate_blockType_Hist=N([16,6]),_.PeakSample=0,s.bWriteVbrTag&&_1.InitVbrTag(s)}this.lame_init_params=function(s){var _=s.internal_flags;if(_.Class_ID=0,_.ATH==null&&(_.ATH=new m),_.PSY==null&&(_.PSY=new v),_.rgdata==null&&(_.rgdata=new D),_.channels_in=s.num_channels,_.channels_in==1&&(s.mode=f.MONO),_.channels_out=s.mode==f.MONO?1:2,_.mode_ext=W.MPG_MD_MS_LR,s.mode==f.MONO&&(s.force_ms=!1),s.VBR==A.vbr_off&&s.VBR_mean_bitrate_kbps!=128&&s.brate==0&&(s.brate=s.VBR_mean_bitrate_kbps),s.VBR==A.vbr_off||s.VBR==A.vbr_mtrh||s.VBR==A.vbr_mt||(s.free_format=!1),s.VBR==A.vbr_off&&s.brate==0&&U.EQ(s.compression_ratio,0)&&(s.compression_ratio=11.025),s.VBR==A.vbr_off&&s.compression_ratio>0&&(s.out_samplerate==0&&(s.out_samplerate=map2MP3Frequency(int(.97*s.in_samplerate))),s.brate=0|s.out_samplerate*16*_.channels_out/(1e3*s.compression_ratio),_.samplerate_index=r(s.out_samplerate,s),s.free_format||(s.brate=t(s.brate,s.version,s.out_samplerate))),s.out_samplerate!=0&&(s.out_samplerate<16e3?(s.VBR_mean_bitrate_kbps=Math.max(s.VBR_mean_bitrate_kbps,8),s.VBR_mean_bitrate_kbps=Math.min(s.VBR_mean_bitrate_kbps,64)):s.out_samplerate<32e3?(s.VBR_mean_bitrate_kbps=Math.max(s.VBR_mean_bitrate_kbps,8),s.VBR_mean_bitrate_kbps=Math.min(s.VBR_mean_bitrate_kbps,160)):(s.VBR_mean_bitrate_kbps=Math.max(s.VBR_mean_bitrate_kbps,32),s.VBR_mean_bitrate_kbps=Math.min(s.VBR_mean_bitrate_kbps,320))),s.lowpassfreq==0){var g1=16e3;switch(s.VBR){case A.vbr_off:{var B1=new V;u(B1,s.brate),g1=B1.lowerlimit;break}case A.vbr_abr:{var B1=new V;u(B1,s.VBR_mean_bitrate_kbps),g1=B1.lowerlimit;break}case A.vbr_rh:{var L1=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=s.VBR_q&&s.VBR_q<=9){var T1=L1[s.VBR_q],E1=L1[s.VBR_q+1],k1=s.VBR_q_frac;g1=linear_int(T1,E1,k1)}else g1=19500;break}default:{var L1=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=s.VBR_q&&s.VBR_q<=9){var T1=L1[s.VBR_q],E1=L1[s.VBR_q+1],k1=s.VBR_q_frac;g1=linear_int(T1,E1,k1)}else g1=19500}}s.mode==f.MONO&&(s.VBR==A.vbr_off||s.VBR==A.vbr_abr)&&(g1*=1.5),s.lowpassfreq=g1|0}if(s.out_samplerate==0&&(2*s.lowpassfreq>s.in_samplerate&&(s.lowpassfreq=s.in_samplerate/2),s.out_samplerate=n(s.lowpassfreq|0,s.in_samplerate)),s.lowpassfreq=Math.min(20500,s.lowpassfreq),s.lowpassfreq=Math.min(s.out_samplerate/2,s.lowpassfreq),s.VBR==A.vbr_off&&(s.compression_ratio=s.out_samplerate*16*_.channels_out/(1e3*s.brate)),s.VBR==A.vbr_abr&&(s.compression_ratio=s.out_samplerate*16*_.channels_out/(1e3*s.VBR_mean_bitrate_kbps)),s.bWriteVbrTag||(s.findReplayGain=!1,s.decode_on_the_fly=!1,_.findPeakSample=!1),_.findReplayGain=s.findReplayGain,_.decode_on_the_fly=s.decode_on_the_fly,_.decode_on_the_fly&&(_.findPeakSample=!0),_.findReplayGain&&l.InitGainAnalysis(_.rgdata,s.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return s.internal_flags=null,-6;switch(_.decode_on_the_fly&&!s.decode_only&&(_.hip!=null&&a.hip_decode_exit(_.hip),_.hip=a.hip_decode_init()),_.mode_gr=s.out_samplerate<=24e3?1:2,s.framesize=576*_.mode_gr,s.encoder_delay=W.ENCDELAY,_.resample_ratio=s.in_samplerate/s.out_samplerate,s.VBR){case A.vbr_mt:case A.vbr_rh:case A.vbr_mtrh:{var N1=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];s.compression_ratio=N1[s.VBR_q]}break;case A.vbr_abr:s.compression_ratio=s.out_samplerate*16*_.channels_out/(1e3*s.VBR_mean_bitrate_kbps);break;default:s.compression_ratio=s.out_samplerate*16*_.channels_out/(1e3*s.brate);break}if(s.mode==f.NOT_SET&&(s.mode=f.JOINT_STEREO),s.highpassfreq>0?(_.highpass1=2*s.highpassfreq,s.highpasswidth>=0?_.highpass2=2*(s.highpassfreq+s.highpasswidth):_.highpass2=1*2*s.highpassfreq,_.highpass1/=s.out_samplerate,_.highpass2/=s.out_samplerate):(_.highpass1=0,_.highpass2=0),s.lowpassfreq>0?(_.lowpass2=2*s.lowpassfreq,s.lowpasswidth>=0?(_.lowpass1=2*(s.lowpassfreq-s.lowpasswidth),_.lowpass1<0&&(_.lowpass1=0)):_.lowpass1=1*2*s.lowpassfreq,_.lowpass1/=s.out_samplerate,_.lowpass2/=s.out_samplerate):(_.lowpass1=0,_.lowpass2=0),F(s),_.samplerate_index=r(s.out_samplerate,s),_.samplerate_index<0)return s.internal_flags=null,-1;if(s.VBR==A.vbr_off){if(s.free_format)_.bitrate_index=0;else if(s.brate=t(s.brate,s.version,s.out_samplerate),_.bitrate_index=i(s.brate,s.version,s.out_samplerate),_.bitrate_index<=0)return s.internal_flags=null,-1}else _.bitrate_index=1;s.analysis&&(s.bWriteVbrTag=!1),_.pinfo!=null&&(s.bWriteVbrTag=!1),R.init_bit_stream_w(_);for(var V1=_.samplerate_index+3*s.version+6*(s.out_samplerate<16e3?1:0),b1=0;b1<W.SBMAX_l+1;b1++)_.scalefac_band.l[b1]=O.sfBandIndex[V1].l[b1];for(var b1=0;b1<W.PSFB21+1;b1++){var F1=(_.scalefac_band.l[22]-_.scalefac_band.l[21])/W.PSFB21,U1=_.scalefac_band.l[21]+b1*F1;_.scalefac_band.psfb21[b1]=U1}_.scalefac_band.psfb21[W.PSFB21]=576;for(var b1=0;b1<W.SBMAX_s+1;b1++)_.scalefac_band.s[b1]=O.sfBandIndex[V1].s[b1];for(var b1=0;b1<W.PSFB12+1;b1++){var F1=(_.scalefac_band.s[13]-_.scalefac_band.s[12])/W.PSFB12,U1=_.scalefac_band.s[12]+b1*F1;_.scalefac_band.psfb12[b1]=U1}_.scalefac_band.psfb12[W.PSFB12]=192,s.version==1?_.sideinfo_len=_.channels_out==1?21:36:_.sideinfo_len=_.channels_out==1?13:21,s.error_protection&&(_.sideinfo_len+=2),y(s),_.Class_ID=I;{var o;for(o=0;o<19;o++)_.nsPsy.pefirbuf[o]=700*_.mode_gr*_.channels_out;s.ATHtype==-1&&(s.ATHtype=4)}switch(Y(s.VBR_q<=9),Y(s.VBR_q>=0),s.VBR){case A.vbr_mt:s.VBR=A.vbr_mtrh;case A.vbr_mtrh:{s.useTemporal==null&&(s.useTemporal=!1),P.apply_preset(s,500-s.VBR_q*10,0),s.quality<0&&(s.quality=LAME_DEFAULT_QUALITY),s.quality<5&&(s.quality=0),s.quality>5&&(s.quality=5),_.PSY.mask_adjust=s.maskingadjust,_.PSY.mask_adjust_short=s.maskingadjust_short,s.experimentalY?_.sfb21_extra=!1:_.sfb21_extra=s.out_samplerate>44e3,_.iteration_loop=new VBRNewIterationLoop(k);break}case A.vbr_rh:{P.apply_preset(s,500-s.VBR_q*10,0),_.PSY.mask_adjust=s.maskingadjust,_.PSY.mask_adjust_short=s.maskingadjust_short,s.experimentalY?_.sfb21_extra=!1:_.sfb21_extra=s.out_samplerate>44e3,s.quality>6&&(s.quality=6),s.quality<0&&(s.quality=LAME_DEFAULT_QUALITY),_.iteration_loop=new VBROldIterationLoop(k);break}default:{var c;_.sfb21_extra=!1,s.quality<0&&(s.quality=LAME_DEFAULT_QUALITY),c=s.VBR,c==A.vbr_off&&(s.VBR_mean_bitrate_kbps=s.brate),P.apply_preset(s,s.VBR_mean_bitrate_kbps,0),s.VBR=c,_.PSY.mask_adjust=s.maskingadjust,_.PSY.mask_adjust_short=s.maskingadjust_short,c==A.vbr_off?_.iteration_loop=new n1(k):_.iteration_loop=new ABRIterationLoop(k);break}}if(Y(s.scale>=0),s.VBR!=A.vbr_off){if(_.VBR_min_bitrate=1,_.VBR_max_bitrate=14,s.out_samplerate<16e3&&(_.VBR_max_bitrate=8),s.VBR_min_bitrate_kbps!=0&&(s.VBR_min_bitrate_kbps=t(s.VBR_min_bitrate_kbps,s.version,s.out_samplerate),_.VBR_min_bitrate=i(s.VBR_min_bitrate_kbps,s.version,s.out_samplerate),_.VBR_min_bitrate<0)||s.VBR_max_bitrate_kbps!=0&&(s.VBR_max_bitrate_kbps=t(s.VBR_max_bitrate_kbps,s.version,s.out_samplerate),_.VBR_max_bitrate=i(s.VBR_max_bitrate_kbps,s.version,s.out_samplerate),_.VBR_max_bitrate<0))return-1;s.VBR_min_bitrate_kbps=r1.bitrate_table[s.version][_.VBR_min_bitrate],s.VBR_max_bitrate_kbps=r1.bitrate_table[s.version][_.VBR_max_bitrate],s.VBR_mean_bitrate_kbps=Math.min(r1.bitrate_table[s.version][_.VBR_max_bitrate],s.VBR_mean_bitrate_kbps),s.VBR_mean_bitrate_kbps=Math.max(r1.bitrate_table[s.version][_.VBR_min_bitrate],s.VBR_mean_bitrate_kbps)}return s.tune&&(_.PSY.mask_adjust+=s.tune_value_a,_.PSY.mask_adjust_short+=s.tune_value_a),e1(s),Y(s.scale>=0),s.athaa_type<0?_.ATH.useAdjust=3:_.ATH.useAdjust=s.athaa_type,_.ATH.aaSensitivityP=Math.pow(10,s.athaa_sensitivity/-10),s.short_blocks==null&&(s.short_blocks=j.short_block_allowed),s.short_blocks==j.short_block_allowed&&(s.mode==f.JOINT_STEREO||s.mode==f.STEREO)&&(s.short_blocks=j.short_block_coupled),s.quant_comp<0&&(s.quant_comp=1),s.quant_comp_short<0&&(s.quant_comp_short=0),s.msfix<0&&(s.msfix=0),s.exp_nspsytune=s.exp_nspsytune|1,s.internal_flags.nsPsy.attackthre<0&&(s.internal_flags.nsPsy.attackthre=$.NSATTACKTHRE),s.internal_flags.nsPsy.attackthre_s<0&&(s.internal_flags.nsPsy.attackthre_s=$.NSATTACKTHRE_S),Y(s.scale>=0),s.scale<0&&(s.scale=1),s.ATHtype<0&&(s.ATHtype=4),s.ATHcurve<0&&(s.ATHcurve=4),s.athaa_loudapprox<0&&(s.athaa_loudapprox=2),s.interChRatio<0&&(s.interChRatio=0),s.useTemporal==null&&(s.useTemporal=!0),_.slot_lag=_.frac_SpF=0,s.VBR==A.vbr_off&&(_.slot_lag=_.frac_SpF=(s.version+1)*72e3*s.brate%s.out_samplerate|0),O.iteration_init(s),x.psymodel_init(s),Y(s.scale>=0),0};function q(s,_){(s.in_buffer_0==null||s.in_buffer_nsamples<_)&&(s.in_buffer_0=K(_),s.in_buffer_1=K(_),s.in_buffer_nsamples=_)}this.lame_encode_flush=function(s,_,g1,B1){var L1=s.internal_flags,T1=Z([2,1152]),E1=0,k1,N1,V1,b1,F1=L1.mf_samples_to_encode-W.POSTDELAY,U1=i1(s);if(L1.mf_samples_to_encode<1)return 0;for(k1=0,s.in_samplerate!=s.out_samplerate&&(F1+=16*s.out_samplerate/s.in_samplerate),V1=s.framesize-F1%s.framesize,V1<576&&(V1+=s.framesize),s.encoder_padding=V1,b1=(F1+V1)/s.framesize;b1>0&&E1>=0;){var o=U1-L1.mf_size,c=s.frameNum;o*=s.in_samplerate,o/=s.out_samplerate,o>1152&&(o=1152),o<1&&(o=1),N1=B1-k1,B1==0&&(N1=0),E1=this.lame_encode_buffer(s,T1[0],T1[1],o,_,g1,N1),g1+=E1,k1+=E1,b1-=c!=s.frameNum?1:0}if(L1.mf_samples_to_encode=0,E1<0||(N1=B1-k1,B1==0&&(N1=0),R.flush_bitstream(s),E1=R.copy_buffer(L1,_,g1,N1,1),E1<0))return E1;if(g1+=E1,k1+=E1,N1=B1-k1,B1==0&&(N1=0),s.write_id3tag_automatic){if(b.id3tag_write_v1(s),E1=R.copy_buffer(L1,_,g1,N1,0),E1<0)return E1;k1+=E1}return k1},this.lame_encode_buffer=function(s,_,g1,B1,L1,T1,E1){var k1=s.internal_flags,N1=[null,null];if(k1.Class_ID!=I)return-3;if(B1==0)return 0;q(k1,B1),N1[0]=k1.in_buffer_0,N1[1]=k1.in_buffer_1;for(var V1=0;V1<B1;V1++)N1[0][V1]=_[V1],k1.channels_in>1&&(N1[1][V1]=g1[V1]);return h1(s,N1[0],N1[1],B1,L1,T1,E1)};function i1(s){var _=W.BLKSIZE+s.framesize-W.FFTOFFSET;return _=Math.max(_,512+s.framesize-32),_}function h1(s,_,g1,B1,L1,T1,E1){var k1=s.internal_flags,N1=0,V1,b1,F1,U1,o,c=[null,null],M=[null,null];if(k1.Class_ID!=I)return-3;if(B1==0)return 0;if(o=R.copy_buffer(k1,L1,T1,E1,0),o<0)return o;if(T1+=o,N1+=o,M[0]=_,M[1]=g1,U.NEQ(s.scale,0)&&U.NEQ(s.scale,1))for(b1=0;b1<B1;++b1)M[0][b1]*=s.scale,k1.channels_out==2&&(M[1][b1]*=s.scale);if(U.NEQ(s.scale_left,0)&&U.NEQ(s.scale_left,1))for(b1=0;b1<B1;++b1)M[0][b1]*=s.scale_left;if(U.NEQ(s.scale_right,0)&&U.NEQ(s.scale_right,1))for(b1=0;b1<B1;++b1)M[1][b1]*=s.scale_right;if(s.num_channels==2&&k1.channels_out==1)for(b1=0;b1<B1;++b1)M[0][b1]=.5*(M[0][b1]+M[1][b1]),M[1][b1]=0;U1=i1(s),c[0]=k1.mfbuf[0],c[1]=k1.mfbuf[1];for(var E=0;B1>0;){var H=[null,null],d=0,C=0;H[0]=M[0],H[1]=M[1];var z=new R1;if(me(s,c,H,E,B1,z),d=z.n_in,C=z.n_out,k1.findReplayGain&&!k1.decode_on_the_fly&&l.AnalyzeSamples(k1.rgdata,c[0],k1.mf_size,c[1],k1.mf_size,C,k1.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(B1-=d,E+=d,k1.channels_out==2,k1.mf_size+=C,Y(k1.mf_size<=g.MFSIZE),k1.mf_samples_to_encode<1&&(k1.mf_samples_to_encode=W.ENCDELAY+W.POSTDELAY),k1.mf_samples_to_encode+=C,k1.mf_size>=U1){var X=E1-N1;if(E1==0&&(X=0),V1=v1(s,c[0],c[1],L1,T1,X),V1<0)return V1;for(T1+=V1,N1+=V1,k1.mf_size-=s.framesize,k1.mf_samples_to_encode-=s.framesize,F1=0;F1<k1.channels_out;F1++)for(b1=0;b1<k1.mf_size;b1++)c[F1][b1]=c[F1][b1+s.framesize]}}return N1}function v1(s,_,g1,B1,L1,T1){var E1=h.enc.lame_encode_mp3_frame(s,_,g1,B1,L1,T1);return s.frameNum++,E1}function R1(){this.n_in=0,this.n_out=0}function w1(){this.num_used=0}function S1(s,_){return _!=0?S1(_,s%_):s}function y1(s,_,g1){var B1=Math.PI*_;s/=g1,s<0&&(s=0),s>1&&(s=1);var L1=s-.5,T1=.42-.5*Math.cos(2*s*Math.PI)+.08*Math.cos(4*s*Math.PI);return Math.abs(L1)<1e-9?B1/Math.PI:T1*Math.sin(g1*B1*L1)/(Math.PI*g1*L1)}function j1(s,_,g1,B1,L1,T1,E1,k1,N1){var V1=s.internal_flags,b1,F1=0,U1,o=s.out_samplerate/S1(s.out_samplerate,s.in_samplerate);o>g.BPC&&(o=g.BPC);var c=Math.abs(V1.resample_ratio-Math.floor(.5+V1.resample_ratio))<1e-4?1:0,M=1/V1.resample_ratio;M>1&&(M=1);var E=31;E%2==0&&--E,E+=c;var H=E+1;if(V1.fill_buffer_resample_init==0){for(V1.inbuf_old[0]=K(H),V1.inbuf_old[1]=K(H),b1=0;b1<=2*o;++b1)V1.blackfilt[b1]=K(H);for(V1.itime[0]=0,V1.itime[1]=0,F1=0;F1<=2*o;F1++){var d=0,C=(F1-o)/(2*o);for(b1=0;b1<=E;b1++)d+=V1.blackfilt[F1][b1]=y1(b1-C,M,E);for(b1=0;b1<=E;b1++)V1.blackfilt[F1][b1]/=d}V1.fill_buffer_resample_init=1}var z=V1.inbuf_old[N1];for(U1=0;U1<B1;U1++){var X,a1;if(X=U1*V1.resample_ratio,F1=0|Math.floor(X-V1.itime[N1]),E+F1-E/2>=E1)break;var C=X-V1.itime[N1]-(F1+.5*(E%2));a1=0|Math.floor(C*2*o+o+.5);var Q=0;for(b1=0;b1<=E;++b1){var t1=0|b1+F1-E/2,m1;m1=t1<0?z[H+t1]:L1[T1+t1],Q+=m1*V1.blackfilt[a1][b1]}_[g1+U1]=Q}if(k1.num_used=Math.min(E1,E+F1-E/2),V1.itime[N1]+=k1.num_used-U1*V1.resample_ratio,k1.num_used>=H)for(b1=0;b1<H;b1++)z[b1]=L1[T1+k1.num_used+b1-H];else{var P1=H-k1.num_used;for(b1=0;b1<P1;++b1)z[b1]=z[b1+k1.num_used];for(F1=0;b1<H;++b1,++F1)z[b1]=L1[T1+F1];Y(F1==k1.num_used)}return U1}function me(s,_,g1,B1,L1,T1){var E1=s.internal_flags;if(E1.resample_ratio<.9999||E1.resample_ratio>1.0001)for(var k1=0;k1<E1.channels_out;k1++){var N1=new w1;T1.n_out=j1(s,_[k1],E1.mf_size,s.framesize,g1[k1],B1,L1,N1,k1),T1.n_in=N1.num_used}else{T1.n_out=Math.min(s.framesize,L1),T1.n_in=T1.n_out;for(var V1=0;V1<T1.n_out;++V1)_[0][E1.mf_size+V1]=g1[0][B1+V1],E1.channels_out==2&&(_[1][E1.mf_size+V1]=g1[1][B1+V1])}}}return yt=S,yt}var n0=z1,Se=n0.VbrMode;function i0(){var p=Et();function T(g,m,D,n1,U,r1,W,S,f,h,w,e,l,R,P){this.vbr_q=g,this.quant_comp=m,this.quant_comp_s=D,this.expY=n1,this.st_lrm=U,this.st_s=r1,this.masking_adj=W,this.masking_adj_short=S,this.ath_lower=f,this.ath_curve=h,this.ath_sensitivity=w,this.interch=e,this.safejoint=l,this.sfb21mod=R,this.msfix=P}function A(g,m,D,n1,U,r1,W,S,f,h,w,e,l,R){this.quant_comp=m,this.quant_comp_s=D,this.safejoint=n1,this.nsmsfix=U,this.st_lrm=r1,this.st_s=W,this.nsbass=S,this.scale=f,this.masking_adj=h,this.ath_lower=w,this.ath_curve=e,this.interch=l,this.sfscale=R}var j;this.setModules=function(g){j=g};var K=[new T(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new T(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new T(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new T(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new T(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new T(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new T(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new T(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new T(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new T(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new T(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],N=[new T(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new T(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new T(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new T(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new T(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new T(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new T(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new T(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new T(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new T(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new T(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function Z(g,m,D){var n1=g.VBR==Se.vbr_rh?K:N,U=g.VBR_q_frac,r1=n1[m],W=n1[m+1],S=r1;r1.st_lrm=r1.st_lrm+U*(W.st_lrm-r1.st_lrm),r1.st_s=r1.st_s+U*(W.st_s-r1.st_s),r1.masking_adj=r1.masking_adj+U*(W.masking_adj-r1.masking_adj),r1.masking_adj_short=r1.masking_adj_short+U*(W.masking_adj_short-r1.masking_adj_short),r1.ath_lower=r1.ath_lower+U*(W.ath_lower-r1.ath_lower),r1.ath_curve=r1.ath_curve+U*(W.ath_curve-r1.ath_curve),r1.ath_sensitivity=r1.ath_sensitivity+U*(W.ath_sensitivity-r1.ath_sensitivity),r1.interch=r1.interch+U*(W.interch-r1.interch),r1.msfix=r1.msfix+U*(W.msfix-r1.msfix),p1(g,S.vbr_q),D!=0?g.quant_comp=S.quant_comp:Math.abs(g.quant_comp- -1)>0||(g.quant_comp=S.quant_comp),D!=0?g.quant_comp_short=S.quant_comp_s:Math.abs(g.quant_comp_short- -1)>0||(g.quant_comp_short=S.quant_comp_s),S.expY!=0&&(g.experimentalY=S.expY!=0),D!=0?g.internal_flags.nsPsy.attackthre=S.st_lrm:Math.abs(g.internal_flags.nsPsy.attackthre- -1)>0||(g.internal_flags.nsPsy.attackthre=S.st_lrm),D!=0?g.internal_flags.nsPsy.attackthre_s=S.st_s:Math.abs(g.internal_flags.nsPsy.attackthre_s- -1)>0||(g.internal_flags.nsPsy.attackthre_s=S.st_s),D!=0?g.maskingadjust=S.masking_adj:Math.abs(g.maskingadjust-0)>0||(g.maskingadjust=S.masking_adj),D!=0?g.maskingadjust_short=S.masking_adj_short:Math.abs(g.maskingadjust_short-0)>0||(g.maskingadjust_short=S.masking_adj_short),D!=0?g.ATHlower=-S.ath_lower/10:Math.abs(-g.ATHlower*10-0)>0||(g.ATHlower=-S.ath_lower/10),D!=0?g.ATHcurve=S.ath_curve:Math.abs(g.ATHcurve- -1)>0||(g.ATHcurve=S.ath_curve),D!=0?g.athaa_sensitivity=S.ath_sensitivity:Math.abs(g.athaa_sensitivity- -1)>0||(g.athaa_sensitivity=S.ath_sensitivity),S.interch>0&&(D!=0?g.interChRatio=S.interch:Math.abs(g.interChRatio- -1)>0||(g.interChRatio=S.interch)),S.safejoint>0&&(g.exp_nspsytune=g.exp_nspsytune|S.safejoint),S.sfb21mod>0&&(g.exp_nspsytune=g.exp_nspsytune|S.sfb21mod<<20),D!=0?g.msfix=S.msfix:Math.abs(g.msfix- -1)>0||(g.msfix=S.msfix),D==0&&(g.VBR_q=m,g.VBR_q_frac=U)}var Y=[new A(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new A(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new A(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new A(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new A(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new A(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new A(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new A(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new A(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new A(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new A(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new A(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new A(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new A(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new A(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new A(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new A(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function $(g,m,D){var n1=m,U=j.nearestBitrateFullIndex(m);if(g.VBR=Se.vbr_abr,g.VBR_mean_bitrate_kbps=n1,g.VBR_mean_bitrate_kbps=Math.min(g.VBR_mean_bitrate_kbps,320),g.VBR_mean_bitrate_kbps=Math.max(g.VBR_mean_bitrate_kbps,8),g.brate=g.VBR_mean_bitrate_kbps,g.VBR_mean_bitrate_kbps>320&&(g.disable_reservoir=!0),Y[U].safejoint>0&&(g.exp_nspsytune=g.exp_nspsytune|2),Y[U].sfscale>0&&(g.internal_flags.noise_shaping=2),Math.abs(Y[U].nsbass)>0){var r1=int(Y[U].nsbass*4);r1<0&&(r1+=64),g.exp_nspsytune=g.exp_nspsytune|r1<<2}return D!=0?g.quant_comp=Y[U].quant_comp:Math.abs(g.quant_comp- -1)>0||(g.quant_comp=Y[U].quant_comp),D!=0?g.quant_comp_short=Y[U].quant_comp_s:Math.abs(g.quant_comp_short- -1)>0||(g.quant_comp_short=Y[U].quant_comp_s),D!=0?g.msfix=Y[U].nsmsfix:Math.abs(g.msfix- -1)>0||(g.msfix=Y[U].nsmsfix),D!=0?g.internal_flags.nsPsy.attackthre=Y[U].st_lrm:Math.abs(g.internal_flags.nsPsy.attackthre- -1)>0||(g.internal_flags.nsPsy.attackthre=Y[U].st_lrm),D!=0?g.internal_flags.nsPsy.attackthre_s=Y[U].st_s:Math.abs(g.internal_flags.nsPsy.attackthre_s- -1)>0||(g.internal_flags.nsPsy.attackthre_s=Y[U].st_s),D!=0?g.scale=Y[U].scale:Math.abs(g.scale- -1)>0||(g.scale=Y[U].scale),D!=0?g.maskingadjust=Y[U].masking_adj:Math.abs(g.maskingadjust-0)>0||(g.maskingadjust=Y[U].masking_adj),Y[U].masking_adj>0?D!=0?g.maskingadjust_short=Y[U].masking_adj*.9:Math.abs(g.maskingadjust_short-0)>0||(g.maskingadjust_short=Y[U].masking_adj*.9):D!=0?g.maskingadjust_short=Y[U].masking_adj*1.1:Math.abs(g.maskingadjust_short-0)>0||(g.maskingadjust_short=Y[U].masking_adj*1.1),D!=0?g.ATHlower=-Y[U].ath_lower/10:Math.abs(-g.ATHlower*10-0)>0||(g.ATHlower=-Y[U].ath_lower/10),D!=0?g.ATHcurve=Y[U].ath_curve:Math.abs(g.ATHcurve- -1)>0||(g.ATHcurve=Y[U].ath_curve),D!=0?g.interChRatio=Y[U].interch:Math.abs(g.interChRatio- -1)>0||(g.interChRatio=Y[U].interch),m}this.apply_preset=function(g,m,D){switch(m){case p.R3MIX:{m=p.V3,g.VBR=Se.vbr_mtrh;break}case p.MEDIUM:{m=p.V4,g.VBR=Se.vbr_rh;break}case p.MEDIUM_FAST:{m=p.V4,g.VBR=Se.vbr_mtrh;break}case p.STANDARD:{m=p.V2,g.VBR=Se.vbr_rh;break}case p.STANDARD_FAST:{m=p.V2,g.VBR=Se.vbr_mtrh;break}case p.EXTREME:{m=p.V0,g.VBR=Se.vbr_rh;break}case p.EXTREME_FAST:{m=p.V0,g.VBR=Se.vbr_mtrh;break}case p.INSANE:return m=320,g.preset=m,$(g,m,D),g.VBR=Se.vbr_off,m}switch(g.preset=m,m){case p.V9:return Z(g,9,D),m;case p.V8:return Z(g,8,D),m;case p.V7:return Z(g,7,D),m;case p.V6:return Z(g,6,D),m;case p.V5:return Z(g,5,D),m;case p.V4:return Z(g,4,D),m;case p.V3:return Z(g,3,D),m;case p.V2:return Z(g,2,D),m;case p.V1:return Z(g,1,D),m;case p.V0:return Z(g,0,D),m}return 8<=m&&m<=320?$(g,m,D):(g.preset=0,m)};function p1(g,m){var D=0;return 0>m&&(D=-1,m=0),9<m&&(D=-1,m=9),g.VBR_q=m,g.VBR_q_frac=0,D}}var _0=i0;function o0(){this.setModules=function(p,T){}}var l0=o0;function f0(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var c0=f0,Ea=z1,Ta=Ea.new_float,h0=Ea.new_int;function u0(){this.global_gain=0,this.sfb_count1=0,this.step=h0(39),this.noise=Ta(39),this.noise_log=Ta(39)}var p0=u0,Ce=z1,Ee=Ce.System,xa=Ce.VbrMode,Tt=Ce.Util,Ye=Ce.Arrays,Ge=Ce.new_float,Qe=Ce.assert,m0=l0,xt=c0,b0=p0,Y1=ae(),Pa=gt,Va=tt;function d0(){var p;this.rv=null;var T;this.qupvt=null;var A,j=new m0,K;this.setModules=function(S,f,h,w){p=S,T=f,this.rv=f,A=h,this.qupvt=h,K=w,j.setModules(A,K)},this.ms_convert=function(S,f){for(var h=0;h<576;++h){var w=S.tt[f][0].xr[h],e=S.tt[f][1].xr[h];S.tt[f][0].xr[h]=(w+e)*(Tt.SQRT2*.5),S.tt[f][1].xr[h]=(w-e)*(Tt.SQRT2*.5)}};function N(S,f,h,w){w=0;for(var e=0;e<=h;++e){var l=Math.abs(S.xr[e]);w+=l,f[e]=Math.sqrt(l*Math.sqrt(l)),f[e]>S.xrpow_max&&(S.xrpow_max=f[e])}return w}this.init_xrpow=function(S,f,h){var w=0,e=0|f.max_nonzero_coeff;if(f.xrpow_max=0,Ye.fill(h,e,576,0),w=N(f,h,e,w),w>1e-20){var l=0;S.substep_shaping&2&&(l=1);for(var R=0;R<f.psymax;R++)S.pseudohalf[R]=l;return!0}return Ye.fill(f.l3_enc,0,576,0),!1};function Z(S,f){var h=S.ATH,w=f.xr;if(f.block_type!=Y1.SHORT_TYPE)for(var e=!1,l=Y1.PSFB21-1;l>=0&&!e;l--){var R=S.scalefac_band.psfb21[l],P=S.scalefac_band.psfb21[l+1],O=A.athAdjust(h.adjust,h.psfb21[l],h.floor);S.nsPsy.longfact[21]>1e-12&&(O*=S.nsPsy.longfact[21]);for(var k=P-1;k>=R;k--)if(Math.abs(w[k])<O)w[k]=0;else{e=!0;break}}else for(var x=0;x<3;x++)for(var e=!1,l=Y1.PSFB12-1;l>=0&&!e;l--){var R=S.scalefac_band.s[12]*3+(S.scalefac_band.s[13]-S.scalefac_band.s[12])*x+(S.scalefac_band.psfb12[l]-S.scalefac_band.psfb12[0]),P=R+(S.scalefac_band.psfb12[l+1]-S.scalefac_band.psfb12[l]),_1=A.athAdjust(h.adjust,h.psfb12[l],h.floor);S.nsPsy.shortfact[12]>1e-12&&(_1*=S.nsPsy.shortfact[12]);for(var k=P-1;k>=R;k--)if(Math.abs(w[k])<_1)w[k]=0;else{e=!0;break}}}this.init_outer_loop=function(S,f){f.part2_3_length=0,f.big_values=0,f.count1=0,f.global_gain=210,f.scalefac_compress=0,f.table_select[0]=0,f.table_select[1]=0,f.table_select[2]=0,f.subblock_gain[0]=0,f.subblock_gain[1]=0,f.subblock_gain[2]=0,f.subblock_gain[3]=0,f.region0_count=0,f.region1_count=0,f.preflag=0,f.scalefac_scale=0,f.count1table_select=0,f.part2_length=0,f.sfb_lmax=Y1.SBPSY_l,f.sfb_smin=Y1.SBPSY_s,f.psy_lmax=S.sfb21_extra?Y1.SBMAX_l:Y1.SBPSY_l,f.psymax=f.psy_lmax,f.sfbmax=f.sfb_lmax,f.sfbdivide=11;for(var h=0;h<Y1.SBMAX_l;h++)f.width[h]=S.scalefac_band.l[h+1]-S.scalefac_band.l[h],f.window[h]=3;if(f.block_type==Y1.SHORT_TYPE){var w=Ge(576);f.sfb_smin=0,f.sfb_lmax=0,f.mixed_block_flag!=0&&(f.sfb_smin=3,f.sfb_lmax=S.mode_gr*2+4),f.psymax=f.sfb_lmax+3*((S.sfb21_extra?Y1.SBMAX_s:Y1.SBPSY_s)-f.sfb_smin),f.sfbmax=f.sfb_lmax+3*(Y1.SBPSY_s-f.sfb_smin),f.sfbdivide=f.sfbmax-18,f.psy_lmax=f.sfb_lmax;var e=S.scalefac_band.l[f.sfb_lmax];Ee.arraycopy(f.xr,0,w,0,576);for(var h=f.sfb_smin;h<Y1.SBMAX_s;h++)for(var l=S.scalefac_band.s[h],R=S.scalefac_band.s[h+1],P=0;P<3;P++)for(var O=l;O<R;O++)f.xr[e++]=w[3*O+P];for(var k=f.sfb_lmax,h=f.sfb_smin;h<Y1.SBMAX_s;h++)f.width[k]=f.width[k+1]=f.width[k+2]=S.scalefac_band.s[h+1]-S.scalefac_band.s[h],f.window[k]=0,f.window[k+1]=1,f.window[k+2]=2,k+=3}f.count1bits=0,f.sfb_partition_table=A.nr_of_sfb_block[0][0],f.slen[0]=0,f.slen[1]=0,f.slen[2]=0,f.slen[3]=0,f.max_nonzero_coeff=575,Ye.fill(f.scalefac,0),Z(S,f)};function Y(S){this.ordinal=S}Y.BINSEARCH_NONE=new Y(0),Y.BINSEARCH_UP=new Y(1),Y.BINSEARCH_DOWN=new Y(2);function $(S,f,h,w,e){var l,R=S.CurrentStep[w],P=!1,O=S.OldValue[w],k=Y.BINSEARCH_NONE;for(f.global_gain=O,h-=f.part2_length;;){var x;if(l=K.count_bits(S,e,f,null),R==1||l==h)break;l>h?(k==Y.BINSEARCH_DOWN&&(P=!0),P&&(R/=2),k=Y.BINSEARCH_UP,x=R):(k==Y.BINSEARCH_UP&&(P=!0),P&&(R/=2),k=Y.BINSEARCH_DOWN,x=-R),f.global_gain+=x,f.global_gain<0&&(f.global_gain=0,P=!0),f.global_gain>255&&(f.global_gain=255,P=!0)}for(Qe(f.global_gain>=0),Qe(f.global_gain<256);l>h&&f.global_gain<255;)f.global_gain++,l=K.count_bits(S,e,f,null);return S.CurrentStep[w]=O-f.global_gain>=4?4:2,S.OldValue[w]=f.global_gain,f.part2_3_length=l,l}this.trancate_smallspectrums=function(S,f,h,w){var e=Ge(Va.SFBMAX);if(!(!(S.substep_shaping&4)&&f.block_type==Y1.SHORT_TYPE||S.substep_shaping&128)){A.calc_noise(f,h,e,new xt,null);for(var R=0;R<576;R++){var l=0;f.l3_enc[R]!=0&&(l=Math.abs(f.xr[R])),w[R]=l}var R=0,P=8;f.block_type==Y1.SHORT_TYPE&&(P=6);do{var O,k,x,_1,b=f.width[P];if(R+=b,!(e[P]>=1)&&(Ye.sort(w,R-b,b),!BitStream.EQ(w[R-1],0))){O=(1-e[P])*h[P],k=0,_1=0;do{var a;for(x=1;_1+x<b&&!BitStream.NEQ(w[_1+R-b],w[_1+R+x-b]);x++);if(a=w[_1+R-b]*w[_1+R-b]*x,O<a){_1!=0&&(k=w[_1+R-b-1]);break}O-=a,_1+=x}while(_1<b);if(!BitStream.EQ(k,0))do Math.abs(f.xr[R-b])<=k&&(f.l3_enc[R-b]=0);while(--b>0)}}while(++P<f.psymax);f.part2_3_length=K.noquant_count_bits(S,f,null)}};function p1(S){for(var f=0;f<S.sfbmax;f++)if(S.scalefac[f]+S.subblock_gain[S.window[f]]==0)return!1;return!0}function g(S){return Tt.FAST_LOG10(.368+.632*S*S*S)}function m(S,f){for(var h=1e-37,w=0;w<f.psymax;w++)h+=g(S[w]);return Math.max(1e-20,h)}function D(S,f,h,w,e){var l;switch(S){default:case 9:{f.over_count>0?(l=h.over_SSD<=f.over_SSD,h.over_SSD==f.over_SSD&&(l=h.bits<f.bits)):l=h.max_noise<0&&h.max_noise*10+h.bits<=f.max_noise*10+f.bits;break}case 0:l=h.over_count<f.over_count||h.over_count==f.over_count&&h.over_noise<f.over_noise||h.over_count==f.over_count&&BitStream.EQ(h.over_noise,f.over_noise)&&h.tot_noise<f.tot_noise;break;case 8:h.max_noise=m(e,w);case 1:l=h.max_noise<f.max_noise;break;case 2:l=h.tot_noise<f.tot_noise;break;case 3:l=h.tot_noise<f.tot_noise&&h.max_noise<f.max_noise;break;case 4:l=h.max_noise<=0&&f.max_noise>.2||h.max_noise<=0&&f.max_noise<0&&f.max_noise>h.max_noise-.2&&h.tot_noise<f.tot_noise||h.max_noise<=0&&f.max_noise>0&&f.max_noise>h.max_noise-.2&&h.tot_noise<f.tot_noise+f.over_noise||h.max_noise>0&&f.max_noise>-.05&&f.max_noise>h.max_noise-.1&&h.tot_noise+h.over_noise<f.tot_noise+f.over_noise||h.max_noise>0&&f.max_noise>-.1&&f.max_noise>h.max_noise-.15&&h.tot_noise+h.over_noise+h.over_noise<f.tot_noise+f.over_noise+f.over_noise;break;case 5:l=h.over_noise<f.over_noise||BitStream.EQ(h.over_noise,f.over_noise)&&h.tot_noise<f.tot_noise;break;case 6:l=h.over_noise<f.over_noise||BitStream.EQ(h.over_noise,f.over_noise)&&(h.max_noise<f.max_noise||BitStream.EQ(h.max_noise,f.max_noise)&&h.tot_noise<=f.tot_noise);break;case 7:l=h.over_count<f.over_count||h.over_noise<f.over_noise;break}return f.over_count==0&&(l=l&&h.bits<f.bits),l}function n1(S,f,h,w,e){var l=S.internal_flags,R;f.scalefac_scale==0?R=1.2968395546510096:R=1.6817928305074292;for(var P=0,O=0;O<f.sfbmax;O++)P<h[O]&&(P=h[O]);var k=l.noise_shaping_amp;switch(k==3&&(e?k=2:k=1),k){case 2:break;case 1:P>1?P=Math.pow(P,.5):P*=.95;break;case 0:default:P>1?P=1:P*=.95;break}for(var x=0,O=0;O<f.sfbmax;O++){var _1=f.width[O],b;if(x+=_1,!(h[O]<P)){if(l.substep_shaping&2&&(l.pseudohalf[O]=l.pseudohalf[O]==0?1:0,l.pseudohalf[O]==0&&l.noise_shaping_amp==2))return;for(f.scalefac[O]++,b=-_1;b<0;b++)w[x+b]*=R,w[x+b]>f.xrpow_max&&(f.xrpow_max=w[x+b]);if(l.noise_shaping_amp==2)return}}}function U(S,f){for(var h=1.2968395546510096,w=0,e=0;e<S.sfbmax;e++){var l=S.width[e],R=S.scalefac[e];if(S.preflag!=0&&(R+=A.pretab[e]),w+=l,R&1){R++;for(var P=-l;P<0;P++)f[w+P]*=h,f[w+P]>S.xrpow_max&&(S.xrpow_max=f[w+P])}S.scalefac[e]=R>>1}S.preflag=0,S.scalefac_scale=1}function r1(S,f,h){var w,e=f.scalefac;for(w=0;w<f.sfb_lmax;w++)if(e[w]>=16)return!0;for(var l=0;l<3;l++){var R=0,P=0;for(w=f.sfb_lmax+l;w<f.sfbdivide;w+=3)R<e[w]&&(R=e[w]);for(;w<f.sfbmax;w+=3)P<e[w]&&(P=e[w]);if(!(R<16&&P<8)){if(f.subblock_gain[l]>=7)return!0;f.subblock_gain[l]++;var O=S.scalefac_band.l[f.sfb_lmax];for(w=f.sfb_lmax+l;w<f.sfbmax;w+=3){var k,x=f.width[w],_1=e[w];if(_1=_1-(4>>f.scalefac_scale),_1>=0){e[w]=_1,O+=x*3;continue}e[w]=0;{var b=210+(_1<<f.scalefac_scale+1);k=A.IPOW20(b)}O+=x*(l+1);for(var a=-x;a<0;a++)h[O+a]*=k,h[O+a]>f.xrpow_max&&(f.xrpow_max=h[O+a]);O+=x*(3-l-1)}{var k=A.IPOW20(202);O+=f.width[w]*(l+1);for(var a=-f.width[w];a<0;a++)h[O+a]*=k,h[O+a]>f.xrpow_max&&(f.xrpow_max=h[O+a])}}}return!1}function W(S,f,h,w,e){var l=S.internal_flags;n1(S,f,h,w,e);var R=p1(f);return R?!1:(l.mode_gr==2?R=K.scale_bitcount(f):R=K.scale_bitcount_lsf(l,f),R?(l.noise_shaping>1&&(Ye.fill(l.pseudohalf,0),f.scalefac_scale==0?(U(f,w),R=!1):f.block_type==Y1.SHORT_TYPE&&l.subblock_gain>0&&(R=r1(l,f,w)||p1(f))),R||(l.mode_gr==2?R=K.scale_bitcount(f):R=K.scale_bitcount_lsf(l,f)),!R):!0)}this.outer_loop=function(S,f,h,w,e,l){var R=S.internal_flags,P=new Pa,O=Ge(576),k=Ge(Va.SFBMAX),x=new xt,_1,b=new b0,a=9999999,v=!1,V=!1,L=0;if($(R,f,l,e,w),R.noise_shaping==0)return 100;A.calc_noise(f,h,k,x,b),x.bits=f.part2_3_length,P.assign(f);var I=0;for(Ee.arraycopy(w,0,O,0,576);!v;){do{var G=new xt,B,n=255;if(R.substep_shaping&2?B=20:B=3,R.sfb21_extra&&(k[P.sfbmax]>1||P.block_type==Y1.SHORT_TYPE&&(k[P.sfbmax+1]>1||k[P.sfbmax+2]>1))||!W(S,P,k,w,V))break;P.scalefac_scale!=0&&(n=254);var r=l-P.part2_length;if(r<=0)break;for(;(P.part2_3_length=K.count_bits(R,w,P,b))>r&&P.global_gain<=n;)P.global_gain++;if(P.global_gain>n)break;if(x.over_count==0){for(;(P.part2_3_length=K.count_bits(R,w,P,b))>a&&P.global_gain<=n;)P.global_gain++;if(P.global_gain>n)break}if(A.calc_noise(P,h,k,G,b),G.bits=P.part2_3_length,f.block_type!=Y1.SHORT_TYPE?_1=S.quant_comp:_1=S.quant_comp_short,_1=D(_1,x,G,P,k)?1:0,_1!=0)a=f.part2_3_length,x=G,f.assign(P),I=0,Ee.arraycopy(w,0,O,0,576);else if(R.full_outer_loop==0&&(++I>B&&x.over_count==0||R.noise_shaping_amp==3&&V&&I>30||R.noise_shaping_amp==3&&V&&P.global_gain-L>15))break}while(P.global_gain+P.scalefac_scale<255);R.noise_shaping_amp==3?V?v=!0:(P.assign(f),Ee.arraycopy(O,0,w,0,576),I=0,L=P.global_gain,V=!0):v=!0}return Qe(f.global_gain+f.scalefac_scale<=255),S.VBR==xa.vbr_rh||S.VBR==xa.vbr_mtrh?Ee.arraycopy(O,0,w,0,576):R.substep_shaping&1&&trancate_smallspectrums(R,f,h,w),x.over_count},this.iteration_finish_one=function(S,f,h){var w=S.l3_side,e=w.tt[f][h];K.best_scalefac_store(S,f,h,w),S.use_best_huffman==1&&K.best_huffman_divide(S,e),T.ResvAdjust(S,e)},this.VBR_encode_granule=function(S,f,h,w,e,l,R){var P=S.internal_flags,O=new Pa,k=Ge(576),x=R,_1=R+1,b=(R+l)/2,a,v,V=0,L=P.sfb21_extra;Qe(x<=LameInternalFlags.MAX_BITS_PER_CHANNEL),Ye.fill(O.l3_enc,0);do b>x-42?P.sfb21_extra=!1:P.sfb21_extra=L,v=outer_loop(S,f,h,w,e,b),v<=0?(V=1,_1=f.part2_3_length,O.assign(f),Ee.arraycopy(w,0,k,0,576),R=_1-32,a=R-l,b=(R+l)/2):(l=b+32,a=R-l,b=(R+l)/2,V!=0&&(V=2,f.assign(O),Ee.arraycopy(k,0,w,0,576)));while(a>12);P.sfb21_extra=L,V==2&&Ee.arraycopy(O.l3_enc,0,f.l3_enc,0,576),Qe(f.part2_3_length<=x)},this.get_framebits=function(S,f){var h=S.internal_flags;h.bitrate_index=h.VBR_min_bitrate;var w=p.getframebits(S);h.bitrate_index=1,w=p.getframebits(S);for(var e=1;e<=h.VBR_max_bitrate;e++){h.bitrate_index=e;var l=new MeanBits(w);f[e]=T.ResvFrameBegin(S,l),w=l.bits}},this.VBR_old_prepare=function(S,f,h,w,e,l,R,P,O){var k=S.internal_flags,x,_1=0,b=1,a=0;k.bitrate_index=k.VBR_max_bitrate;var v=T.ResvFrameBegin(S,new MeanBits(0))/k.mode_gr;get_framebits(S,l);for(var V=0;V<k.mode_gr;V++){var L=A.on_pe(S,f,P[V],v,V,0);k.mode_ext==Y1.MPG_MD_MS_LR&&(ms_convert(k.l3_side,V),A.reduce_side(P[V],h[V],v,L));for(var I=0;I<k.channels_out;++I){var G=k.l3_side.tt[V][I];G.block_type!=Y1.SHORT_TYPE?(_1=1.28/(1+Math.exp(3.5-f[V][I]/300))-.05,x=k.PSY.mask_adjust-_1):(_1=2.56/(1+Math.exp(3.5-f[V][I]/300))-.14,x=k.PSY.mask_adjust_short-_1),k.masking_lower=Math.pow(10,x*.1),init_outer_loop(k,G),O[V][I]=A.calc_xmin(S,w[V][I],G,e[V][I]),O[V][I]!=0&&(b=0),R[V][I]=126,a+=P[V][I]}}for(var V=0;V<k.mode_gr;V++)for(var I=0;I<k.channels_out;I++)a>l[k.VBR_max_bitrate]&&(P[V][I]*=l[k.VBR_max_bitrate],P[V][I]/=a),R[V][I]>P[V][I]&&(R[V][I]=P[V][I]);return b},this.bitpressure_strategy=function(S,f,h,w){for(var e=0;e<S.mode_gr;e++)for(var l=0;l<S.channels_out;l++){for(var R=S.l3_side.tt[e][l],P=f[e][l],O=0,k=0;k<R.psy_lmax;k++)P[O++]*=1+.029*k*k/Y1.SBMAX_l/Y1.SBMAX_l;if(R.block_type==Y1.SHORT_TYPE)for(var k=R.sfb_smin;k<Y1.SBMAX_s;k++)P[O++]*=1+.029*k*k/Y1.SBMAX_s/Y1.SBMAX_s,P[O++]*=1+.029*k*k/Y1.SBMAX_s/Y1.SBMAX_s,P[O++]*=1+.029*k*k/Y1.SBMAX_s/Y1.SBMAX_s;w[e][l]=0|Math.max(h[e][l],.9*w[e][l])}},this.VBR_new_prepare=function(S,f,h,w,e,l){var R=S.internal_flags,P=1,O=0,k=0,x;if(S.free_format){R.bitrate_index=0;var _1=new MeanBits(O);x=T.ResvFrameBegin(S,_1),O=_1.bits,e[0]=x}else{R.bitrate_index=R.VBR_max_bitrate;var _1=new MeanBits(O);T.ResvFrameBegin(S,_1),O=_1.bits,get_framebits(S,e),x=e[R.VBR_max_bitrate]}for(var b=0;b<R.mode_gr;b++){A.on_pe(S,f,l[b],O,b,0),R.mode_ext==Y1.MPG_MD_MS_LR&&ms_convert(R.l3_side,b);for(var a=0;a<R.channels_out;++a){var v=R.l3_side.tt[b][a];R.masking_lower=Math.pow(10,R.PSY.mask_adjust*.1),init_outer_loop(R,v),A.calc_xmin(S,h[b][a],v,w[b][a])!=0&&(P=0),k+=l[b][a]}}for(var b=0;b<R.mode_gr;b++)for(var a=0;a<R.channels_out;a++)k>x&&(l[b][a]*=x,l[b][a]/=k);return P},this.calc_target_bits=function(S,f,h,w,e,l){var R=S.internal_flags,P=R.l3_side,O,k,x,_1,b=0;R.bitrate_index=R.VBR_max_bitrate;var a=new MeanBits(b);for(l[0]=T.ResvFrameBegin(S,a),b=a.bits,R.bitrate_index=1,b=p.getframebits(S)-R.sideinfo_len*8,e[0]=b/(R.mode_gr*R.channels_out),b=S.VBR_mean_bitrate_kbps*S.framesize*1e3,R.substep_shaping&1&&(b*=1.09),b/=S.out_samplerate,b-=R.sideinfo_len*8,b/=R.mode_gr*R.channels_out,O=.93+.07*(11-S.compression_ratio)/(11-5.5),O<.9&&(O=.9),O>1&&(O=1),k=0;k<R.mode_gr;k++){var v=0;for(x=0;x<R.channels_out;x++){if(w[k][x]=int(O*b),f[k][x]>700){var V=int((f[k][x]-700)/1.4),L=P.tt[k][x];w[k][x]=int(O*b),L.block_type==Y1.SHORT_TYPE&&V<b/2&&(V=b/2),V>b*3/2?V=b*3/2:V<0&&(V=0),w[k][x]+=V}w[k][x]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(w[k][x]=LameInternalFlags.MAX_BITS_PER_CHANNEL),v+=w[k][x]}if(v>LameInternalFlags.MAX_BITS_PER_GRANULE)for(x=0;x<R.channels_out;++x)w[k][x]*=LameInternalFlags.MAX_BITS_PER_GRANULE,w[k][x]/=v}if(R.mode_ext==Y1.MPG_MD_MS_LR)for(k=0;k<R.mode_gr;k++)A.reduce_side(w[k],h[k],b*R.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(_1=0,k=0;k<R.mode_gr;k++)for(x=0;x<R.channels_out;x++)w[k][x]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(w[k][x]=LameInternalFlags.MAX_BITS_PER_CHANNEL),_1+=w[k][x];if(_1>l[0])for(k=0;k<R.mode_gr;k++)for(x=0;x<R.channels_out;x++)w[k][x]*=l[0],w[k][x]/=_1}}var g0=d0,v0=z1,Ia=v0.assert;function w0(){var p;this.setModules=function(T){p=T},this.ResvFrameBegin=function(T,A){var j=T.internal_flags,K,N=j.l3_side,Z=p.getframebits(T);A.bits=(Z-j.sideinfo_len*8)/j.mode_gr;var Y=8*256*j.mode_gr-8;T.brate>320?K=8*int(T.brate*1e3/(T.out_samplerate/1152)/8+.5):(K=8*1440,T.strict_ISO&&(K=8*int(32e4/(T.out_samplerate/1152)/8+.5))),j.ResvMax=K-Z,j.ResvMax>Y&&(j.ResvMax=Y),(j.ResvMax<0||T.disable_reservoir)&&(j.ResvMax=0);var $=A.bits*j.mode_gr+Math.min(j.ResvSize,j.ResvMax);return $>K&&($=K),Ia(j.ResvMax%8==0),Ia(j.ResvMax>=0),N.resvDrain_pre=0,j.pinfo!=null&&(j.pinfo.mean_bits=A.bits/2,j.pinfo.resvsize=j.ResvSize),$},this.ResvMaxBits=function(T,A,j,K){var N=T.internal_flags,Z,Y=N.ResvSize,$=N.ResvMax;K!=0&&(Y+=A),N.substep_shaping&1&&($*=.9),j.bits=A,Y*10>$*9?(Z=Y-$*9/10,j.bits+=Z,N.substep_shaping|=128):(Z=0,N.substep_shaping&=127,!T.disable_reservoir&&!(N.substep_shaping&1)&&(j.bits-=.1*A));var p1=Y<N.ResvMax*6/10?Y:N.ResvMax*6/10;return p1-=Z,p1<0&&(p1=0),p1},this.ResvAdjust=function(T,A){T.ResvSize-=A.part2_3_length+A.part2_length},this.ResvFrameEnd=function(T,A){var j,K=T.l3_side;T.ResvSize+=A*T.mode_gr;var N=0;K.resvDrain_post=0,K.resvDrain_pre=0,(j=T.ResvSize%8)!=0&&(N+=j),j=T.ResvSize-N-T.ResvMax,j>0&&(N+=j);{var Z=Math.min(K.main_data_begin*8,N)/8;K.resvDrain_pre+=8*Z,N-=8*Z,T.ResvSize-=8*Z,K.main_data_begin-=Z}K.resvDrain_post+=N,T.ResvSize-=N}}var S0=w0;function M0(){var p="http://www.mp3dev.org/",T=3,A=98,j=4,K=0,N=93;this.getLameVersion=function(){return T+"."+A+"."+j},this.getLameShortVersion=function(){return T+"."+A+"."+j},this.getLameVeryShortVersion=function(){return"LAME"+T+"."+A+"r"},this.getPsyVersion=function(){return K+"."+N},this.getLameUrl=function(){return p},this.getLameOsBitness=function(){return"32bits"}}var R0=M0,Fe=z1,B0=Fe.System,Pt=Fe.VbrMode,La=Fe.ShortBlock,A0=Fe.Arrays,_t=Fe.new_byte,k0=Fe.assert;Ue.NUMTOCENTRIES=100,Ue.MAXFRAMESIZE=2880;function Ue(){var p,T,A;this.setModules=function(b,a,v){p=b,T=a,A=v};var j=1,K=2,N=4,Z=8,Y=Ue.NUMTOCENTRIES,$=Ue.MAXFRAMESIZE,p1=Y+4+4+4+4+4,g=p1+9+1+1+8+1+1+3+1+1+2+4+2+2,m=128,D=64,n1=32,U=null,r1="Xing",W="Info",S=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function f(b,a){if(b.nVbrNumFrames++,b.sum+=a,b.seen++,!(b.seen<b.want)&&(b.pos<b.size&&(b.bag[b.pos]=b.sum,b.pos++,b.seen=0),b.pos==b.size)){for(var v=1;v<b.size;v+=2)b.bag[v/2]=b.bag[v];b.want*=2,b.pos/=2}}function h(b,a){if(!(b.pos<=0))for(var v=1;v<Y;++v){var V=v/Y,L,I,G=0|Math.floor(V*b.pos);G>b.pos-1&&(G=b.pos-1),L=b.bag[G],I=b.sum;var B=0|256*L/I;B>255&&(B=255),a[v]=255&B}}this.addVbrFrame=function(b){var a=b.internal_flags,v=Tables.bitrate_table[b.version][a.bitrate_index];k0(a.VBR_seek_table.bag!=null),f(a.VBR_seek_table,v)};function w(b,a){var v=b[a+0]&255;return v<<=8,v|=b[a+1]&255,v<<=8,v|=b[a+2]&255,v<<=8,v|=b[a+3]&255,v}function e(b,a,v){b[a+0]=255&(v>>24&255),b[a+1]=255&(v>>16&255),b[a+2]=255&(v>>8&255),b[a+3]=255&(v&255)}function l(b,a,v){b[a+0]=255&(v>>8&255),b[a+1]=255&(v&255)}function R(b,a){return new String(b,a,r1.length(),U).equals(r1)||new String(b,a,W.length(),U).equals(W)}function P(b,a,v){return 255&(b<<a|v&~(-1<<a))}function O(b,a){var v=b.internal_flags;a[0]=P(a[0],8,255),a[1]=P(a[1],3,7),a[1]=P(a[1],1,b.out_samplerate<16e3?0:1),a[1]=P(a[1],1,b.version),a[1]=P(a[1],2,1),a[1]=P(a[1],1,b.error_protection?0:1),a[2]=P(a[2],4,v.bitrate_index),a[2]=P(a[2],2,v.samplerate_index),a[2]=P(a[2],1,0),a[2]=P(a[2],1,b.extension),a[3]=P(a[3],2,b.mode.ordinal()),a[3]=P(a[3],2,v.mode_ext),a[3]=P(a[3],1,b.copyright),a[3]=P(a[3],1,b.original),a[3]=P(a[3],2,b.emphasis),a[0]=255;var V=255&(a[1]&241),L;b.version==1?L=m:b.out_samplerate<16e3?L=n1:L=D,b.VBR==Pt.vbr_off&&(L=b.brate);var I;b.free_format?I=0:I=255&16*p.BitrateIndex(L,b.version,b.out_samplerate),b.version==1?(a[1]=255&(V|10),V=255&(a[2]&13),a[2]=255&(I|V)):(a[1]=255&(V|2),V=255&(a[2]&13),a[2]=255&(I|V))}this.getVbrTag=function(b){var a=new VBRTagData,v=0;a.flags=0;var V=b[v+1]>>3&1,L=b[v+2]>>2&3,I=b[v+3]>>6&3,G=b[v+2]>>4&15;if(G=Tables.bitrate_table[V][G],b[v+1]>>4==14?a.samprate=Tables.samplerate_table[2][L]:a.samprate=Tables.samplerate_table[V][L],V!=0?I!=3?v+=36:v+=21:I!=3?v+=21:v+=13,!R(b,v))return null;v+=4,a.hId=V;var B=a.flags=w(b,v);if(v+=4,B&j&&(a.frames=w(b,v),v+=4),B&K&&(a.bytes=w(b,v),v+=4),B&N){if(a.toc!=null)for(var n=0;n<Y;n++)a.toc[n]=b[v+n];v+=Y}a.vbrScale=-1,B&Z&&(a.vbrScale=w(b,v),v+=4),a.headersize=(V+1)*72e3*G/a.samprate,v+=21;var r=b[v+0]<<4;r+=b[v+1]>>4;var t=(b[v+1]&15)<<8;return t+=b[v+2]&255,(r<0||r>3e3)&&(r=-1),(t<0||t>3e3)&&(t=-1),a.encDelay=r,a.encPadding=t,a},this.InitVbrTag=function(b){var a=b.internal_flags,v;b.version==1?v=m:b.out_samplerate<16e3?v=n1:v=D,b.VBR==Pt.vbr_off&&(v=b.brate);var V=(b.version+1)*72e3*v/b.out_samplerate,L=a.sideinfo_len+g;if(a.VBR_seek_table.TotalFrameSize=V,V<L||V>$){b.bWriteVbrTag=!1;return}a.VBR_seek_table.nVbrNumFrames=0,a.VBR_seek_table.nBytesWritten=0,a.VBR_seek_table.sum=0,a.VBR_seek_table.seen=0,a.VBR_seek_table.want=1,a.VBR_seek_table.pos=0,a.VBR_seek_table.bag==null&&(a.VBR_seek_table.bag=new int[400],a.VBR_seek_table.size=400);var I=_t($);O(b,I);for(var G=a.VBR_seek_table.TotalFrameSize,B=0;B<G;++B)T.add_dummy_byte(b,I[B]&255,1)};function k(b,a){var v=a^b;return a=a>>8^S[v&255],a}this.updateMusicCRC=function(b,a,v,V){for(var L=0;L<V;++L)b[0]=k(a[v+L],b[0])};function x(b,a,v,V,L){var I=b.internal_flags,G=0,B=b.encoder_delay,n=b.encoder_padding,r=100-10*b.VBR_q-b.quality,t=A.getLameVeryShortVersion(),i,u=0,F,e1=[1,5,3,2,4,0,3],y=0|(b.lowpassfreq/100+.5>255?255:b.lowpassfreq/100+.5),q=0,i1=0,h1=0,v1=b.internal_flags.noise_shaping,R1=0,w1=0,S1=0,y1=0,j1=0,me=(b.exp_nspsytune&1)!=0,s=(b.exp_nspsytune&2)!=0,_=!1,g1=!1,B1=b.internal_flags.nogap_total,L1=b.internal_flags.nogap_current,T1=b.ATHtype,E1=0,k1;switch(b.VBR){case vbr_abr:k1=b.VBR_mean_bitrate_kbps;break;case vbr_off:k1=b.brate;break;default:k1=b.VBR_min_bitrate_kbps}switch(b.VBR.ordinal()<e1.length?i=e1[b.VBR.ordinal()]:i=0,F=16*u+i,I.findReplayGain&&(I.RadioGain>510&&(I.RadioGain=510),I.RadioGain<-510&&(I.RadioGain=-510),i1=8192,i1|=3072,I.RadioGain>=0?i1|=I.RadioGain:(i1|=512,i1|=-I.RadioGain)),I.findPeakSample&&(q=Math.abs(0|I.PeakSample/32767*Math.pow(2,23)+.5)),B1!=-1&&(L1>0&&(g1=!0),L1<B1-1&&(_=!0)),E1=T1+((me?1:0)<<4)+((s?1:0)<<5)+((_?1:0)<<6)+((g1?1:0)<<7),r<0&&(r=0),b.mode){case MONO:R1=0;break;case STEREO:R1=1;break;case DUAL_CHANNEL:R1=2;break;case JOINT_STEREO:b.force_ms?R1=4:R1=3;break;case NOT_SET:default:R1=7;break}b.in_samplerate<=32e3?S1=0:b.in_samplerate==48e3?S1=2:b.in_samplerate>48e3?S1=3:S1=1,(b.short_blocks==La.short_block_forced||b.short_blocks==La.short_block_dispensed||b.lowpassfreq==-1&&b.highpassfreq==-1||b.scale_left<b.scale_right||b.scale_left>b.scale_right||b.disable_reservoir&&b.brate<320||b.noATH||b.ATHonly||T1==0||b.in_samplerate<=32e3)&&(w1=1),y1=v1+(R1<<2)+(w1<<5)+(S1<<6),j1=I.nMusicCRC,e(v,V+G,r),G+=4;for(var N1=0;N1<9;N1++)v[V+G+N1]=255&t.charAt(N1);G+=9,v[V+G]=255&F,G++,v[V+G]=255&y,G++,e(v,V+G,q),G+=4,l(v,V+G,i1),G+=2,l(v,V+G,h1),G+=2,v[V+G]=255&E1,G++,k1>=255?v[V+G]=255:v[V+G]=255&k1,G++,v[V+G]=255&B>>4,v[V+G+1]=255&(B<<4)+(n>>8),v[V+G+2]=255&n,G+=3,v[V+G]=255&y1,G++,v[V+G++]=0,l(v,V+G,b.preset),G+=2,e(v,V+G,a),G+=4,l(v,V+G,j1),G+=2;for(var V1=0;V1<G;V1++)L=k(v[V+V1],L);return l(v,V+G,L),G+=2,G}function _1(b){b.seek(0);var a=_t(10);b.readFully(a);var v;return new String(a,"ISO-8859-1").startsWith("ID3")?v=0:v=((a[6]&127)<<21|(a[7]&127)<<14|(a[8]&127)<<7|a[9]&127)+a.length,v}this.getLameTagFrame=function(b,a){var v=b.internal_flags;if(!b.bWriteVbrTag||v.Class_ID!=Lame.LAME_ID||v.VBR_seek_table.pos<=0)return 0;if(a.length<v.VBR_seek_table.TotalFrameSize)return v.VBR_seek_table.TotalFrameSize;A0.fill(a,0,v.VBR_seek_table.TotalFrameSize,0),O(b,a);var V=_t(Y);if(b.free_format)for(var L=1;L<Y;++L)V[L]=255&255*L/100;else h(v.VBR_seek_table,V);var I=v.sideinfo_len;b.error_protection&&(I-=2),b.VBR==Pt.vbr_off?(a[I++]=255&W.charAt(0),a[I++]=255&W.charAt(1),a[I++]=255&W.charAt(2),a[I++]=255&W.charAt(3)):(a[I++]=255&r1.charAt(0),a[I++]=255&r1.charAt(1),a[I++]=255&r1.charAt(2),a[I++]=255&r1.charAt(3)),e(a,I,j+K+N+Z),I+=4,e(a,I,v.VBR_seek_table.nVbrNumFrames),I+=4;var G=v.VBR_seek_table.nBytesWritten+v.VBR_seek_table.TotalFrameSize;e(a,I,0|G),I+=4,B0.arraycopy(V,0,a,I,V.length),I+=V.length,b.error_protection&&T.CRC_writeheader(v,a);for(var B=0,L=0;L<I;L++)B=k(a[L],B);return I+=x(b,G,a,I,B),v.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(b,a){var v=b.internal_flags;if(v.VBR_seek_table.pos<=0||(a.seek(a.length()),a.length()==0))return-1;var V=_1(a);a.seek(V);var L=_t($),I=getLameTagFrame(b,L);return I>L.length?-1:(I<1||a.write(L,0,I),0)}}var y0=Ue,Na=z1,Da=Na.new_byte,E0=Na.assert,T0=Et(),x0=_0,P0=ma,V0=Ra(),I0=g0,L0=Aa(),N0=S0,D0=Ze,X0=kt();ae();var O0=R0,H0=y0;function C0(){this.setModules=function(p,T){}}function Y0(){this.setModules=function(p,T,A){}}function F0(){}function j0(){this.setModules=function(p,T){}}function q0(p,T,A){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),p=1,T=44100,A=128);var j=new T0,K=new C0,N=new P0,Z=new X0,Y=new x0,$=new V0,p1=new I0,g=new H0,m=new O0,D=new j0,n1=new N0,U=new L0,r1=new Y0,W=new F0;j.setModules(N,Z,Y,$,p1,g,m,D,W),Z.setModules(N,W,m,g),D.setModules(Z,m),Y.setModules(j),p1.setModules(Z,n1,$,U),$.setModules(U,n1,j.enc.psy),n1.setModules(Z),U.setModules($),g.setModules(j,Z,m),K.setModules(r1,W),r1.setModules(m,D,Y);var S=j.lame_init();S.num_channels=p,S.in_samplerate=T,S.brate=A,S.mode=D0.STEREO,S.quality=3,S.bWriteVbrTag=!1,S.disable_reservoir=!0,S.write_id3tag_automatic=!1,j.lame_init_params(S);var f=1152,h=0|1.25*f+7200,w=Da(h);this.encodeBuffer=function(e,l){p==1&&(l=e),E0(e.length==l.length),e.length>f&&(f=e.length,h=0|1.25*f+7200,w=Da(h));var R=j.lame_encode_buffer(S,e,l,e.length,w,0,h);return new Int8Array(w.subarray(0,R))},this.flush=function(){var e=j.lame_encode_flush(S,w,0,h);return new Int8Array(w.subarray(0,e))}}function Me(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function ot(p){return p.charCodeAt(0)<<24|p.charCodeAt(1)<<16|p.charCodeAt(2)<<8|p.charCodeAt(3)}Me.RIFF=ot("RIFF"),Me.WAVE=ot("WAVE"),Me.fmt_=ot("fmt "),Me.data=ot("data"),Me.readHeader=function(p){var T=new Me,A=p.getUint32(0,!1);if(Me.RIFF==A&&(p.getUint32(4,!0),Me.WAVE==p.getUint32(8,!1)&&Me.fmt_==p.getUint32(12,!1))){var j=p.getUint32(16,!0),K=20;switch(j){case 16:case 18:T.channels=p.getUint16(K+2,!0),T.sampleRate=p.getUint32(K+4,!0);break;default:throw"extended fmt chunk not implemented"}K+=j;for(var N=Me.data,Z=0;N!=A&&(A=p.getUint32(K,!1),Z=p.getUint32(K+4,!0),N!=A);)K+=Z+8;return T.dataLen=Z,T.dataOffset=K+8,T}};var z0=q0;class Z0{constructor(T){this.bitRate=T.bitRate,this.sampleRate=T.sampleRate,this.dataBuffer=[],this.encoder=new z0(1,this.sampleRate,this.bitRate)}encode(T){const j=this._convertBuffer(T);let K=j.length;for(let N=0;K>=0;N+=1152){const Z=j.subarray(N,N+1152),Y=this.encoder.encodeBuffer(Z);this.dataBuffer.push(new Int8Array(Y)),K-=1152}}finish(){this.dataBuffer.push(this.encoder.flush());const T=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:T,url:URL.createObjectURL(T)}}_floatTo16BitPCM(T,A){for(let j=0;j<T.length;j++){const K=Math.max(-1,Math.min(1,T[j]));A[j]=K<0?K*32768:K*32767}}_convertBuffer(T){const A=new Float32Array(T),j=new Int16Array(T.length);return this._floatTo16BitPCM(A,j),j}}class G0{constructor(T){this.bufferSize=T.bufferSize||4096,this.sampleRate=T.sampleRate,this.samples=T.samples}finish(){this._joinSamples();let T=new ArrayBuffer(44+this.samples.length*2),A=new DataView(T);this._writeString(A,0,"RIFF"),A.setUint32(4,36+this.samples.length*2,!0),this._writeString(A,8,"WAVE"),this._writeString(A,12,"fmt "),A.setUint32(16,16,!0),A.setUint16(20,1,!0),A.setUint16(22,1,!0),A.setUint32(24,this.sampleRate,!0),A.setUint32(28,this.sampleRate*4,!0),A.setUint16(32,4,!0),A.setUint16(34,16,!0),this._writeString(A,36,"data"),A.setUint32(40,this.samples.length*2,!0),this._floatTo16BitPCM(A,44,this.samples);const j=new Blob([A],{type:"audio/wav"});return{id:Date.now(),blob:j,url:URL.createObjectURL(j)}}_floatTo16BitPCM(T,A,j){for(let K=0;K<j.length;K++,A+=2){let N=Math.max(-1,Math.min(1,j[K]));T.setInt16(A,N<0?N*32768:N*32767,!0)}}_joinSamples(){let T=this.samples.length*this.bufferSize,A=new Float64Array(T),j=0;for(let K=0;K<this.samples.length;K++){let N=this.samples[K];A.set(N,j),j+=N.length}this.samples=A}_writeString(T,A,j){for(let K=0;K<j.length;K++)T.setUint8(A+K,j.charCodeAt(K))}}class Q0{constructor(T={}){this.beforeRecording=T.beforeRecording,this.pauseRecording=T.pauseRecording,this.afterRecording=T.afterRecording,this.micFailed=T.micFailed,this.format=T.format,this.encoderOptions={bitRate:T.bitRate,sampleRate:T.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this.wavSamples=[],this._duration=0}start(){const T={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(T).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this._isMp3()&&!this.lameEncoder&&(this.lameEncoder=new Z0(this.encoderOptions))}stop(){this.stream.getTracks().forEach(A=>A.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let T=null;this._isMp3()?T=this.lameEncoder.finish():(T=new G0({bufferSize:this.bufferSize,sampleRate:this.encoderOptions.sampleRate,samples:this.wavSamples}).finish(),this.wavSamples=[]),T.duration=ye(this.duration),this.records.push(T),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(T)}pause(){this.stream.getTracks().forEach(T=>T.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}recordList(){return this.records}lastRecord(){return this.records.slice(-1).pop()}_micCaptured(T){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(T),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=T,this.processor.onaudioprocess=A=>{const j=A.inputBuffer.getChannelData(0);let K=0;this._isMp3()?this.lameEncoder.encode(j):this.wavSamples.push(new Float32Array(j));for(let N=0;N<j.length;++N)K+=j[N]*j[N];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(K/j.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(T){this.micFailed&&this.micFailed(T)}_isMp3(){return this.format.toLowerCase()==="mp3"}}const U0={name:"AudioRecorder",mixins:[Yt],props:{attempts:{type:Number},time:{type:Number},bitRate:{type:Number,default:128},sampleRate:{type:Number,default:44100},showDownloadButton:{type:Boolean,default:!0},showUploadButton:{type:Boolean,default:!0},micFailed:{type:Function},beforeRecording:{type:Function},pauseRecording:{type:Function},afterRecording:{type:Function},failedUpload:{type:Function},beforeUpload:{type:Function},successfulUpload:{type:Function},selectRecord:{type:Function}},data(){return{isUploading:!1,recorder:this._initRecorder(),recordList:[],selected:{},uploadStatus:null}},components:{AudioPlayer:ht,Downloader:os,IconButton:qe,Uploader:cs},beforeUnmount(){this.stopRecorder()},methods:{onStartUpload(){this.isUploading=!0,this.beforeUpload&&this.beforeUpload("before upload")},onEndUpload(p){this.isUploading=!1,p.status==="success"?this.successfulUpload&&this.successfulUpload(p.response):this.failedUpload&&this.failedUpload(p.response)},toggleRecorder(){this.attempts&&this.recorder.records.length>=this.attempts||(!this.isRecording||this.isRecording&&this.isPause?this.recorder.start():this.recorder.pause())},stopRecorder(){this.isRecording&&(this.recorder.stop(),this.recordList=this.recorder.recordList())},removeRecord(p){this.recordList.splice(p,1),this.selected.url=null,this.$refs.player._resetProgress()},choiceRecord(p){this.selected!==p&&(this.selected=p,this.selectRecord&&this.selectRecord(p))},_initRecorder(){return new Q0({beforeRecording:this.beforeRecording,afterRecording:this.afterRecording,pauseRecording:this.pauseRecording,micFailed:this.micFailed,bitRate:this.bitRate,sampleRate:this.sampleRate,format:this.format})}},computed:{attemptsLeft(){return this.attempts-this.recordList.length},iconButtonType(){return this.isRecording&&this.isPause?"mic":this.isRecording?"pause":"mic"},isPause(){return this.recorder.isPause},isRecording(){return this.recorder.isRecording},recordedTime(){return this.time&&this.recorder.duration>=this.time*60&&this.stopRecorder(),ye(this.recorder.duration)},volume(){return parseFloat(this.recorder.volume)}}},W0={class:"ar"},K0={key:0,class:"ar__overlay"},J0={key:1,class:"ar-spinner"},$0=[u1.createElementVNode("div",{class:"ar-spinner__dot"},null,-1),u1.createElementVNode("div",{class:"ar-spinner__dot"},null,-1),u1.createElementVNode("div",{class:"ar-spinner__dot"},null,-1)],er={class:"ar-recorder"},tr={key:0,class:"ar-recorder__records-limit"},ar={class:"ar-recorder__duration"},sr={key:1,class:"ar-recorder__time-limit"},rr={class:"ar-records"},nr=["onClick"],ir=["onClick"],_r={class:"ar__text"},or={class:"ar__text"};function lr(p,T,A,j,K,N){const Z=u1.resolveComponent("icon-button"),Y=u1.resolveComponent("downloader"),$=u1.resolveComponent("uploader"),p1=u1.resolveComponent("audio-player");return u1.openBlock(),u1.createElementBlock("div",W0,[K.isUploading?(u1.openBlock(),u1.createElementBlock("div",K0)):u1.createCommentVNode("",!0),K.isUploading?(u1.openBlock(),u1.createElementBlock("div",J0,$0)):u1.createCommentVNode("",!0),u1.createElementVNode("div",{class:u1.normalizeClass(["ar-content",{ar__blur:K.isUploading}])},[u1.createElementVNode("div",er,[u1.createVNode(Z,{class:u1.normalizeClass(["ar-icon ar-icon__lg",{"ar-icon--rec":N.isRecording,"ar-icon--pulse":N.isRecording&&N.volume>.02}]),name:N.iconButtonType,onClick:N.toggleRecorder},null,8,["name","class","onClick"]),u1.createVNode(Z,{class:"ar-icon ar-icon__sm ar-recorder__stop",name:"stop",onClick:N.stopRecorder},null,8,["onClick"])]),A.attempts?(u1.openBlock(),u1.createElementBlock("div",tr,"Attempts: "+u1.toDisplayString(N.attemptsLeft)+"/"+u1.toDisplayString(A.attempts),1)):u1.createCommentVNode("",!0),u1.createElementVNode("div",ar,u1.toDisplayString(N.recordedTime),1),A.time?(u1.openBlock(),u1.createElementBlock("div",sr,"Record duration is limited: "+u1.toDisplayString(A.time)+"m",1)):u1.createCommentVNode("",!0),u1.createElementVNode("div",rr,[(u1.openBlock(!0),u1.createElementBlock(u1.Fragment,null,u1.renderList(K.recordList,(g,m)=>(u1.openBlock(),u1.createElementBlock("div",{class:u1.normalizeClass(["ar-records__record",{"ar-records__record--selected":g.id===K.selected.id}]),key:g.id,onClick:D=>N.choiceRecord(g)},[g.id===K.selected.id?(u1.openBlock(),u1.createElementBlock("div",{key:0,class:"ar__rm",onClick:D=>N.removeRecord(m)},"×",8,ir)):u1.createCommentVNode("",!0),u1.createElementVNode("div",_r,"Record "+u1.toDisplayString(m+1),1),u1.createElementVNode("div",or,u1.toDisplayString(g.duration),1),g.id===K.selected.id&&A.showDownloadButton?(u1.openBlock(),u1.createBlock(Y,{key:1,class:"ar__downloader",record:g,filename:p.filename},null,8,["record","filename"])):u1.createCommentVNode("",!0),g.id===K.selected.id&&A.showUploadButton?(u1.openBlock(),u1.createBlock($,{key:2,class:"ar__uploader",record:g,filename:p.filename,headers:p.headers,"upload-url":p.uploadUrl,onStartUpload:N.onStartUpload,onEndUpload:N.onEndUpload},null,8,["record","filename","headers","upload-url","onStartUpload","onEndUpload"])):u1.createCommentVNode("",!0)],10,nr))),128))]),u1.createVNode(p1,{ref:"player",record:K.selected},null,8,["record"])],2)])}const Xa=be(U0,[["render",lr]]);return{install(p){p.component(Xa.name,Xa),p.component(ht.name,ht)}}});
